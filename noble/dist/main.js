function _e(){}function zc(t,e){for(const n in e)t[n]=e[n];return t}function ec(t){return t()}function Kr(){return Object.create(null)}function dt(t){t.forEach(ec)}function tc(t){return typeof t=="function"}function qe(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function Fc(t){return Object.keys(t).length===0}function Wc(t,...e){if(t==null)return _e;const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function Se(t,e,n){t.$$.on_destroy.push(Wc(e,n))}function Xc(t,e,n,r){if(t){const s=nc(t,e,n,r);return t[0](s)}}function nc(t,e,n,r){return t[1]&&r?zc(n.ctx.slice(),t[1](r(e))):n.ctx}function $c(t,e,n,r){if(t[2]&&r){const s=t[2](r(n));if(e.dirty===void 0)return s;if(typeof s=="object"){const c=[],o=Math.max(e.dirty.length,s.length);for(let i=0;i<o;i+=1)c[i]=e.dirty[i]|s[i];return c}return e.dirty|s}return e.dirty}function Qc(t,e,n,r,s,c){if(s){const o=nc(e,n,r,c);t.p(o,s)}}function Jc(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let r=0;r<n;r++)e[r]=-1;return e}return-1}function Le(t,e,n){return t.set(n),e}function f(t,e){t.appendChild(e)}function F(t,e,n){t.insertBefore(e,n||null)}function Y(t){t.parentNode&&t.parentNode.removeChild(t)}function bt(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function u(t){return document.createElement(t)}function X(t){return document.createTextNode(t)}function P(){return X(" ")}function ht(){return X("")}function ke(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function g(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function eo(t){return Array.from(t.childNodes)}function ee(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function ct(t,e){t.value=e??""}function to(t,e,{bubbles:n=!1,cancelable:r=!1}={}){const s=document.createEvent("CustomEvent");return s.initCustomEvent(t,n,r,e),s}let bn;function dn(t){bn=t}function rc(){if(!bn)throw new Error("Function called outside component initialization");return bn}function no(t){rc().$$.on_mount.push(t)}function Mn(){const t=rc();return(e,n,{cancelable:r=!1}={})=>{const s=t.$$.callbacks[e];if(s){const c=to(e,n,{cancelable:r});return s.slice().forEach(o=>{o.call(t,c)}),!c.defaultPrevented}return!0}}const tn=[],jr=[],Rn=[],Vr=[],ro=Promise.resolve();let or=!1;function so(){or||(or=!0,ro.then(sc))}function fr(t){Rn.push(t)}const Fn=new Set;let Jt=0;function sc(){if(Jt!==0)return;const t=bn;do{try{for(;Jt<tn.length;){const e=tn[Jt];Jt++,dn(e),co(e.$$)}}catch(e){throw tn.length=0,Jt=0,e}for(dn(null),tn.length=0,Jt=0;jr.length;)jr.pop()();for(let e=0;e<Rn.length;e+=1){const n=Rn[e];Fn.has(n)||(Fn.add(n),n())}Rn.length=0}while(tn.length);for(;Vr.length;)Vr.pop()();or=!1,Fn.clear(),dn(t)}function co(t){if(t.fragment!==null){t.update(),dt(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(fr)}}const Hn=new Set;let Vt;function We(){Vt={r:0,c:[],p:Vt}}function Xe(){Vt.r||dt(Vt.c),Vt=Vt.p}function J(t,e){t&&t.i&&(Hn.delete(t),t.i(e))}function se(t,e,n,r){if(t&&t.o){if(Hn.has(t))return;Hn.add(t),Vt.c.push(()=>{Hn.delete(t),r&&(n&&t.d(1),r())}),t.o(e)}else r&&r()}function be(t){t&&t.c()}function ue(t,e,n,r){const{fragment:s,after_update:c}=t.$$;s&&s.m(e,n),r||fr(()=>{const o=t.$$.on_mount.map(ec).filter(tc);t.$$.on_destroy?t.$$.on_destroy.push(...o):dt(o),t.$$.on_mount=[]}),c.forEach(fr)}function de(t,e){const n=t.$$;n.fragment!==null&&(dt(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function oo(t,e){t.$$.dirty[0]===-1&&(tn.push(t),so(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Me(t,e,n,r,s,c,o,i=[-1]){const l=bn;dn(t);const a=t.$$={fragment:null,ctx:[],props:c,update:_e,not_equal:s,bound:Kr(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(l?l.$$.context:[])),callbacks:Kr(),dirty:i,skip_bound:!1,root:e.target||l.$$.root};o&&o(a.root);let b=!1;if(a.ctx=n?n(t,e.props||{},(h,p,...d)=>{const m=d.length?d[0]:p;return a.ctx&&s(a.ctx[h],a.ctx[h]=m)&&(!a.skip_bound&&a.bound[h]&&a.bound[h](m),b&&oo(t,h)),p}):[],a.update(),b=!0,dt(a.before_update),a.fragment=r?r(a.ctx):!1,e.target){if(e.hydrate){const h=eo(e.target);a.fragment&&a.fragment.l(h),h.forEach(Y)}else a.fragment&&a.fragment.c();e.intro&&J(t.$$.fragment),ue(t,e.target,e.anchor,e.customElement),sc()}dn(l)}class Ge{$destroy(){de(this,1),this.$destroy=_e}$on(e,n){if(!tc(n))return _e;const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(n),()=>{const s=r.indexOf(n);s!==-1&&r.splice(s,1)}}$set(e){this.$$set&&!Fc(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function lr(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function fo(t){if(typeof t!="boolean")throw new Error(`Expected boolean, not ${t}`)}function cc(t,...e){if(!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new TypeError(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function lo(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");lr(t.outputLen),lr(t.blockLen)}function io(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function ao(t,e){cc(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const et={number:lr,bool:fo,bytes:cc,hash:lo,exists:io,output:ao},Yr={node:void 0,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0};/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const uo=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),Wn=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),at=(t,e)=>t<<32-e|t>>>e,bo=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!bo)throw new Error("Non little-endian hardware is not supported");const ho=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function je(t){if(!(t instanceof Uint8Array))throw new Error("Uint8Array expected");let e="";for(let n=0;n<t.length;n++)e+=ho[t[n]];return e}function sn(t){if(typeof t!="string")throw new TypeError(`utf8ToBytes expected string, got ${typeof t}`);return new TextEncoder().encode(t)}function vn(t){if(typeof t=="string"&&(t=sn(t)),!(t instanceof Uint8Array))throw new TypeError(`Expected input type is Uint8Array (got ${typeof t})`);return t}function Er(...t){if(!t.every(r=>r instanceof Uint8Array))throw new Error("Uint8Array list expected");if(t.length===1)return t[0];const e=t.reduce((r,s)=>r+s.length,0),n=new Uint8Array(e);for(let r=0,s=0;r<t.length;r++){const c=t[r];n.set(c,s),s+=c.length}return n}class Br{clone(){return this._cloneInto()}}function wt(t){const e=r=>t().update(vn(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function po(t){const e=(r,s)=>t(s).update(vn(r)).digest(),n=t({});return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=r=>t(r),e}function Mt(t=32){if(Yr.web)return Yr.web.getRandomValues(new Uint8Array(t));throw new Error("The environment doesn't have randomBytes function")}function mo(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const s=BigInt(32),c=BigInt(4294967295),o=Number(n>>s&c),i=Number(n&c),l=r?4:0,a=r?0:4;t.setUint32(e+l,o,r),t.setUint32(e+a,i,r)}class oc extends Br{constructor(e,n,r,s){super(),this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Wn(this.buffer)}update(e){et.exists(this);const{view:n,buffer:r,blockLen:s}=this;e=vn(e);const c=e.length;for(let o=0;o<c;){const i=Math.min(s-this.pos,c-o);if(i===s){const l=Wn(e);for(;s<=c-o;o+=s)this.process(l,o);continue}r.set(e.subarray(o,o+i),this.pos),this.pos+=i,o+=i,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){et.exists(this),et.output(e,this),this.finished=!0;const{buffer:n,view:r,blockLen:s,isLE:c}=this;let{pos:o}=this;n[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(r,0),o=0);for(let h=o;h<s;h++)n[h]=0;mo(r,s-8,BigInt(this.length*8),c),this.process(r,0);const i=Wn(e),l=this.outputLen;if(l%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const a=l/4,b=this.get();if(a>b.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<a;h++)i.setUint32(4*h,b[h],c)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:r,length:s,finished:c,destroyed:o,pos:i}=this;return e.length=s,e.pos=i,e.finished=c,e.destroyed=o,s%n&&e.buffer.set(r),e}}const _o=(t,e,n)=>t&e^~t&n,go=(t,e,n)=>t&e^t&n^e&n,yo=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),It=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Ct=new Uint32Array(64);class fc extends oc{constructor(){super(64,32,8,!1),this.A=It[0]|0,this.B=It[1]|0,this.C=It[2]|0,this.D=It[3]|0,this.E=It[4]|0,this.F=It[5]|0,this.G=It[6]|0,this.H=It[7]|0}get(){const{A:e,B:n,C:r,D:s,E:c,F:o,G:i,H:l}=this;return[e,n,r,s,c,o,i,l]}set(e,n,r,s,c,o,i,l){this.A=e|0,this.B=n|0,this.C=r|0,this.D=s|0,this.E=c|0,this.F=o|0,this.G=i|0,this.H=l|0}process(e,n){for(let h=0;h<16;h++,n+=4)Ct[h]=e.getUint32(n,!1);for(let h=16;h<64;h++){const p=Ct[h-15],d=Ct[h-2],m=at(p,7)^at(p,18)^p>>>3,_=at(d,17)^at(d,19)^d>>>10;Ct[h]=_+Ct[h-7]+m+Ct[h-16]|0}let{A:r,B:s,C:c,D:o,E:i,F:l,G:a,H:b}=this;for(let h=0;h<64;h++){const p=at(i,6)^at(i,11)^at(i,25),d=b+p+_o(i,l,a)+yo[h]+Ct[h]|0,_=(at(r,2)^at(r,13)^at(r,22))+go(r,s,c)|0;b=a,a=l,l=i,i=o+d|0,o=c,c=s,s=r,r=d+_|0}r=r+this.A|0,s=s+this.B|0,c=c+this.C|0,o=o+this.D|0,i=i+this.E|0,l=l+this.F|0,a=a+this.G|0,b=b+this.H|0,this.set(r,s,c,o,i,l,a,b)}roundClean(){Ct.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class xo extends fc{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}const tt=wt(()=>new fc);wt(()=>new xo);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const vo=BigInt(0),kr=BigInt(1),wo=BigInt(2),Gn=t=>t instanceof Uint8Array,Eo=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function qt(t){if(!Gn(t))throw new Error("Uint8Array expected");let e="";for(let n=0;n<t.length;n++)e+=Eo[t[n]];return e}function lc(t){const e=t.toString(16);return e.length&1?`0${e}`:e}function Sr(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return BigInt(t===""?"0":`0x${t}`)}function rn(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);if(t.length%2)throw new Error("hex string is invalid: unpadded "+t.length);const e=new Uint8Array(t.length/2);for(let n=0;n<e.length;n++){const r=n*2,s=t.slice(r,r+2),c=Number.parseInt(s,16);if(Number.isNaN(c)||c<0)throw new Error("invalid byte sequence");e[n]=c}return e}function Ne(t){return Sr(qt(t))}function vt(t){if(!Gn(t))throw new Error("Uint8Array expected");return Sr(qt(Uint8Array.from(t).reverse()))}const He=(t,e)=>rn(t.toString(16).padStart(e*2,"0")),Xt=(t,e)=>He(t,e).reverse(),Bo=t=>rn(lc(t));function Ee(t,e,n){let r;if(typeof e=="string")try{r=rn(e)}catch(c){throw new Error(`${t} must be valid hex string, got "${e}". Cause: ${c}`)}else if(Gn(e))r=Uint8Array.from(e);else throw new Error(`${t} must be hex string or Uint8Array`);const s=r.length;if(typeof n=="number"&&s!==n)throw new Error(`${t} expected ${n} bytes, got ${s}`);return r}function Ie(...t){const e=new Uint8Array(t.reduce((r,s)=>r+s.length,0));let n=0;return t.forEach(r=>{if(!Gn(r))throw new Error("Uint8Array expected");e.set(r,n),n+=r.length}),e}function ic(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function Zn(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new TextEncoder().encode(t)}function nn(t){let e;for(e=0;t>0n;t>>=kr,e+=1);return e}const Nt=(t,e)=>t>>BigInt(e)&1n,gt=(t,e,n)=>t|(n?kr:vo)<<BigInt(e),cn=t=>(wo<<BigInt(t-1))-kr,Xn=t=>new Uint8Array(t),zr=t=>Uint8Array.from(t);function ac(t,e,n){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof n!="function")throw new Error("hmacFn must be a function");let r=Xn(t),s=Xn(t),c=0;const o=()=>{r.fill(1),s.fill(0),c=0},i=(...h)=>n(s,r,...h),l=(h=Xn())=>{s=i(zr([0]),h),r=i(),h.length!==0&&(s=i(zr([1]),h),r=i())},a=()=>{if(c++>=1e3)throw new Error("drbg: tried 1000 values");let h=0;const p=[];for(;h<e;){r=i();const d=r.slice();p.push(d),h+=r.length}return Ie(...p)};return(h,p)=>{o(),l(h);let d;for(;!(d=p(a()));)l();return o(),d}}const ko={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function Gt(t,e,n={}){const r=(s,c,o)=>{const i=ko[c];if(typeof i!="function")throw new Error(`Invalid validator "${c}", expected function`);const l=t[s];if(!(o&&l===void 0)&&!i(l,t))throw new Error(`Invalid param ${String(s)}=${l} (${typeof l}), expected ${c}`)};for(const[s,c]of Object.entries(e))r(s,c,!1);for(const[s,c]of Object.entries(n))r(s,c,!0);return t}const So=Object.freeze(Object.defineProperty({__proto__:null,bitGet:Nt,bitLen:nn,bitMask:cn,bitSet:gt,bytesToHex:qt,bytesToNumberBE:Ne,bytesToNumberLE:vt,concatBytes:Ie,createHmacDrbg:ac,ensureBytes:Ee,equalBytes:ic,hexToBytes:rn,hexToNumber:Sr,numberToBytesBE:He,numberToBytesLE:Xt,numberToHexUnpadded:lc,numberToVarBytesBE:Bo,utf8ToBytes:Zn,validateObject:Gt},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Ue=BigInt(0),Re=BigInt(1),jt=BigInt(2),Io=BigInt(3),ir=BigInt(4),Fr=BigInt(5),Wr=BigInt(8);BigInt(9);BigInt(16);function ye(t,e){const n=t%e;return n>=Ue?n:e+n}function uc(t,e,n){if(n<=Ue||e<Ue)throw new Error("Expected power/modulo > 0");if(n===Re)return Ue;let r=Re;for(;e>Ue;)e&Re&&(r=r*t%n),t=t*t%n,e>>=Re;return r}function we(t,e,n){let r=t;for(;e-- >Ue;)r*=r,r%=n;return r}function ar(t,e){if(t===Ue||e<=Ue)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let n=ye(t,e),r=e,s=Ue,c=Re;for(;n!==Ue;){const i=r/n,l=r%n,a=s-c*i;r=n,n=l,s=c,c=a}if(r!==Re)throw new Error("invert: does not exist");return ye(s,e)}function Co(t){const e=(t-Re)/jt;let n,r,s;for(n=t-Re,r=0;n%jt===Ue;n/=jt,r++);for(s=jt;s<t&&uc(s,e,t)!==t-Re;s++);if(r===1){const o=(t+Re)/ir;return function(l,a){const b=l.pow(a,o);if(!l.eql(l.sqr(b),a))throw new Error("Cannot find square root");return b}}const c=(n+Re)/jt;return function(i,l){if(i.pow(l,e)===i.neg(i.ONE))throw new Error("Cannot find square root");let a=r,b=i.pow(i.mul(i.ONE,s),n),h=i.pow(l,c),p=i.pow(l,n);for(;!i.eql(p,i.ONE);){if(i.eql(p,i.ZERO))return i.ZERO;let d=1;for(let _=i.sqr(p);d<a&&!i.eql(_,i.ONE);d++)_=i.sqr(_);const m=i.pow(b,Re<<BigInt(a-d-1));b=i.sqr(m),h=i.mul(h,m),p=i.mul(p,b),a=d}return h}}function Ao(t){if(t%ir===Io){const e=(t+Re)/ir;return function(r,s){const c=r.pow(s,e);if(!r.eql(r.sqr(c),s))throw new Error("Cannot find square root");return c}}if(t%Wr===Fr){const e=(t-Fr)/Wr;return function(r,s){const c=r.mul(s,jt),o=r.pow(c,e),i=r.mul(s,o),l=r.mul(r.mul(i,jt),o),a=r.mul(i,r.sub(l,r.ONE));if(!r.eql(r.sqr(a),s))throw new Error("Cannot find square root");return a}}return Co(t)}const Rt=(t,e)=>(ye(t,e)&Re)===Re,Po=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function dc(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},n=Po.reduce((r,s)=>(r[s]="function",r),e);return Gt(t,n)}function Kn(t,e,n){if(n<Ue)throw new Error("Expected power > 0");if(n===Ue)return t.ONE;if(n===Re)return e;let r=t.ONE,s=e;for(;n>Ue;)n&Re&&(r=t.mul(r,s)),s=t.sqr(s),n>>=1n;return r}function jn(t,e){const n=new Array(e.length),r=e.reduce((c,o,i)=>t.is0(o)?c:(n[i]=c,t.mul(c,o)),t.ONE),s=t.inv(r);return e.reduceRight((c,o,i)=>t.is0(o)?c:(n[i]=t.mul(c,n[i]),t.mul(c,o)),s),n}function Ir(t,e){const n=e!==void 0?e:t.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function Et(t,e,n=!1,r={}){if(t<=Ue)throw new Error(`Expected Fp ORDER > 0, got ${t}`);const{nBitLength:s,nByteLength:c}=Ir(t,e);if(c>2048)throw new Error("Field lengths over 2048 bytes are not supported");const o=Ao(t),i=Object.freeze({ORDER:t,BITS:s,BYTES:c,MASK:cn(s),ZERO:Ue,ONE:Re,create:l=>ye(l,t),isValid:l=>{if(typeof l!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof l}`);return Ue<=l&&l<t},is0:l=>l===Ue,isOdd:l=>(l&Re)===Re,neg:l=>ye(-l,t),eql:(l,a)=>l===a,sqr:l=>ye(l*l,t),add:(l,a)=>ye(l+a,t),sub:(l,a)=>ye(l-a,t),mul:(l,a)=>ye(l*a,t),pow:(l,a)=>Kn(i,l,a),div:(l,a)=>ye(l*ar(a,t),t),sqrN:l=>l*l,addN:(l,a)=>l+a,subN:(l,a)=>l-a,mulN:(l,a)=>l*a,inv:l=>ar(l,t),sqrt:r.sqrt||(l=>o(i,l)),invertBatch:l=>jn(i,l),cmov:(l,a,b)=>b?a:l,toBytes:l=>n?Xt(l,c):He(l,c),fromBytes:l=>{if(l.length!==c)throw new Error(`Fp.fromBytes: expected ${c}, got ${l.length}`);return n?vt(l):Ne(l)}});return Object.freeze(i)}function Oo(t,e){if(!t.isOdd)throw new Error("Field doesn't have isOdd");const n=t.sqrt(e);return t.isOdd(n)?t.neg(n):n}function bc(t,e,n=!1){t=Ee("privateHash",t);const r=t.length,s=Ir(e).nByteLength+8;if(s<24||r<s||r>1024)throw new Error(`hashToPrivateScalar: expected ${s}-1024 bytes of input, got ${r}`);const c=n?vt(t):Ne(t);return ye(c,e-Re)+Re}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Ro=BigInt(0),$n=BigInt(1);function hc(t,e){const n=(s,c)=>{const o=c.negate();return s?o:c},r=s=>{const c=Math.ceil(e/s)+1,o=2**(s-1);return{windows:c,windowSize:o}};return{constTimeNegate:n,unsafeLadder(s,c){let o=t.ZERO,i=s;for(;c>Ro;)c&$n&&(o=o.add(i)),i=i.double(),c>>=$n;return o},precomputeWindow(s,c){const{windows:o,windowSize:i}=r(c),l=[];let a=s,b=a;for(let h=0;h<o;h++){b=a,l.push(b);for(let p=1;p<i;p++)b=b.add(a),l.push(b);a=b.double()}return l},wNAF(s,c,o){const{windows:i,windowSize:l}=r(s);let a=t.ZERO,b=t.BASE;const h=BigInt(2**s-1),p=2**s,d=BigInt(s);for(let m=0;m<i;m++){const _=m*l;let y=Number(o&h);o>>=d,y>l&&(y-=p,o+=$n);const x=_,S=_+Math.abs(y)-1,E=m%2!==0,w=y<0;y===0?b=b.add(n(E,c[x])):a=a.add(n(w,c[S]))}return{p:a,f:b}},wNAFCached(s,c,o,i){const l=s._WINDOW_SIZE||1;let a=c.get(s);return a||(a=this.precomputeWindow(s,l),l!==1&&c.set(s,i(a))),this.wNAF(l,a,o)}}}function Cr(t){return dc(t.Fp),Gt(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Ir(t.n,t.nBitLength),...t})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Ho(t){const e=Cr(t);Gt(e,{a:"field",b:"field",fromBytes:"function",toBytes:"function"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean"});const{endo:n,Fp:r,a:s}=e;if(n){if(!r.eql(s,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof n!="object"||typeof n.beta!="bigint"||typeof n.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}const{bytesToNumberBE:To,hexToBytes:No}=So,Yt={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(t){const{Err:e}=Yt;if(t.length<2||t[0]!==2)throw new e("Invalid signature integer tag");const n=t[1],r=t.subarray(2,n+2);if(!n||r.length!==n)throw new e("Invalid signature integer: wrong length");if(r[0]===0&&r[1]<=127)throw new e("Invalid signature integer: trailing length");return{d:To(r),l:t.subarray(n+2)}},toSig(t){const{Err:e}=Yt,n=typeof t=="string"?No(t):t;if(!(n instanceof Uint8Array))throw new Error("ui8a expected");let r=n.length;if(r<2||n[0]!=48)throw new e("Invalid signature tag");if(n[1]!==r-2)throw new e("Invalid signature: incorrect length");const{d:s,l:c}=Yt._parseInt(n.subarray(2)),{d:o,l:i}=Yt._parseInt(c);if(i.length)throw new e("Invalid signature: left bytes after parsing");return{r:s,s:o}},hexFromSig(t){const e=a=>Number.parseInt(a[0],16)>=8?"00"+a:a,n=a=>{const b=a.toString(16);return b.length&1?`0${b}`:b},r=e(n(t.s)),s=e(n(t.r)),c=r.length/2,o=s.length/2,i=n(c),l=n(o);return`30${n(o+c+4)}02${l}${s}02${i}${r}`}},yt=BigInt(0),ot=BigInt(1);function ur(t){const e=Ho(t),{Fp:n}=e;function r(p){const{a:d,b:m}=e,_=n.sqr(p),y=n.mul(_,p);return n.add(n.add(y,n.mul(p,d)),m)}function s(p){return typeof p=="bigint"&&yt<p&&p<e.n}function c(p){if(!s(p))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function o(p){const{allowedPrivateKeyLengths:d,nByteLength:m,wrapPrivateKey:_,n:y}=e;if(d&&typeof p!="bigint"){if(p instanceof Uint8Array&&(p=qt(p)),typeof p!="string"||!d.includes(p.length))throw new Error("Invalid key");p=p.padStart(m*2,"0")}let x;try{x=typeof p=="bigint"?p:Ne(Ee("private key",p,m))}catch{throw new Error(`private key must be ${m} bytes, hex or bigint, not ${typeof p}`)}return _&&(x=ye(x,y)),c(x),x}const i=new Map;function l(p){if(!(p instanceof a))throw new Error("ProjectivePoint expected")}class a{constructor(d,m,_){if(this.px=d,this.py=m,this.pz=_,d==null||!n.isValid(d))throw new Error("x required");if(m==null||!n.isValid(m))throw new Error("y required");if(_==null||!n.isValid(_))throw new Error("z required")}static fromAffine(d){const{x:m,y:_}=d||{};if(!d||!n.isValid(m)||!n.isValid(_))throw new Error("invalid affine point");if(d instanceof a)throw new Error("projective point not allowed");const y=x=>n.eql(x,n.ZERO);return y(m)&&y(_)?a.ZERO:new a(m,_,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(d){const m=n.invertBatch(d.map(_=>_.pz));return d.map((_,y)=>_.toAffine(m[y])).map(a.fromAffine)}static fromHex(d){const m=a.fromAffine(e.fromBytes(Ee("pointHex",d)));return m.assertValidity(),m}static fromPrivateKey(d){return a.BASE.multiply(o(d))}_setWindowSize(d){this._WINDOW_SIZE=d,i.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint)return;throw new Error("bad point: ZERO")}const{x:d,y:m}=this.toAffine();if(!n.isValid(d)||!n.isValid(m))throw new Error("bad point: x or y not FE");const _=n.sqr(m),y=r(d);if(!n.eql(_,y))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:d}=this.toAffine();if(n.isOdd)return!n.isOdd(d);throw new Error("Field doesn't support isOdd")}equals(d){l(d);const{px:m,py:_,pz:y}=this,{px:x,py:S,pz:E}=d,w=n.eql(n.mul(m,E),n.mul(x,y)),v=n.eql(n.mul(_,E),n.mul(S,y));return w&&v}negate(){return new a(this.px,n.neg(this.py),this.pz)}double(){const{a:d,b:m}=e,_=n.mul(m,3n),{px:y,py:x,pz:S}=this;let E=n.ZERO,w=n.ZERO,v=n.ZERO,A=n.mul(y,y),Z=n.mul(x,x),T=n.mul(S,S),H=n.mul(y,x);return H=n.add(H,H),v=n.mul(y,S),v=n.add(v,v),E=n.mul(d,v),w=n.mul(_,T),w=n.add(E,w),E=n.sub(Z,w),w=n.add(Z,w),w=n.mul(E,w),E=n.mul(H,E),v=n.mul(_,v),T=n.mul(d,T),H=n.sub(A,T),H=n.mul(d,H),H=n.add(H,v),v=n.add(A,A),A=n.add(v,A),A=n.add(A,T),A=n.mul(A,H),w=n.add(w,A),T=n.mul(x,S),T=n.add(T,T),A=n.mul(T,H),E=n.sub(E,A),v=n.mul(T,Z),v=n.add(v,v),v=n.add(v,v),new a(E,w,v)}add(d){l(d);const{px:m,py:_,pz:y}=this,{px:x,py:S,pz:E}=d;let w=n.ZERO,v=n.ZERO,A=n.ZERO;const Z=e.a,T=n.mul(e.b,3n);let H=n.mul(m,x),j=n.mul(_,S),O=n.mul(y,E),N=n.add(m,_),D=n.add(x,S);N=n.mul(N,D),D=n.add(H,j),N=n.sub(N,D),D=n.add(m,y);let G=n.add(x,E);return D=n.mul(D,G),G=n.add(H,O),D=n.sub(D,G),G=n.add(_,y),w=n.add(S,E),G=n.mul(G,w),w=n.add(j,O),G=n.sub(G,w),A=n.mul(Z,D),w=n.mul(T,O),A=n.add(w,A),w=n.sub(j,A),A=n.add(j,A),v=n.mul(w,A),j=n.add(H,H),j=n.add(j,H),O=n.mul(Z,O),D=n.mul(T,D),j=n.add(j,O),O=n.sub(H,O),O=n.mul(Z,O),D=n.add(D,O),H=n.mul(j,D),v=n.add(v,H),H=n.mul(G,D),w=n.mul(N,w),w=n.sub(w,H),H=n.mul(N,j),A=n.mul(G,A),A=n.add(A,H),new a(w,v,A)}subtract(d){return this.add(d.negate())}is0(){return this.equals(a.ZERO)}wNAF(d){return h.wNAFCached(this,i,d,m=>{const _=n.invertBatch(m.map(y=>y.pz));return m.map((y,x)=>y.toAffine(_[x])).map(a.fromAffine)})}multiplyUnsafe(d){const m=a.ZERO;if(d===yt)return m;if(c(d),d===ot)return this;const{endo:_}=e;if(!_)return h.unsafeLadder(this,d);let{k1neg:y,k1:x,k2neg:S,k2:E}=_.splitScalar(d),w=m,v=m,A=this;for(;x>yt||E>yt;)x&ot&&(w=w.add(A)),E&ot&&(v=v.add(A)),A=A.double(),x>>=ot,E>>=ot;return y&&(w=w.negate()),S&&(v=v.negate()),v=new a(n.mul(v.px,_.beta),v.py,v.pz),w.add(v)}multiply(d){c(d);let m=d,_,y;const{endo:x}=e;if(x){const{k1neg:S,k1:E,k2neg:w,k2:v}=x.splitScalar(m);let{p:A,f:Z}=this.wNAF(E),{p:T,f:H}=this.wNAF(v);A=h.constTimeNegate(S,A),T=h.constTimeNegate(w,T),T=new a(n.mul(T.px,x.beta),T.py,T.pz),_=A.add(T),y=Z.add(H)}else{const{p:S,f:E}=this.wNAF(m);_=S,y=E}return a.normalizeZ([_,y])[0]}multiplyAndAddUnsafe(d,m,_){const y=a.BASE,x=(E,w)=>w===yt||w===ot||!E.equals(y)?E.multiplyUnsafe(w):E.multiply(w),S=x(this,m).add(x(d,_));return S.is0()?void 0:S}toAffine(d){const{px:m,py:_,pz:y}=this,x=this.is0();d==null&&(d=x?n.ONE:n.inv(y));const S=n.mul(m,d),E=n.mul(_,d),w=n.mul(y,d);if(x)return{x:n.ZERO,y:n.ZERO};if(!n.eql(w,n.ONE))throw new Error("invZ was invalid");return{x:S,y:E}}isTorsionFree(){const{h:d,isTorsionFree:m}=e;if(d===ot)return!0;if(m)return m(a,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:d,clearCofactor:m}=e;return d===ot?this:m?m(a,this):this.multiplyUnsafe(e.h)}toRawBytes(d=!0){return this.assertValidity(),e.toBytes(a,this,d)}toHex(d=!0){return qt(this.toRawBytes(d))}}a.BASE=new a(e.Gx,e.Gy,n.ONE),a.ZERO=new a(n.ZERO,n.ONE,n.ZERO);const b=e.nBitLength,h=hc(a,e.endo?Math.ceil(b/2):b);return{ProjectivePoint:a,normPrivateKeyToScalar:o,weierstrassEquation:r,isWithinCurveOrder:s}}function Lo(t){const e=Cr(t);return Gt(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function qo(t){const e=Lo(t),n=e.n,r=e.Fp,s=r.BYTES+1,c=2*r.BYTES+1;function o(R){return yt<R&&R<r.ORDER}function i(R){return ye(R,n)}function l(R){return ar(R,n)}const{ProjectivePoint:a,normPrivateKeyToScalar:b,weierstrassEquation:h,isWithinCurveOrder:p}=ur({...e,toBytes(R,I,k){const C=I.toAffine(),L=r.toBytes(C.x),U=Ie;return k?U(Uint8Array.from([I.hasEvenY()?2:3]),L):U(Uint8Array.from([4]),L,r.toBytes(C.y))},fromBytes(R){const I=R.length,k=R[0],C=R.subarray(1);if(I===s&&(k===2||k===3)){const L=Ne(C);if(!o(L))throw new Error("Point is not on curve");const U=h(L);let W=r.sqrt(U);const $=(W&ot)===ot;return(k&1)===1!==$&&(W=r.neg(W)),{x:L,y:W}}else if(I===c&&k===4){const L=r.fromBytes(C.subarray(0,r.BYTES)),U=r.fromBytes(C.subarray(r.BYTES,2*r.BYTES));return{x:L,y:U}}else throw new Error(`Point of length ${I} was invalid. Expected ${s} compressed bytes or ${c} uncompressed bytes`)}}),d=R=>qt(He(R,e.nByteLength));function m(R){const I=n>>ot;return R>I}function _(R){return m(R)?i(-R):R}const y=(R,I,k)=>Ne(R.slice(I,k));class x{constructor(I,k,C){this.r=I,this.s=k,this.recovery=C,this.assertValidity()}static fromCompact(I){const k=e.nByteLength;return I=Ee("compactSignature",I,k*2),new x(y(I,0,k),y(I,k,2*k))}static fromDER(I){const{r:k,s:C}=Yt.toSig(Ee("DER",I));return new x(k,C)}assertValidity(){if(!p(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!p(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(I){return new x(this.r,this.s,I)}recoverPublicKey(I){const{r:k,s:C,recovery:L}=this,U=Z(Ee("msgHash",I));if(L==null||![0,1,2,3].includes(L))throw new Error("recovery id invalid");const W=L===2||L===3?k+e.n:k;if(W>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");const $=L&1?"03":"02",V=a.fromHex($+d(W)),q=l(W),z=i(-U*q),ne=i(C*q),oe=a.BASE.multiplyAndAddUnsafe(V,z,ne);if(!oe)throw new Error("point at infinify");return oe.assertValidity(),oe}hasHighS(){return m(this.s)}normalizeS(){return this.hasHighS()?new x(this.r,i(-this.s),this.recovery):this}toDERRawBytes(){return rn(this.toDERHex())}toDERHex(){return Yt.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return rn(this.toCompactHex())}toCompactHex(){return d(this.r)+d(this.s)}}const S={isValidPrivateKey(R){try{return b(R),!0}catch{return!1}},normPrivateKeyToScalar:b,randomPrivateKey:()=>{const R=e.randomBytes(r.BYTES+8),I=bc(R,n);return He(I,e.nByteLength)},precompute(R=8,I=a.BASE){return I._setWindowSize(R),I.multiply(BigInt(3)),I}};function E(R,I=!0){return a.fromPrivateKey(R).toRawBytes(I)}function w(R){const I=R instanceof Uint8Array,k=typeof R=="string",C=(I||k)&&R.length;return I?C===s||C===c:k?C===2*s||C===2*c:R instanceof a}function v(R,I,k=!0){if(w(R))throw new Error("first arg must be private key");if(!w(I))throw new Error("second arg must be public key");return a.fromHex(I).multiply(b(R)).toRawBytes(k)}const A=e.bits2int||function(R){const I=Ne(R),k=R.length*8-e.nBitLength;return k>0?I>>BigInt(k):I},Z=e.bits2int_modN||function(R){return i(A(R))},T=cn(e.nBitLength);function H(R){if(typeof R!="bigint")throw new Error("bigint expected");if(!(yt<=R&&R<T))throw new Error(`bigint expected < 2^${e.nBitLength}`);return He(R,e.nByteLength)}function j(R,I,k=O){if(["recovered","canonical"].some(me=>me in k))throw new Error("sign() legacy options not supported");const{hash:C,randomBytes:L}=e;let{lowS:U,prehash:W,extraEntropy:$}=k;U==null&&(U=!0),R=Ee("msgHash",R),W&&(R=Ee("prehashed msgHash",C(R)));const V=Z(R),q=b(I),z=[H(q),H(V)];if($!=null){const me=$===!0?L(r.BYTES):$;z.push(Ee("extraEntropy",me,r.BYTES))}const ne=Ie(...z),oe=V;function ie(me){const he=A(me);if(!p(he))return;const xe=l(he),ge=a.BASE.multiply(he).toAffine(),fe=i(ge.x);if(fe===yt)return;const ve=i(xe*i(oe+fe*q));if(ve===yt)return;let $e=(ge.x===fe?0:2)|Number(ge.y&ot),lt=ve;return U&&m(ve)&&(lt=_(ve),$e^=1),new x(fe,lt,$e)}return{seed:ne,k2sig:ie}}const O={lowS:e.lowS,prehash:!1},N={lowS:e.lowS,prehash:!1};function D(R,I,k=O){const{seed:C,k2sig:L}=j(R,I,k);return ac(e.hash.outputLen,e.nByteLength,e.hmac)(C,L)}a.BASE._setWindowSize(8);function G(R,I,k,C=N){var ge;const L=R;if(I=Ee("msgHash",I),k=Ee("publicKey",k),"strict"in C)throw new Error("options.strict was renamed to lowS");const{lowS:U,prehash:W}=C;let $,V;try{if(typeof L=="string"||L instanceof Uint8Array)try{$=x.fromDER(L)}catch(fe){if(!(fe instanceof Yt.Err))throw fe;$=x.fromCompact(L)}else if(typeof L=="object"&&typeof L.r=="bigint"&&typeof L.s=="bigint"){const{r:fe,s:ve}=L;$=new x(fe,ve)}else throw new Error("PARSE");V=a.fromHex(k)}catch(fe){if(fe.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(U&&$.hasHighS())return!1;W&&(I=e.hash(I));const{r:q,s:z}=$,ne=Z(I),oe=l(z),ie=i(ne*oe),me=i(q*oe),he=(ge=a.BASE.multiplyAndAddUnsafe(V,ie,me))==null?void 0:ge.toAffine();return he?i(he.x)===q:!1}return{CURVE:e,getPublicKey:E,getSharedSecret:v,sign:D,verify:G,ProjectivePoint:a,Signature:x,utils:S}}function Uo(t,e){const n=t.ORDER;let r=0n;for(let p=n-1n;p%2n===0n;p/=2n)r+=1n;const s=r,c=(n-1n)/2n**s,o=(c-1n)/2n,i=2n**s-1n,l=2n**(s-1n),a=t.pow(e,c),b=t.pow(e,(c+1n)/2n);let h=(p,d)=>{let m=a,_=t.pow(d,i),y=t.sqr(_);y=t.mul(y,d);let x=t.mul(p,y);x=t.pow(x,o),x=t.mul(x,_),_=t.mul(x,d),y=t.mul(x,p);let S=t.mul(y,_);x=t.pow(S,l);let E=t.eql(x,t.ONE);_=t.mul(y,b),x=t.mul(S,m),y=t.cmov(_,y,E),S=t.cmov(x,S,E);for(let w=s;w>1;w--){let v=2n**(w-2n),A=t.pow(S,v);const Z=t.eql(A,t.ONE);_=t.mul(y,m),m=t.mul(m,m),A=t.mul(S,m),y=t.cmov(_,y,Z),S=t.cmov(A,S,Z)}return{isValid:E,value:y}};if(t.ORDER%4n===3n){const p=(t.ORDER-3n)/4n,d=t.sqrt(t.neg(e));h=(m,_)=>{let y=t.sqr(_);const x=t.mul(m,_);y=t.mul(y,x);let S=t.pow(y,p);S=t.mul(S,x);const E=t.mul(S,d),w=t.mul(t.sqr(S),_),v=t.eql(w,m);let A=t.cmov(E,S,v);return{isValid:v,value:A}}}return h}function on(t,e){if(dc(t),!t.isValid(e.A)||!t.isValid(e.B)||!t.isValid(e.Z))throw new Error("mapToCurveSimpleSWU: invalid opts");const n=Uo(t,e.Z);if(!t.isOdd)throw new Error("Fp.isOdd is not implemented!");return r=>{let s,c,o,i,l,a,b,h;s=t.sqr(r),s=t.mul(s,e.Z),c=t.sqr(s),c=t.add(c,s),o=t.add(c,t.ONE),o=t.mul(o,e.B),i=t.cmov(e.Z,t.neg(c),!t.eql(c,t.ZERO)),i=t.mul(i,e.A),c=t.sqr(o),a=t.sqr(i),l=t.mul(a,e.A),c=t.add(c,l),c=t.mul(c,o),a=t.mul(a,i),l=t.mul(a,e.B),c=t.add(c,l),b=t.mul(s,o);const{isValid:p,value:d}=n(c,a);h=t.mul(s,r),h=t.mul(h,d),b=t.cmov(b,o,p),h=t.cmov(h,d,p);const m=t.isOdd(r)===t.isOdd(h);return h=t.cmov(t.neg(h),h,m),b=t.div(b,i),{x:b,y:h}}}function Do(t){if(t instanceof Uint8Array)return t;if(typeof t=="string")return Zn(t);throw new Error("DST must be Uint8Array or string")}const Mo=Ne;function Ht(t,e){if(t<0||t>=1<<8*e)throw new Error(`bad I2OSP call: value=${t} length=${e}`);const n=Array.from({length:e}).fill(0);for(let r=e-1;r>=0;r--)n[r]=t&255,t>>>=8;return new Uint8Array(n)}function Go(t,e){const n=new Uint8Array(t.length);for(let r=0;r<t.length;r++)n[r]=t[r]^e[r];return n}function hn(t){if(!(t instanceof Uint8Array))throw new Error("Uint8Array expected")}function Ar(t){if(!Number.isSafeInteger(t))throw new Error("number expected")}function Zo(t,e,n,r){hn(t),hn(e),Ar(n),e.length>255&&(e=r(Ie(Zn("H2C-OVERSIZE-DST-"),e)));const{outputLen:s,blockLen:c}=r,o=Math.ceil(n/s);if(o>255)throw new Error("Invalid xmd length");const i=Ie(e,Ht(e.length,1)),l=Ht(0,c),a=Ht(n,2),b=new Array(o),h=r(Ie(l,t,a,Ht(0,1),i));b[0]=r(Ie(h,Ht(1,1),i));for(let d=1;d<=o;d++){const m=[Go(h,b[d-1]),Ht(d+1,1),i];b[d]=r(Ie(...m))}return Ie(...b).slice(0,n)}function Ko(t,e,n,r,s){if(hn(t),hn(e),Ar(n),e.length>255){const c=Math.ceil(2*r/8);e=s.create({dkLen:c}).update(Zn("H2C-OVERSIZE-DST-")).update(e).digest()}if(n>65535||e.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return s.create({dkLen:n}).update(t).update(Ht(n,2)).update(e).update(Ht(e.length,1)).digest()}function Xr(t,e,n){Gt(n,{DST:"string",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});const{p:r,k:s,m:c,hash:o,expand:i,DST:l}=n;hn(t),Ar(e);const a=Do(l),b=r.toString(2).length,h=Math.ceil((b+s)/8),p=e*c*h;let d;if(i==="xmd")d=Zo(t,a,p,o);else if(i==="xof")d=Ko(t,a,p,s,o);else if(i===void 0)d=t;else throw new Error('expand must be "xmd", "xof" or undefined');const m=new Array(e);for(let _=0;_<e;_++){const y=new Array(c);for(let x=0;x<c;x++){const S=h*(x+_*c),E=d.subarray(S,S+h);y[x]=ye(Mo(E),r)}m[_]=y}return m}function Pr(t,e){const n=e.map(r=>Array.from(r).reverse());return(r,s)=>{const[c,o,i,l]=n.map(a=>a.reduce((b,h)=>t.add(t.mul(b,r),h)));return r=t.div(c,o),s=t.mul(s,t.div(i,l)),{x:r,y:s}}}function Ut(t,e,n){if(typeof e!="function")throw new Error("mapToCurve() must be defined");return{hashToCurve(r,s){const c=Xr(r,2,{...n,DST:n.DST,...s}),o=t.fromAffine(e(c[0])),i=t.fromAffine(e(c[1])),l=o.add(i).clearCofactor();return l.assertValidity(),l},encodeToCurve(r,s){const c=Xr(r,1,{...n,DST:n.encodeDST,...s}),o=t.fromAffine(e(c[0])).clearCofactor();return o.assertValidity(),o}}}class pc extends Br{constructor(e,n){super(),this.finished=!1,this.destroyed=!1,et.hash(e);const r=vn(n);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new TypeError("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,c=new Uint8Array(s);c.set(r.length>s?e.create().update(r).digest():r);for(let o=0;o<c.length;o++)c[o]^=54;this.iHash.update(c),this.oHash=e.create();for(let o=0;o<c.length;o++)c[o]^=106;this.oHash.update(c),c.fill(0)}update(e){return et.exists(this),this.iHash.update(e),this}digestInto(e){et.exists(this),et.bytes(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:r,finished:s,destroyed:c,blockLen:o,outputLen:i}=this;return e=e,e.finished=s,e.destroyed=c,e.blockLen=o,e.outputLen=i,e.oHash=n._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const mc=(t,e,n)=>new pc(t,e).update(n).digest();mc.create=(t,e)=>new pc(t,e);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function jo(t){return{hash:t,hmac:(e,...n)=>mc(t,e,Er(...n)),randomBytes:Mt}}function wn(t,e){const n=r=>qo({...t,...jo(r)});return Object.freeze({...n(e),create:n})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Vn=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Ln=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),_c=BigInt(1),dr=BigInt(2),$r=(t,e)=>(t+e/dr)/e;function gc(t){const e=Vn,n=BigInt(3),r=BigInt(6),s=BigInt(11),c=BigInt(22),o=BigInt(23),i=BigInt(44),l=BigInt(88),a=t*t*t%e,b=a*a*t%e,h=we(b,n,e)*b%e,p=we(h,n,e)*b%e,d=we(p,dr,e)*a%e,m=we(d,s,e)*d%e,_=we(m,c,e)*m%e,y=we(_,i,e)*_%e,x=we(y,l,e)*y%e,S=we(x,i,e)*_%e,E=we(S,n,e)*b%e,w=we(E,o,e)*m%e,v=we(w,r,e)*a%e,A=we(v,dr,e);if(!Dt.eql(Dt.sqr(A),t))throw new Error("Cannot find square root");return A}const Dt=Et(Vn,void 0,void 0,{sqrt:gc}),Ye=wn({a:BigInt(0),b:BigInt(7),Fp:Dt,n:Ln,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{const e=Ln,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-_c*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),s=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),c=n,o=BigInt("0x100000000000000000000000000000000"),i=$r(c*t,e),l=$r(-r*t,e);let a=ye(t-i*n-l*s,e),b=ye(-i*r-l*c,e);const h=a>o,p=b>o;if(h&&(a=e-a),p&&(b=e-b),a>o||b>o)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:h,k1:a,k2neg:p,k2:b}}}},tt),Or=BigInt(0),yc=t=>typeof t=="bigint"&&Or<t&&t<Vn,Vo=t=>typeof t=="bigint"&&Or<t&&t<Ln,Qr={};function qn(t,...e){let n=Qr[t];if(n===void 0){const r=tt(Uint8Array.from(t,s=>s.charCodeAt(0)));n=Ie(r,r),Qr[t]=n}return tt(Ie(n,...e))}const Rr=t=>t.toRawBytes(!0).slice(1),br=t=>He(t,32),Qn=t=>ye(t,Vn),pn=t=>ye(t,Ln),Hr=Ye.ProjectivePoint,Yo=(t,e,n)=>Hr.BASE.multiplyAndAddUnsafe(t,e,n);function hr(t){let e=Ye.utils.normPrivateKeyToScalar(t),n=Hr.fromPrivateKey(e);return{scalar:n.hasEvenY()?e:pn(-e),bytes:Rr(n)}}function xc(t){if(!yc(t))throw new Error("bad x: need 0 < x < p");const e=Qn(t*t),n=Qn(e*t+BigInt(7));let r=gc(n);r%2n!==0n&&(r=Qn(-r));const s=new Hr(t,r,_c);return s.assertValidity(),s}function vc(...t){return pn(Ne(qn("BIP0340/challenge",...t)))}function zo(t){return hr(t).bytes}function Fo(t,e,n=Mt(32)){const r=Ee("message",t),{bytes:s,scalar:c}=hr(e),o=Ee("auxRand",n,32),i=br(c^Ne(qn("BIP0340/aux",o))),l=qn("BIP0340/nonce",i,s,r),a=pn(Ne(l));if(a===Or)throw new Error("sign failed: k is zero");const{bytes:b,scalar:h}=hr(a),p=vc(b,s,r),d=new Uint8Array(64);if(d.set(b,0),d.set(br(pn(h+p*c)),32),!wc(d,r,s))throw new Error("sign: Invalid signature produced");return d}function wc(t,e,n){const r=Ee("signature",t,64),s=Ee("message",e),c=Ee("publicKey",n,32);try{const o=xc(Ne(c)),i=Ne(r.subarray(0,32));if(!yc(i))return!1;const l=Ne(r.subarray(32,64));if(!Vo(l))return!1;const a=vc(br(i),Rr(o),s),b=Yo(o,l,pn(-a));return!(!b||!b.hasEvenY()||b.toAffine().x!==i)}catch{return!1}}const Wo={getPublicKey:zo,sign:Fo,verify:wc,utils:{randomPrivateKey:Ye.utils.randomPrivateKey,lift_x:xc,pointToBytes:Rr,numberToBytesBE:He,bytesToNumberBE:Ne,taggedHash:qn,mod:ye}},Xo=Pr(Dt,[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map(t=>t.map(e=>BigInt(e)))),$o=on(Dt,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:Dt.create(BigInt("-11"))});Ut(Ye.ProjectivePoint,t=>{const{x:e,y:n}=$o(Dt.create(t[0]));return Xo(e,n)},{DST:"secp256k1_XMD:SHA-256_SSWU_RO_",encodeDST:"secp256k1_XMD:SHA-256_SSWU_NU_",p:Dt.ORDER,m:1,k:128,expand:"xmd",hash:tt});const Cn=BigInt(2**32-1),pr=BigInt(32);function Ec(t,e=!1){return e?{h:Number(t&Cn),l:Number(t>>pr&Cn)}:{h:Number(t>>pr&Cn)|0,l:Number(t&Cn)|0}}function Qo(t,e=!1){let n=new Uint32Array(t.length),r=new Uint32Array(t.length);for(let s=0;s<t.length;s++){const{h:c,l:o}=Ec(t[s],e);[n[s],r[s]]=[c,o]}return[n,r]}const Jo=(t,e)=>BigInt(t>>>0)<<pr|BigInt(e>>>0),ef=(t,e,n)=>t>>>n,tf=(t,e,n)=>t<<32-n|e>>>n,nf=(t,e,n)=>t>>>n|e<<32-n,rf=(t,e,n)=>t<<32-n|e>>>n,sf=(t,e,n)=>t<<64-n|e>>>n-32,cf=(t,e,n)=>t>>>n-32|e<<64-n,of=(t,e)=>e,ff=(t,e)=>t,lf=(t,e,n)=>t<<n|e>>>32-n,af=(t,e,n)=>e<<n|t>>>32-n,uf=(t,e,n)=>e<<n-32|t>>>64-n,df=(t,e,n)=>t<<n-32|e>>>64-n;function bf(t,e,n,r){const s=(e>>>0)+(r>>>0);return{h:t+n+(s/2**32|0)|0,l:s|0}}const hf=(t,e,n)=>(t>>>0)+(e>>>0)+(n>>>0),pf=(t,e,n,r)=>e+n+r+(t/2**32|0)|0,mf=(t,e,n,r)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0),_f=(t,e,n,r,s)=>e+n+r+s+(t/2**32|0)|0,gf=(t,e,n,r,s)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0)+(s>>>0),yf=(t,e,n,r,s,c)=>e+n+r+s+c+(t/2**32|0)|0,pe={fromBig:Ec,split:Qo,toBig:Jo,shrSH:ef,shrSL:tf,rotrSH:nf,rotrSL:rf,rotrBH:sf,rotrBL:cf,rotr32H:of,rotr32L:ff,rotlSH:lf,rotlSL:af,rotlBH:uf,rotlBL:df,add:bf,add3L:hf,add3H:pf,add4L:mf,add4H:_f,add5H:yf,add5L:gf},[Bc,kc,Sc]=[[],[],[]],xf=BigInt(0),an=BigInt(1),vf=BigInt(2),wf=BigInt(7),Ef=BigInt(256),Bf=BigInt(113);for(let t=0,e=an,n=1,r=0;t<24;t++){[n,r]=[r,(2*n+3*r)%5],Bc.push(2*(5*r+n)),kc.push((t+1)*(t+2)/2%64);let s=xf;for(let c=0;c<7;c++)e=(e<<an^(e>>wf)*Bf)%Ef,e&vf&&(s^=an<<(an<<BigInt(c))-an);Sc.push(s)}const[kf,Sf]=pe.split(Sc,!0),Jr=(t,e,n)=>n>32?pe.rotlBH(t,e,n):pe.rotlSH(t,e,n),es=(t,e,n)=>n>32?pe.rotlBL(t,e,n):pe.rotlSL(t,e,n);function If(t,e=24){const n=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let o=0;o<10;o++)n[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const i=(o+8)%10,l=(o+2)%10,a=n[l],b=n[l+1],h=Jr(a,b,1)^n[i],p=es(a,b,1)^n[i+1];for(let d=0;d<50;d+=10)t[o+d]^=h,t[o+d+1]^=p}let s=t[2],c=t[3];for(let o=0;o<24;o++){const i=kc[o],l=Jr(s,c,i),a=es(s,c,i),b=Bc[o];s=t[b],c=t[b+1],t[b]=l,t[b+1]=a}for(let o=0;o<50;o+=10){for(let i=0;i<10;i++)n[i]=t[o+i];for(let i=0;i<10;i++)t[o+i]^=~n[(i+2)%10]&n[(i+4)%10]}t[0]^=kf[r],t[1]^=Sf[r]}n.fill(0)}class Yn extends Br{constructor(e,n,r,s=!1,c=24){if(super(),this.blockLen=e,this.suffix=n,this.outputLen=r,this.enableXOF=s,this.rounds=c,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,et.number(r),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=uo(this.state)}keccak(){If(this.state32,this.rounds),this.posOut=0,this.pos=0}update(e){et.exists(this);const{blockLen:n,state:r}=this;e=vn(e);const s=e.length;for(let c=0;c<s;){const o=Math.min(n-this.pos,s-c);for(let i=0;i<o;i++)r[this.pos++]^=e[c++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:n,pos:r,blockLen:s}=this;e[r]^=n,n&128&&r===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){et.exists(this,!1),et.bytes(e),this.finish();const n=this.state,{blockLen:r}=this;for(let s=0,c=e.length;s<c;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,c-s);e.set(n.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return et.number(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(et.output(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:n,suffix:r,outputLen:s,rounds:c,enableXOF:o}=this;return e||(e=new Yn(n,r,s,o,c)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=c,e.suffix=r,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}}const Zt=(t,e,n)=>wt(()=>new Yn(e,t,n));Zt(6,144,224/8);const Tr=Zt(6,136,256/8),Cf=Zt(6,104,384/8),Af=Zt(6,72,512/8);Zt(1,144,224/8);const Nr=Zt(1,136,256/8),Pf=Zt(1,104,384/8),Of=Zt(1,72,512/8),Ic=(t,e,n)=>po((r={})=>new Yn(e,t,r.dkLen===void 0?n:r.dkLen,!0));Ic(31,168,128/8);const Lr=Ic(31,136,256/8),Cc=(t,e,n,r,s,c,o)=>{const i=Et(n),l=i.create(t);return wn({a:l,b:e,Fp:i,n:r,Gx:c,Gy:o,h:s,lowS:!1},tt)},De=t=>t.toString(),Tn=t=>!/[^0-9]/.test(t),mr=t=>{try{return typeof BigInt(t)=="bigint"}catch{return!1}},Rf=t=>/[^0-9A-F]/gi.test(t),Tt=t=>t.message.split(/\r?\n/),An="0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef",Hf="0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef",Tf="0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef01",Nf="0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef01",Un=[{type:"ECDSA",list:["secp256k1","P256","P384","P521"]},{type:"Schnorr",list:["secp256k1"]},{type:"EdDSA",list:["ed25519","ed448"]},{type:"BLS",list:["bls12-381"],options:["G1","G2"]}],Fe={NO_MESSAGE:"Provide a message to sign to see the results.",POSITIVE_INT:"must be positive and non-floating point integer.",INT:"must be non-floating point integer."},_r={a:-3n,b:41058363725152142129326129780047268409114441015993725554835256314039467401291n,p:115792089210356248762697446949407573530086143415290314195533631308867097853951n,n:115792089210356248762697446949407573529996955224135760342422259061068512044369n,h:1n,Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},en=[];function En(t,e=_e){let n;const r=new Set;function s(i){if(qe(t,i)&&(t=i,n)){const l=!en.length;for(const a of r)a[1](),en.push(a,t);if(l){for(let a=0;a<en.length;a+=2)en[a][0](en[a+1]);en.length=0}}}function c(i){s(i(t))}function o(i,l=_e){const a=[i,l];return r.add(a),r.size===1&&(n=e(s)||_e),i(t),()=>{r.delete(a),r.size===0&&(n(),n=null)}}return{set:s,update:c,subscribe:o}}const ut=En(""),nt=En(""),Ke=En(0n),gr=En(""),yr=En("");function Lf(t){let e,n,r,s,c,o;const i=t[1].default,l=Xc(i,t,t[0],null);return{c(){e=u("div"),n=u("div"),r=u("div"),r.textContent="Hash function",s=P(),c=u("div"),l&&l.c(),g(r,"class","hashes-list__title"),g(n,"class","hashes-list"),g(e,"class","hashes-list-container svelte-wqqbct")},m(a,b){F(a,e,b),f(e,n),f(n,r),f(n,s),f(n,c),l&&l.m(c,null),o=!0},p(a,[b]){l&&l.p&&(!o||b&1)&&Qc(l,i,a,a[0],o?$c(i,a[0],b,null):Jc(a[0]),null)},i(a){o||(J(l,a),o=!0)},o(a){se(l,a),o=!1},d(a){a&&Y(e),l&&l.d(a)}}}function qf(t,e,n){let{$$slots:r={},$$scope:s}=e;return t.$$set=c=>{"$$scope"in c&&n(0,s=c.$$scope)},[s,r]}class Bn extends Ge{constructor(e){super(),Me(this,e,qf,Lf,qe,{})}}function Uf(t){let e,n,r,s,c,o,i;return{c(){e=u("span"),n=u("input"),r=P(),s=u("label"),c=X(t[0]),g(n,"type","radio"),g(n,"name","hash"),n.value=t[0],g(n,"id",t[0]),n.checked=t[1],g(s,"for",t[0]),g(e,"class","hash-radio svelte-3qb93j")},m(l,a){F(l,e,a),f(e,n),f(e,r),f(e,s),f(s,c),o||(i=ke(n,"change",t[3]),o=!0)},p(l,[a]){a&1&&(n.value=l[0]),a&1&&g(n,"id",l[0]),a&2&&(n.checked=l[1]),a&1&&ee(c,l[0]),a&1&&g(s,"for",l[0])},i:_e,o:_e,d(l){l&&Y(e),o=!1,i()}}}function Df(t,e,n){const r=Mn();let{hash:s}=e,{checked:c}=e;const o=()=>{r("change",s)};return t.$$set=i=>{"hash"in i&&n(0,s=i.hash),"checked"in i&&n(1,c=i.checked)},[s,c,r,o]}class kn extends Ge{constructor(e){super(),Me(this,e,Df,Uf,qe,{hash:0,checked:1})}}function Mf(t){let e,n,r,s,c,o,i;return{c(){e=u("div"),n=u("label"),n.innerHTML=`<strong>Message to sign</strong> 
    <small>(will be hashed with for ecdsa/bls12)</small>`,r=P(),s=u("div"),c=u("input"),g(n,"for","sign-message-input"),g(c,"class","text-input"),g(c,"id","sign-message-input"),g(c,"type","text"),g(c,"maxlength","512"),g(s,"class","sign-message__input-container svelte-nq1zbe"),g(e,"class","sign-message svelte-nq1zbe")},m(l,a){F(l,e,a),f(e,n),f(e,r),f(e,s),f(s,c),ct(c,t[0]),o||(i=ke(c,"input",t[1]),o=!0)},p(l,[a]){a&1&&c.value!==l[0]&&ct(c,l[0])},i:_e,o:_e,d(l){l&&Y(e),o=!1,i()}}}function Gf(t,e,n){let r;Se(t,nt,c=>n(0,r=c));function s(){r=this.value,nt.set(r)}return[r,s]}class Bt extends Ge{constructor(e){super(),Me(this,e,Gf,Mf,qe,{})}}function ts(t,e,n){const r=t.slice();return r[17]=e[n],r[19]=n,r}function ns(t){let e,n;return e=new kn({props:{hash:t[17],checked:t[19]===0}}),e.$on("change",t[11]),{c(){be(e.$$.fragment)},m(r,s){ue(e,r,s),n=!0},p:_e,i(r){n||(J(e.$$.fragment,r),n=!0)},o(r){se(e.$$.fragment,r),n=!1},d(r){de(e,r)}}}function Zf(t){let e,n,r=t[10],s=[];for(let o=0;o<r.length;o+=1)s[o]=ns(ts(t,r,o));const c=o=>se(s[o],1,1,()=>{s[o]=null});return{c(){for(let o=0;o<s.length;o+=1)s[o].c();e=ht()},m(o,i){for(let l=0;l<s.length;l+=1)s[l].m(o,i);F(o,e,i),n=!0},p(o,i){if(i&3072){r=o[10];let l;for(l=0;l<r.length;l+=1){const a=ts(o,r,l);s[l]?(s[l].p(a,i),J(s[l],1)):(s[l]=ns(a),s[l].c(),J(s[l],1),s[l].m(e.parentNode,e))}for(We(),l=r.length;l<s.length;l+=1)c(l);Xe()}},i(o){if(!n){for(let i=0;i<r.length;i+=1)J(s[i]);n=!0}},o(o){s=s.filter(Boolean);for(let i=0;i<s.length;i+=1)se(s[i]);n=!1},d(o){bt(s,o),o&&Y(e)}}}function Kf(t){let e;return{c(){e=u("p"),e.textContent=`${Fe.NO_MESSAGE}`},m(n,r){F(n,e,r)},p:_e,d(n){n&&Y(e)}}}function jf(t){let e,n,r,s,c,o,i,l,a,b,h,p,d,m,_,y,x,S,E,w,v,A,Z,T,H,j,O,N,D,G,R;return{c(){e=u("table"),n=u("tbody"),r=u("tr"),s=u("td"),s.textContent="msgHash",c=u("td"),o=u("code"),i=X(t[9]),l=P(),a=u("tr"),b=u("td"),b.textContent="r",h=u("td"),p=u("code"),d=X(t[5]),m=P(),_=u("tr"),y=u("td"),y.textContent="s",x=u("td"),S=u("code"),E=X(t[6]),w=P(),v=u("tr"),A=u("td"),A.textContent="compact",Z=u("td"),T=u("code"),H=X(t[7]),j=P(),O=u("tr"),N=u("td"),N.textContent="der",D=u("td"),G=u("code"),R=X(t[8]),g(s,"class","curve-data__key"),g(b,"class","curve-data__key"),g(y,"class","curve-data__key"),g(A,"class","curve-data__key"),g(N,"class","curve-data__key"),g(e,"class","curve-data__table")},m(I,k){F(I,e,k),f(e,n),f(n,r),f(r,s),f(r,c),f(c,o),f(o,i),f(n,l),f(n,a),f(a,b),f(a,h),f(h,p),f(p,d),f(n,m),f(n,_),f(_,y),f(_,x),f(x,S),f(S,E),f(n,w),f(n,v),f(v,A),f(v,Z),f(Z,T),f(T,H),f(n,j),f(n,O),f(O,N),f(O,D),f(D,G),f(G,R)},p(I,k){k&512&&ee(i,I[9]),k&32&&ee(d,I[5]),k&64&&ee(E,I[6]),k&128&&ee(H,I[7]),k&256&&ee(R,I[8])},d(I){I&&Y(e)}}}function Vf(t){let e,n,r,s,c,o,i,l,a,b,h,p,d,m,_,y,x,S,E,w,v,A,Z,T,H,j,O,N,D,G,R,I,k,C,L,U;I=new Bt({}),C=new Bn({props:{$$slots:{default:[Zf]},$$scope:{ctx:t}}});function W(q,z){return q[0]?jf:Kf}let $=W(t),V=$(t);return{c(){e=u("div"),n=u("h3"),n.textContent="Public key",r=P(),s=u("table"),c=u("tbody"),o=u("tr"),i=u("td"),i.textContent="x",l=u("td"),a=u("code"),b=X(t[1]),h=P(),p=u("tr"),d=u("td"),d.textContent="y",m=u("td"),_=u("code"),y=X(t[2]),x=P(),S=u("tr"),E=u("td"),E.textContent="33b hex",w=u("td"),v=u("code"),A=X(t[3]),Z=P(),T=u("tr"),H=u("td"),H.textContent="64b hex",j=u("td"),O=u("code"),N=X(t[4]),D=P(),G=u("h3"),G.textContent="Signature",R=P(),be(I.$$.fragment),k=P(),be(C.$$.fragment),L=P(),V.c(),g(n,"class","curve-data__header"),g(i,"class","curve-data__key"),g(d,"class","curve-data__key"),g(E,"class","curve-data__key"),g(H,"class","curve-data__key"),g(s,"class","curve-data__table"),g(G,"class","curve-data__header"),g(e,"class","curve-data")},m(q,z){F(q,e,z),f(e,n),f(e,r),f(e,s),f(s,c),f(c,o),f(o,i),f(o,l),f(l,a),f(a,b),f(c,h),f(c,p),f(p,d),f(p,m),f(m,_),f(_,y),f(c,x),f(c,S),f(S,E),f(S,w),f(w,v),f(v,A),f(c,Z),f(c,T),f(T,H),f(T,j),f(j,O),f(O,N),f(e,D),f(e,G),f(e,R),ue(I,e,null),f(e,k),ue(C,e,null),f(e,L),V.m(e,null),U=!0},p(q,[z]){(!U||z&2)&&ee(b,q[1]),(!U||z&4)&&ee(y,q[2]),(!U||z&8)&&ee(A,q[3]),(!U||z&16)&&ee(N,q[4]);const ne={};z&1048576&&(ne.$$scope={dirty:z,ctx:q}),C.$set(ne),$===($=W(q))&&V?V.p(q,z):(V.d(1),V=$(q),V&&(V.c(),V.m(e,null)))},i(q){U||(J(I.$$.fragment,q),J(C.$$.fragment,q),U=!0)},o(q){se(I.$$.fragment,q),se(C.$$.fragment,q),U=!1},d(q){q&&Y(e),de(I),de(C),V.d()}}}function Yf(t,e,n){let r,s,c;Se(t,nt,w=>n(14,s=w)),Se(t,Ke,w=>n(15,c=w));let{privKey:o}=e,i,l,a,b,h,p,d,m,_;Le(Ke,c=Ye.CURVE.n,c);let y="sha256";const x={sha256:tt,sha3_256:Tr,keccak_256:Nr},S=Object.keys(x),E=w=>{n(13,y=w.detail)};return t.$$set=w=>{"privKey"in w&&n(12,o=w.privKey)},t.$$.update=()=>{if(t.$$.dirty&16384&&n(0,r=s.length>0),t.$$.dirty&4096){const w=Ye.getPublicKey(o),v=Ye.ProjectivePoint.fromHex(w);n(1,[i,l]=[v.x,v.y].map(A=>De(A)),i,(n(2,l),n(12,o))),n(3,a=v.toHex(!0)),n(4,b=v.toHex(!1))}if(t.$$.dirty&28673&&r){const w=x[y],v=w(s),A=Ye.sign(v,o);n(5,[h,p]=[A.r,A.s].map(Z=>De(Z)),h,(n(6,p),n(0,r),n(13,y),n(14,s),n(12,o))),n(7,d=A.toCompactHex()),n(8,m=A.toDERHex()),n(9,_=je(v))}},[r,i,l,a,b,h,p,d,m,_,S,E,o,y,s]}class zf extends Ge{constructor(e){super(),Me(this,e,Yf,Vf,qe,{privKey:12})}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const mn=Et(BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff")),Ac=mn.create(BigInt("-3")),Pc=BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Ff=on(mn,{A:Ac,B:Pc,Z:mn.create(BigInt("-10"))}),Lt=wn({a:Ac,b:Pc,Fp:mn,n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),h:BigInt(1),lowS:!1},tt),Wf=Lt;Ut(Wf.ProjectivePoint,t=>Ff(t[0]),{DST:"P256_XMD:SHA-256_SSWU_RO_",encodeDST:"P256_XMD:SHA-256_SSWU_NU_",p:mn.ORDER,m:1,k:128,expand:"xmd",hash:tt});function rs(t,e,n){const r=t.slice();return r[17]=e[n],r[19]=n,r}function ss(t){let e,n;return e=new kn({props:{hash:t[17],checked:t[19]===0}}),e.$on("change",t[11]),{c(){be(e.$$.fragment)},m(r,s){ue(e,r,s),n=!0},p:_e,i(r){n||(J(e.$$.fragment,r),n=!0)},o(r){se(e.$$.fragment,r),n=!1},d(r){de(e,r)}}}function Xf(t){let e,n,r=t[10],s=[];for(let o=0;o<r.length;o+=1)s[o]=ss(rs(t,r,o));const c=o=>se(s[o],1,1,()=>{s[o]=null});return{c(){for(let o=0;o<s.length;o+=1)s[o].c();e=ht()},m(o,i){for(let l=0;l<s.length;l+=1)s[l].m(o,i);F(o,e,i),n=!0},p(o,i){if(i&3072){r=o[10];let l;for(l=0;l<r.length;l+=1){const a=rs(o,r,l);s[l]?(s[l].p(a,i),J(s[l],1)):(s[l]=ss(a),s[l].c(),J(s[l],1),s[l].m(e.parentNode,e))}for(We(),l=r.length;l<s.length;l+=1)c(l);Xe()}},i(o){if(!n){for(let i=0;i<r.length;i+=1)J(s[i]);n=!0}},o(o){s=s.filter(Boolean);for(let i=0;i<s.length;i+=1)se(s[i]);n=!1},d(o){bt(s,o),o&&Y(e)}}}function $f(t){let e;return{c(){e=u("p"),e.textContent=`${Fe.NO_MESSAGE}`},m(n,r){F(n,e,r)},p:_e,d(n){n&&Y(e)}}}function Qf(t){let e,n,r,s,c,o,i,l,a,b,h,p,d,m,_,y,x,S,E,w,v,A,Z,T,H,j,O,N,D,G,R;return{c(){e=u("table"),n=u("tbody"),r=u("tr"),s=u("td"),s.textContent="msgHash",c=u("td"),o=u("code"),i=X(t[9]),l=P(),a=u("tr"),b=u("td"),b.textContent="r",h=u("td"),p=u("code"),d=X(t[5]),m=P(),_=u("tr"),y=u("td"),y.textContent="s",x=u("td"),S=u("code"),E=X(t[6]),w=P(),v=u("tr"),A=u("td"),A.textContent="compact",Z=u("td"),T=u("code"),H=X(t[7]),j=P(),O=u("tr"),N=u("td"),N.textContent="der",D=u("td"),G=u("code"),R=X(t[8]),g(s,"class","curve-data__key"),g(b,"class","curve-data__key"),g(y,"class","curve-data__key"),g(A,"class","curve-data__key"),g(N,"class","curve-data__key"),g(e,"class","curve-data__table")},m(I,k){F(I,e,k),f(e,n),f(n,r),f(r,s),f(r,c),f(c,o),f(o,i),f(n,l),f(n,a),f(a,b),f(a,h),f(h,p),f(p,d),f(n,m),f(n,_),f(_,y),f(_,x),f(x,S),f(S,E),f(n,w),f(n,v),f(v,A),f(v,Z),f(Z,T),f(T,H),f(n,j),f(n,O),f(O,N),f(O,D),f(D,G),f(G,R)},p(I,k){k&512&&ee(i,I[9]),k&32&&ee(d,I[5]),k&64&&ee(E,I[6]),k&128&&ee(H,I[7]),k&256&&ee(R,I[8])},d(I){I&&Y(e)}}}function Jf(t){let e,n,r,s,c,o,i,l,a,b,h,p,d,m,_,y,x,S,E,w,v,A,Z,T,H,j,O,N,D,G,R,I,k,C,L,U;I=new Bt({}),C=new Bn({props:{$$slots:{default:[Xf]},$$scope:{ctx:t}}});function W(q,z){return q[0]?Qf:$f}let $=W(t),V=$(t);return{c(){e=u("div"),n=u("h3"),n.textContent="Public key",r=P(),s=u("table"),c=u("tbody"),o=u("tr"),i=u("td"),i.textContent="x",l=u("td"),a=u("code"),b=X(t[1]),h=P(),p=u("tr"),d=u("td"),d.textContent="y",m=u("td"),_=u("code"),y=X(t[2]),x=P(),S=u("tr"),E=u("td"),E.textContent="33b hex",w=u("td"),v=u("code"),A=X(t[3]),Z=P(),T=u("tr"),H=u("td"),H.textContent="64b hex",j=u("td"),O=u("code"),N=X(t[4]),D=P(),G=u("h3"),G.textContent="Signature",R=P(),be(I.$$.fragment),k=P(),be(C.$$.fragment),L=P(),V.c(),g(n,"class","curve-data__header"),g(i,"class","curve-data__key"),g(d,"class","curve-data__key"),g(E,"class","curve-data__key"),g(H,"class","curve-data__key"),g(s,"class","curve-data__table"),g(G,"class","curve-data__header"),g(e,"class","curve-data")},m(q,z){F(q,e,z),f(e,n),f(e,r),f(e,s),f(s,c),f(c,o),f(o,i),f(o,l),f(l,a),f(a,b),f(c,h),f(c,p),f(p,d),f(p,m),f(m,_),f(_,y),f(c,x),f(c,S),f(S,E),f(S,w),f(w,v),f(v,A),f(c,Z),f(c,T),f(T,H),f(T,j),f(j,O),f(O,N),f(e,D),f(e,G),f(e,R),ue(I,e,null),f(e,k),ue(C,e,null),f(e,L),V.m(e,null),U=!0},p(q,[z]){(!U||z&2)&&ee(b,q[1]),(!U||z&4)&&ee(y,q[2]),(!U||z&8)&&ee(A,q[3]),(!U||z&16)&&ee(N,q[4]);const ne={};z&1048576&&(ne.$$scope={dirty:z,ctx:q}),C.$set(ne),$===($=W(q))&&V?V.p(q,z):(V.d(1),V=$(q),V&&(V.c(),V.m(e,null)))},i(q){U||(J(I.$$.fragment,q),J(C.$$.fragment,q),U=!0)},o(q){se(I.$$.fragment,q),se(C.$$.fragment,q),U=!1},d(q){q&&Y(e),de(I),de(C),V.d()}}}function el(t,e,n){let r,s,c;Se(t,nt,w=>n(14,s=w)),Se(t,Ke,w=>n(15,c=w));let{privKey:o}=e,i,l,a,b,h,p,d,m,_;Le(Ke,c=Lt.CURVE.n,c);let y="sha256";const x={sha256:tt,sha3_256:Tr,keccak_256:Nr},S=Object.keys(x),E=w=>{n(13,y=w.detail)};return t.$$set=w=>{"privKey"in w&&n(12,o=w.privKey)},t.$$.update=()=>{if(t.$$.dirty&16384&&n(0,r=s.length>0),t.$$.dirty&4096){const w=Lt.getPublicKey(o),v=Lt.ProjectivePoint.fromHex(w);n(1,[i,l]=[v.x,v.y].map(A=>De(A)),i,(n(2,l),n(12,o))),n(3,a=v.toHex(!0)),n(4,b=v.toHex(!1))}if(t.$$.dirty&28673&&r){const w=x[y],v=w(s),A=Lt.sign(v,o);n(5,[h,p]=[A.r,A.s].map(Z=>De(Z)),h,(n(6,p),n(0,r),n(13,y),n(14,s),n(12,o))),n(7,d=A.toCompactHex()),n(8,m=A.toDERHex()),n(9,_=je(v))}},[r,i,l,a,b,h,p,d,m,_,S,E,o,y,s]}class tl extends Ge{constructor(e){super(),Me(this,e,el,Jf,qe,{privKey:12})}}const[nl,rl]=pe.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),At=new Uint32Array(80),Pt=new Uint32Array(80);class zn extends oc{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:n,Bh:r,Bl:s,Ch:c,Cl:o,Dh:i,Dl:l,Eh:a,El:b,Fh:h,Fl:p,Gh:d,Gl:m,Hh:_,Hl:y}=this;return[e,n,r,s,c,o,i,l,a,b,h,p,d,m,_,y]}set(e,n,r,s,c,o,i,l,a,b,h,p,d,m,_,y){this.Ah=e|0,this.Al=n|0,this.Bh=r|0,this.Bl=s|0,this.Ch=c|0,this.Cl=o|0,this.Dh=i|0,this.Dl=l|0,this.Eh=a|0,this.El=b|0,this.Fh=h|0,this.Fl=p|0,this.Gh=d|0,this.Gl=m|0,this.Hh=_|0,this.Hl=y|0}process(e,n){for(let E=0;E<16;E++,n+=4)At[E]=e.getUint32(n),Pt[E]=e.getUint32(n+=4);for(let E=16;E<80;E++){const w=At[E-15]|0,v=Pt[E-15]|0,A=pe.rotrSH(w,v,1)^pe.rotrSH(w,v,8)^pe.shrSH(w,v,7),Z=pe.rotrSL(w,v,1)^pe.rotrSL(w,v,8)^pe.shrSL(w,v,7),T=At[E-2]|0,H=Pt[E-2]|0,j=pe.rotrSH(T,H,19)^pe.rotrBH(T,H,61)^pe.shrSH(T,H,6),O=pe.rotrSL(T,H,19)^pe.rotrBL(T,H,61)^pe.shrSL(T,H,6),N=pe.add4L(Z,O,Pt[E-7],Pt[E-16]),D=pe.add4H(N,A,j,At[E-7],At[E-16]);At[E]=D|0,Pt[E]=N|0}let{Ah:r,Al:s,Bh:c,Bl:o,Ch:i,Cl:l,Dh:a,Dl:b,Eh:h,El:p,Fh:d,Fl:m,Gh:_,Gl:y,Hh:x,Hl:S}=this;for(let E=0;E<80;E++){const w=pe.rotrSH(h,p,14)^pe.rotrSH(h,p,18)^pe.rotrBH(h,p,41),v=pe.rotrSL(h,p,14)^pe.rotrSL(h,p,18)^pe.rotrBL(h,p,41),A=h&d^~h&_,Z=p&m^~p&y,T=pe.add5L(S,v,Z,rl[E],Pt[E]),H=pe.add5H(T,x,w,A,nl[E],At[E]),j=T|0,O=pe.rotrSH(r,s,28)^pe.rotrBH(r,s,34)^pe.rotrBH(r,s,39),N=pe.rotrSL(r,s,28)^pe.rotrBL(r,s,34)^pe.rotrBL(r,s,39),D=r&c^r&i^c&i,G=s&o^s&l^o&l;x=_|0,S=y|0,_=d|0,y=m|0,d=h|0,m=p|0,{h,l:p}=pe.add(a|0,b|0,H|0,j|0),a=i|0,b=l|0,i=c|0,l=o|0,c=r|0,o=s|0;const R=pe.add3L(j,N,G);r=pe.add3H(R,H,O,D),s=R|0}({h:r,l:s}=pe.add(this.Ah|0,this.Al|0,r|0,s|0)),{h:c,l:o}=pe.add(this.Bh|0,this.Bl|0,c|0,o|0),{h:i,l}=pe.add(this.Ch|0,this.Cl|0,i|0,l|0),{h:a,l:b}=pe.add(this.Dh|0,this.Dl|0,a|0,b|0),{h,l:p}=pe.add(this.Eh|0,this.El|0,h|0,p|0),{h:d,l:m}=pe.add(this.Fh|0,this.Fl|0,d|0,m|0),{h:_,l:y}=pe.add(this.Gh|0,this.Gl|0,_|0,y|0),{h:x,l:S}=pe.add(this.Hh|0,this.Hl|0,x|0,S|0),this.set(r,s,c,o,i,l,a,b,h,p,d,m,_,y,x,S)}roundClean(){At.fill(0),Pt.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class sl extends zn{constructor(){super(),this.Ah=-1942145080,this.Al=424955298,this.Bh=1944164710,this.Bl=-1982016298,this.Ch=502970286,this.Cl=855612546,this.Dh=1738396948,this.Dl=1479516111,this.Eh=258812777,this.El=2077511080,this.Fh=2011393907,this.Fl=79989058,this.Gh=1067287976,this.Gl=1780299464,this.Hh=286451373,this.Hl=-1848208735,this.outputLen=28}}class cl extends zn{constructor(){super(),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414,this.outputLen=32}}class ol extends zn{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}}const fn=wt(()=>new zn);wt(()=>new sl);wt(()=>new cl);const qr=wt(()=>new ol);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const fl=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),_n=Et(fl),Oc=_n.create(BigInt("-3")),Rc=BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),ll=on(_n,{A:Oc,B:Rc,Z:_n.create(BigInt("-12"))}),zt=wn({a:Oc,b:Rc,Fp:_n,n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f"),h:BigInt(1),lowS:!1},qr),il=zt;Ut(il.ProjectivePoint,t=>ll(t[0]),{DST:"P384_XMD:SHA-384_SSWU_RO_",encodeDST:"P384_XMD:SHA-384_SSWU_NU_",p:_n.ORDER,m:1,k:192,expand:"xmd",hash:qr});function cs(t,e,n){const r=t.slice();return r[17]=e[n],r[19]=n,r}function os(t){let e,n;return e=new kn({props:{hash:t[17],checked:t[19]===0}}),e.$on("change",t[11]),{c(){be(e.$$.fragment)},m(r,s){ue(e,r,s),n=!0},p:_e,i(r){n||(J(e.$$.fragment,r),n=!0)},o(r){se(e.$$.fragment,r),n=!1},d(r){de(e,r)}}}function al(t){let e,n,r=t[10],s=[];for(let o=0;o<r.length;o+=1)s[o]=os(cs(t,r,o));const c=o=>se(s[o],1,1,()=>{s[o]=null});return{c(){for(let o=0;o<s.length;o+=1)s[o].c();e=ht()},m(o,i){for(let l=0;l<s.length;l+=1)s[l].m(o,i);F(o,e,i),n=!0},p(o,i){if(i&3072){r=o[10];let l;for(l=0;l<r.length;l+=1){const a=cs(o,r,l);s[l]?(s[l].p(a,i),J(s[l],1)):(s[l]=os(a),s[l].c(),J(s[l],1),s[l].m(e.parentNode,e))}for(We(),l=r.length;l<s.length;l+=1)c(l);Xe()}},i(o){if(!n){for(let i=0;i<r.length;i+=1)J(s[i]);n=!0}},o(o){s=s.filter(Boolean);for(let i=0;i<s.length;i+=1)se(s[i]);n=!1},d(o){bt(s,o),o&&Y(e)}}}function ul(t){let e;return{c(){e=u("p"),e.textContent=`${Fe.NO_MESSAGE}`},m(n,r){F(n,e,r)},p:_e,d(n){n&&Y(e)}}}function dl(t){let e,n,r,s,c,o,i,l,a,b,h,p,d,m,_,y,x,S,E,w,v,A,Z,T,H,j,O,N,D,G,R;return{c(){e=u("table"),n=u("tbody"),r=u("tr"),s=u("td"),s.textContent="msgHash",c=u("td"),o=u("code"),i=X(t[9]),l=P(),a=u("tr"),b=u("td"),b.textContent="r",h=u("td"),p=u("code"),d=X(t[5]),m=P(),_=u("tr"),y=u("td"),y.textContent="s",x=u("td"),S=u("code"),E=X(t[6]),w=P(),v=u("tr"),A=u("td"),A.textContent="compact",Z=u("td"),T=u("code"),H=X(t[7]),j=P(),O=u("tr"),N=u("td"),N.textContent="der",D=u("td"),G=u("code"),R=X(t[8]),g(s,"class","curve-data__key"),g(b,"class","curve-data__key"),g(y,"class","curve-data__key"),g(A,"class","curve-data__key"),g(N,"class","curve-data__key"),g(e,"class","curve-data__table")},m(I,k){F(I,e,k),f(e,n),f(n,r),f(r,s),f(r,c),f(c,o),f(o,i),f(n,l),f(n,a),f(a,b),f(a,h),f(h,p),f(p,d),f(n,m),f(n,_),f(_,y),f(_,x),f(x,S),f(S,E),f(n,w),f(n,v),f(v,A),f(v,Z),f(Z,T),f(T,H),f(n,j),f(n,O),f(O,N),f(O,D),f(D,G),f(G,R)},p(I,k){k&512&&ee(i,I[9]),k&32&&ee(d,I[5]),k&64&&ee(E,I[6]),k&128&&ee(H,I[7]),k&256&&ee(R,I[8])},d(I){I&&Y(e)}}}function bl(t){let e,n,r,s,c,o,i,l,a,b,h,p,d,m,_,y,x,S,E,w,v,A,Z,T,H,j,O,N,D,G,R,I,k,C,L,U;I=new Bt({}),C=new Bn({props:{$$slots:{default:[al]},$$scope:{ctx:t}}});function W(q,z){return q[0]?dl:ul}let $=W(t),V=$(t);return{c(){e=u("div"),n=u("h3"),n.textContent="Public key",r=P(),s=u("table"),c=u("tbody"),o=u("tr"),i=u("td"),i.textContent="x",l=u("td"),a=u("code"),b=X(t[1]),h=P(),p=u("tr"),d=u("td"),d.textContent="y",m=u("td"),_=u("code"),y=X(t[2]),x=P(),S=u("tr"),E=u("td"),E.textContent="33b hex",w=u("td"),v=u("code"),A=X(t[3]),Z=P(),T=u("tr"),H=u("td"),H.textContent="64b hex",j=u("td"),O=u("code"),N=X(t[4]),D=P(),G=u("h3"),G.textContent="Signature",R=P(),be(I.$$.fragment),k=P(),be(C.$$.fragment),L=P(),V.c(),g(n,"class","curve-data__header"),g(i,"class","curve-data__key"),g(d,"class","curve-data__key"),g(E,"class","curve-data__key"),g(H,"class","curve-data__key"),g(s,"class","curve-data__table"),g(G,"class","curve-data__header"),g(e,"class","curve-data")},m(q,z){F(q,e,z),f(e,n),f(e,r),f(e,s),f(s,c),f(c,o),f(o,i),f(o,l),f(l,a),f(a,b),f(c,h),f(c,p),f(p,d),f(p,m),f(m,_),f(_,y),f(c,x),f(c,S),f(S,E),f(S,w),f(w,v),f(v,A),f(c,Z),f(c,T),f(T,H),f(T,j),f(j,O),f(O,N),f(e,D),f(e,G),f(e,R),ue(I,e,null),f(e,k),ue(C,e,null),f(e,L),V.m(e,null),U=!0},p(q,[z]){(!U||z&2)&&ee(b,q[1]),(!U||z&4)&&ee(y,q[2]),(!U||z&8)&&ee(A,q[3]),(!U||z&16)&&ee(N,q[4]);const ne={};z&1048576&&(ne.$$scope={dirty:z,ctx:q}),C.$set(ne),$===($=W(q))&&V?V.p(q,z):(V.d(1),V=$(q),V&&(V.c(),V.m(e,null)))},i(q){U||(J(I.$$.fragment,q),J(C.$$.fragment,q),U=!0)},o(q){se(I.$$.fragment,q),se(C.$$.fragment,q),U=!1},d(q){q&&Y(e),de(I),de(C),V.d()}}}function hl(t,e,n){let r,s,c;Se(t,nt,w=>n(14,s=w)),Se(t,Ke,w=>n(15,c=w));let{privKey:o}=e,i,l,a,b,h,p,d,m,_;Le(Ke,c=zt.CURVE.n,c);let y="sha384";const x={sha384:qr,sha3_384:Cf,keccak_384:Pf},S=Object.keys(x),E=w=>{n(13,y=w.detail)};return t.$$set=w=>{"privKey"in w&&n(12,o=w.privKey)},t.$$.update=()=>{if(t.$$.dirty&16384&&n(0,r=s.length>0),t.$$.dirty&4096){const w=zt.getPublicKey(o),v=zt.ProjectivePoint.fromHex(w);n(1,[i,l]=[v.x,v.y].map(A=>De(A)),i,(n(2,l),n(12,o))),n(3,a=v.toHex(!0)),n(4,b=v.toHex(!1))}if(t.$$.dirty&28673&&r){const w=x[y],v=w(s),A=zt.sign(v,o);n(5,[h,p]=[A.r,A.s].map(Z=>De(Z)),h,(n(6,p),n(0,r),n(13,y),n(14,s),n(12,o))),n(7,d=A.toCompactHex()),n(8,m=A.toDERHex()),n(9,_=je(v))}},[r,i,l,a,b,h,p,d,m,_,S,E,o,y,s]}class pl extends Ge{constructor(e){super(),Me(this,e,hl,bl,qe,{privKey:12})}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ml=BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),gn=Et(ml),Hc=gn.create(BigInt("-3")),Tc=BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),_l=on(gn,{A:Hc,B:Tc,Z:gn.create(BigInt("-4"))}),Ft=wn({a:Hc,b:Tc,Fp:gn,n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650"),h:BigInt(1),lowS:!1,allowedPrivateKeyLengths:[130,131,132]},fn),gl=Ft;Ut(gl.ProjectivePoint,t=>_l(t[0]),{DST:"P521_XMD:SHA-512_SSWU_RO_",encodeDST:"P521_XMD:SHA-512_SSWU_NU_",p:gn.ORDER,m:1,k:256,expand:"xmd",hash:fn});function fs(t,e,n){const r=t.slice();return r[17]=e[n],r[19]=n,r}function ls(t){let e,n;return e=new kn({props:{hash:t[17],checked:t[19]===0}}),e.$on("change",t[11]),{c(){be(e.$$.fragment)},m(r,s){ue(e,r,s),n=!0},p:_e,i(r){n||(J(e.$$.fragment,r),n=!0)},o(r){se(e.$$.fragment,r),n=!1},d(r){de(e,r)}}}function yl(t){let e,n,r=t[10],s=[];for(let o=0;o<r.length;o+=1)s[o]=ls(fs(t,r,o));const c=o=>se(s[o],1,1,()=>{s[o]=null});return{c(){for(let o=0;o<s.length;o+=1)s[o].c();e=ht()},m(o,i){for(let l=0;l<s.length;l+=1)s[l].m(o,i);F(o,e,i),n=!0},p(o,i){if(i&3072){r=o[10];let l;for(l=0;l<r.length;l+=1){const a=fs(o,r,l);s[l]?(s[l].p(a,i),J(s[l],1)):(s[l]=ls(a),s[l].c(),J(s[l],1),s[l].m(e.parentNode,e))}for(We(),l=r.length;l<s.length;l+=1)c(l);Xe()}},i(o){if(!n){for(let i=0;i<r.length;i+=1)J(s[i]);n=!0}},o(o){s=s.filter(Boolean);for(let i=0;i<s.length;i+=1)se(s[i]);n=!1},d(o){bt(s,o),o&&Y(e)}}}function xl(t){let e;return{c(){e=u("p"),e.textContent=`${Fe.NO_MESSAGE}`},m(n,r){F(n,e,r)},p:_e,d(n){n&&Y(e)}}}function vl(t){let e,n,r,s,c,o,i,l,a,b,h,p,d,m,_,y,x,S,E,w,v,A,Z,T,H,j,O,N,D,G,R;return{c(){e=u("table"),n=u("tbody"),r=u("tr"),s=u("td"),s.textContent="msgHash",c=u("td"),o=u("code"),i=X(t[9]),l=P(),a=u("tr"),b=u("td"),b.textContent="r",h=u("td"),p=u("code"),d=X(t[5]),m=P(),_=u("tr"),y=u("td"),y.textContent="s",x=u("td"),S=u("code"),E=X(t[6]),w=P(),v=u("tr"),A=u("td"),A.textContent="compact",Z=u("td"),T=u("code"),H=X(t[7]),j=P(),O=u("tr"),N=u("td"),N.textContent="der",D=u("td"),G=u("code"),R=X(t[8]),g(s,"class","curve-data__key"),g(b,"class","curve-data__key"),g(y,"class","curve-data__key"),g(A,"class","curve-data__key"),g(N,"class","curve-data__key"),g(e,"class","curve-data__table")},m(I,k){F(I,e,k),f(e,n),f(n,r),f(r,s),f(r,c),f(c,o),f(o,i),f(n,l),f(n,a),f(a,b),f(a,h),f(h,p),f(p,d),f(n,m),f(n,_),f(_,y),f(_,x),f(x,S),f(S,E),f(n,w),f(n,v),f(v,A),f(v,Z),f(Z,T),f(T,H),f(n,j),f(n,O),f(O,N),f(O,D),f(D,G),f(G,R)},p(I,k){k&512&&ee(i,I[9]),k&32&&ee(d,I[5]),k&64&&ee(E,I[6]),k&128&&ee(H,I[7]),k&256&&ee(R,I[8])},d(I){I&&Y(e)}}}function wl(t){let e,n,r,s,c,o,i,l,a,b,h,p,d,m,_,y,x,S,E,w,v,A,Z,T,H,j,O,N,D,G,R,I,k,C,L,U;I=new Bt({}),C=new Bn({props:{$$slots:{default:[yl]},$$scope:{ctx:t}}});function W(q,z){return q[0]?vl:xl}let $=W(t),V=$(t);return{c(){e=u("div"),n=u("h3"),n.textContent="Public key",r=P(),s=u("table"),c=u("tbody"),o=u("tr"),i=u("td"),i.textContent="x",l=u("td"),a=u("code"),b=X(t[1]),h=P(),p=u("tr"),d=u("td"),d.textContent="y",m=u("td"),_=u("code"),y=X(t[2]),x=P(),S=u("tr"),E=u("td"),E.textContent="33b hex",w=u("td"),v=u("code"),A=X(t[3]),Z=P(),T=u("tr"),H=u("td"),H.textContent="64b hex",j=u("td"),O=u("code"),N=X(t[4]),D=P(),G=u("h3"),G.textContent="Signature",R=P(),be(I.$$.fragment),k=P(),be(C.$$.fragment),L=P(),V.c(),g(n,"class","curve-data__header"),g(i,"class","curve-data__key"),g(d,"class","curve-data__key"),g(E,"class","curve-data__key"),g(H,"class","curve-data__key"),g(s,"class","curve-data__table"),g(G,"class","curve-data__header"),g(e,"class","curve-data")},m(q,z){F(q,e,z),f(e,n),f(e,r),f(e,s),f(s,c),f(c,o),f(o,i),f(o,l),f(l,a),f(a,b),f(c,h),f(c,p),f(p,d),f(p,m),f(m,_),f(_,y),f(c,x),f(c,S),f(S,E),f(S,w),f(w,v),f(v,A),f(c,Z),f(c,T),f(T,H),f(T,j),f(j,O),f(O,N),f(e,D),f(e,G),f(e,R),ue(I,e,null),f(e,k),ue(C,e,null),f(e,L),V.m(e,null),U=!0},p(q,[z]){(!U||z&2)&&ee(b,q[1]),(!U||z&4)&&ee(y,q[2]),(!U||z&8)&&ee(A,q[3]),(!U||z&16)&&ee(N,q[4]);const ne={};z&1048576&&(ne.$$scope={dirty:z,ctx:q}),C.$set(ne),$===($=W(q))&&V?V.p(q,z):(V.d(1),V=$(q),V&&(V.c(),V.m(e,null)))},i(q){U||(J(I.$$.fragment,q),J(C.$$.fragment,q),U=!0)},o(q){se(I.$$.fragment,q),se(C.$$.fragment,q),U=!1},d(q){q&&Y(e),de(I),de(C),V.d()}}}function El(t,e,n){let r,s,c;Se(t,nt,w=>n(14,s=w)),Se(t,Ke,w=>n(15,c=w));let{privKey:o}=e,i,l,a,b,h,p,d,m,_;Le(Ke,c=Ft.CURVE.n,c);let y="sha512";const x={sha512:fn,sha3_512:Af,keccak_512:Of},S=Object.keys(x),E=w=>{n(13,y=w.detail)};return t.$$set=w=>{"privKey"in w&&n(12,o=w.privKey)},t.$$.update=()=>{if(t.$$.dirty&16384&&n(0,r=s.length>0),t.$$.dirty&4096){const w=Ft.getPublicKey(o),v=Ft.ProjectivePoint.fromHex(w);n(1,[i,l]=[v.x,v.y].map(A=>De(A)),i,(n(2,l),n(12,o))),n(3,a=v.toHex(!0)),n(4,b=v.toHex(!1))}if(t.$$.dirty&28673&&r){const w=x[y],v=w(s),A=Ft.sign(v,o);n(5,[h,p]=[A.r,A.s].map(Z=>De(Z)),h,(n(6,p),n(0,r),n(13,y),n(14,s),n(12,o))),n(7,d=A.toCompactHex()),n(8,m=A.toDERHex()),n(9,_=je(v))}},[r,i,l,a,b,h,p,d,m,_,S,E,o,y,s]}class Bl extends Ge{constructor(e){super(),Me(this,e,El,wl,qe,{privKey:12})}}function kl(t){let e;return{c(){e=u("p"),e.textContent=`${Fe.NO_MESSAGE}`},m(n,r){F(n,e,r)},p:_e,d(n){n&&Y(e)}}}function Sl(t){let e,n,r,s,c,o,i,l,a,b,h,p,d,m,_,y,x,S,E;return{c(){e=u("table"),n=u("tbody"),r=u("tr"),s=u("td"),s.textContent="msg",c=u("td"),o=u("code"),i=X(t[1]),l=P(),a=u("tr"),b=u("td"),b.textContent="auxRand",h=u("td"),p=u("code"),d=X(t[2]),m=P(),_=u("tr"),y=u("td"),y.textContent="sigHex",x=u("td"),S=u("code"),E=X(t[3]),g(s,"class","curve-data__key"),g(b,"class","curve-data__key"),g(y,"class","curve-data__key"),g(e,"class","curve-data__table")},m(w,v){F(w,e,v),f(e,n),f(n,r),f(r,s),f(r,c),f(c,o),f(o,i),f(n,l),f(n,a),f(a,b),f(a,h),f(h,p),f(p,d),f(n,m),f(n,_),f(_,y),f(_,x),f(x,S),f(S,E)},p(w,v){v&2&&ee(i,w[1]),v&4&&ee(d,w[2]),v&8&&ee(E,w[3])},d(w){w&&Y(e)}}}function Il(t){let e,n,r,s,c,o;s=new Bt({});function i(b,h){return b[0]?Sl:kl}let l=i(t),a=l(t);return{c(){e=u("div"),n=u("h3"),n.textContent="Signature",r=P(),be(s.$$.fragment),c=P(),a.c(),g(n,"class","curve-data__header"),g(e,"class","curve-data")},m(b,h){F(b,e,h),f(e,n),f(e,r),ue(s,e,null),f(e,c),a.m(e,null),o=!0},p(b,[h]){l===(l=i(b))&&a?a.p(b,h):(a.d(1),a=l(b),a&&(a.c(),a.m(e,null)))},i(b){o||(J(s.$$.fragment,b),o=!0)},o(b){se(s.$$.fragment,b),o=!1},d(b){b&&Y(e),de(s),a.d()}}}function Cl(t,e,n){let r,s,c;Se(t,nt,b=>n(5,s=b)),Se(t,Ke,b=>n(6,c=b));let{privKey:o}=e,i,l,a;return Le(Ke,c=Ye.CURVE.n,c),t.$$set=b=>{"privKey"in b&&n(4,o=b.privKey)},t.$$.update=()=>{if(t.$$.dirty&32&&n(0,r=s.length>0),t.$$.dirty&49&&r){const b=sn(s),h=Mt(),p=Wo.sign(b,o,h);n(1,i=je(b)),n(2,l=je(h)),n(3,a=je(p))}},[r,i,l,a,o,s]}class Al extends Ge{constructor(e){super(),Me(this,e,Cl,Il,qe,{privKey:4})}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _t=BigInt(0),st=BigInt(1),Pn=BigInt(2),Pl=BigInt(8);function Ol(t){const e=Cr(t);return Gt(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function Sn(t){const e=Ol(t),{Fp:n,n:r,preHash:s,hash:c,randomBytes:o,nByteLength:i,h:l}=e,a=Pn**BigInt(i*8),b=n.create,h=e.uvRatio||((k,C)=>{try{return{isValid:!0,value:n.sqrt(k*n.inv(C))}}catch{return{isValid:!1,value:_t}}}),p=e.adjustScalarBytes||(k=>k),d=e.domain||((k,C,L)=>{if(C.length||L)throw new Error("Contexts/pre-hash are not supported");return k}),m=k=>typeof k=="bigint"&&0n<k,_=(k,C)=>m(k)&&m(C)&&k<C,y=k=>k===_t||_(k,a);function x(k,C){if(_(k,C))return k;throw new Error(`Expected valid scalar < ${C}, got ${typeof k} ${k}`)}function S(k){return k===_t?k:x(k,r)}const E=new Map;function w(k){if(!(k instanceof v))throw new Error("ExtendedPoint expected")}class v{constructor(C,L,U,W){if(this.ex=C,this.ey=L,this.ez=U,this.et=W,!y(C))throw new Error("x required");if(!y(L))throw new Error("y required");if(!y(U))throw new Error("z required");if(!y(W))throw new Error("t required")}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(C){if(C instanceof v)throw new Error("extended point not allowed");const{x:L,y:U}=C||{};if(!y(L)||!y(U))throw new Error("invalid affine point");return new v(L,U,st,b(L*U))}static normalizeZ(C){const L=n.invertBatch(C.map(U=>U.ez));return C.map((U,W)=>U.toAffine(L[W])).map(v.fromAffine)}_setWindowSize(C){this._WINDOW_SIZE=C,E.delete(this)}assertValidity(){const{a:C,d:L}=e;if(this.is0())throw new Error("bad point: ZERO");const{ex:U,ey:W,ez:$,et:V}=this,q=b(U*U),z=b(W*W),ne=b($*$),oe=b(ne*ne),ie=b(q*C),me=b(ne*b(ie+z)),he=b(oe+b(L*b(q*z)));if(me!==he)throw new Error("bad point: equation left != right (1)");const xe=b(U*W),ge=b($*V);if(xe!==ge)throw new Error("bad point: equation left != right (2)")}equals(C){w(C);const{ex:L,ey:U,ez:W}=this,{ex:$,ey:V,ez:q}=C,z=b(L*q),ne=b($*W),oe=b(U*q),ie=b(V*W);return z===ne&&oe===ie}is0(){return this.equals(v.ZERO)}negate(){return new v(b(-this.ex),this.ey,this.ez,b(-this.et))}double(){const{a:C}=e,{ex:L,ey:U,ez:W}=this,$=b(L*L),V=b(U*U),q=b(Pn*b(W*W)),z=b(C*$),ne=L+U,oe=b(b(ne*ne)-$-V),ie=z+V,me=ie-q,he=z-V,xe=b(oe*me),ge=b(ie*he),fe=b(oe*he),ve=b(me*ie);return new v(xe,ge,ve,fe)}add(C){w(C);const{a:L,d:U}=e,{ex:W,ey:$,ez:V,et:q}=this,{ex:z,ey:ne,ez:oe,et:ie}=C;if(L===BigInt(-1)){const ze=b(($-W)*(ne+z)),Be=b(($+W)*(ne-z)),Ve=b(Be-ze);if(Ve===_t)return this.double();const Ce=b(V*Pn*ie),$t=b(q*Pn*oe),rt=$t+Ce,Qt=Be+ze,Pe=$t-Ce,Ze=b(rt*Ve),ln=b(Qt*Pe),Kt=b(rt*Pe),Qe=b(Ve*Qt);return new v(Ze,ln,Qe,Kt)}const me=b(W*z),he=b($*ne),xe=b(q*U*ie),ge=b(V*oe),fe=b((W+$)*(z+ne)-me-he),ve=ge-xe,$e=ge+xe,lt=b(he-L*me),pt=b(fe*ve),it=b($e*lt),mt=b(fe*lt),kt=b(ve*$e);return new v(pt,it,kt,mt)}subtract(C){return this.add(C.negate())}wNAF(C){return T.wNAFCached(this,E,C,v.normalizeZ)}multiply(C){const{p:L,f:U}=this.wNAF(x(C,r));return v.normalizeZ([L,U])[0]}multiplyUnsafe(C){let L=S(C);return L===_t?Z:this.equals(Z)||L===st?this:this.equals(A)?this.wNAF(L).p:T.unsafeLadder(this,L)}isSmallOrder(){return this.multiplyUnsafe(l).is0()}isTorsionFree(){return T.unsafeLadder(this,r).is0()}toAffine(C){const{ex:L,ey:U,ez:W}=this,$=this.is0();C==null&&(C=$?Pl:n.inv(W));const V=b(L*C),q=b(U*C),z=b(W*C);if($)return{x:_t,y:st};if(z!==st)throw new Error("invZ was invalid");return{x:V,y:q}}clearCofactor(){const{h:C}=e;return C===st?this:this.multiplyUnsafe(C)}static fromHex(C,L=!0){const{d:U,a:W}=e,$=n.BYTES;C=Ee("pointHex",C,$);const V=C.slice(),q=C[$-1];V[$-1]=q&-129;const z=vt(V);z===_t||(L?x(z,n.ORDER):x(z,a));const ne=b(z*z),oe=b(ne-st),ie=b(U*ne-W);let{isValid:me,value:he}=h(oe,ie);if(!me)throw new Error("Point.fromHex: invalid y coordinate");const xe=(he&st)===st;return(q&128)!==0!==xe&&(he=b(-he)),v.fromAffine({x:he,y:z})}static fromPrivateKey(C){return O(C).point}toRawBytes(){const{x:C,y:L}=this.toAffine(),U=Xt(L,n.BYTES);return U[U.length-1]|=C&st?128:0,U}toHex(){return qt(this.toRawBytes())}}v.BASE=new v(e.Gx,e.Gy,st,b(e.Gx*e.Gy)),v.ZERO=new v(_t,st,st,_t);const{BASE:A,ZERO:Z}=v,T=hc(v,i*8);function H(k){return ye(k,r)}function j(k){return H(vt(k))}function O(k){const C=i;k=Ee("private key",k,C);const L=Ee("hashed private key",c(k),2*C),U=p(L.slice(0,C)),W=L.slice(C,2*C),$=j(U),V=A.multiply($),q=V.toRawBytes();return{head:U,prefix:W,scalar:$,point:V,pointBytes:q}}function N(k){return O(k).pointBytes}function D(k=new Uint8Array,...C){const L=Ie(...C);return j(c(d(L,Ee("context",k),!!s)))}function G(k,C,L){k=Ee("message",k),s&&(k=s(k));const{prefix:U,scalar:W,pointBytes:$}=O(C),V=D(L,U,k),q=A.multiply(V).toRawBytes(),z=D(L,q,$,k),ne=H(V+z*W);S(ne);const oe=Ie(q,Xt(ne,n.BYTES));return Ee("result",oe,i*2)}function R(k,C,L,U){const W=n.BYTES;k=Ee("signature",k,2*W),C=Ee("message",C),s&&(C=s(C));const $=v.fromHex(L,!1),V=v.fromHex(k.slice(0,W),!1),q=vt(k.slice(W,2*W)),z=A.multiplyUnsafe(q),ne=D(U,V.toRawBytes(),$.toRawBytes(),C);return V.add($.multiplyUnsafe(ne)).subtract(z).clearCofactor().equals(v.ZERO)}return A._setWindowSize(8),{CURVE:e,getPublicKey:N,sign:G,verify:R,ExtendedPoint:v,utils:{getExtendedPublicKey:O,randomPrivateKey:()=>o(n.BYTES),precompute(k=8,C=v.BASE){return C._setWindowSize(k),C.multiply(BigInt(3)),C}}}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const un=BigInt(0),Jn=BigInt(1);function Rl(t){return Gt(t,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...t})}function Nc(t){const e=Rl(t),{P:n}=e,r=E=>ye(E,n),s=e.montgomeryBits,c=Math.ceil(s/8),o=e.nByteLength,i=e.adjustScalarBytes||(E=>E),l=e.powPminus2||(E=>uc(E,n-BigInt(2),n));function a(E,w,v){const A=r(E*(w-v));return w=r(w-A),v=r(v+A),[w,v]}function b(E){if(typeof E=="bigint"&&un<=E&&E<n)return E;throw new Error("Expected valid scalar 0 < scalar < CURVE.P")}const h=(e.a-BigInt(2))/BigInt(4);function p(E,w){const v=b(E),A=b(w),Z=v;let T=Jn,H=un,j=v,O=Jn,N=un,D;for(let R=BigInt(s-1);R>=un;R--){const I=A>>R&Jn;N^=I,D=a(N,T,j),T=D[0],j=D[1],D=a(N,H,O),H=D[0],O=D[1],N=I;const k=T+H,C=r(k*k),L=T-H,U=r(L*L),W=C-U,$=j+O,V=j-O,q=r(V*k),z=r($*L),ne=q+z,oe=q-z;j=r(ne*ne),O=r(Z*r(oe*oe)),T=r(C*U),H=r(W*(C+r(h*W)))}D=a(N,T,j),T=D[0],j=D[1],D=a(N,H,O),H=D[0],O=D[1];const G=l(H);return r(T*G)}function d(E){return Xt(r(E),c)}function m(E){const w=Ee("u coordinate",E,c);return o===c&&(w[o-1]&=127),vt(w)}function _(E){const w=Ee("scalar",E);if(w.length!==c&&w.length!==o)throw new Error(`Expected ${c} or ${o} bytes, got ${w.length}`);return vt(i(w))}function y(E,w){const v=m(w),A=_(E),Z=p(v,A);if(Z===un)throw new Error("Invalid private or public key received");return d(Z)}const x=d(e.Gu);function S(E){return y(E,x)}return{scalarMult:y,scalarMultBase:S,getSharedSecret:(E,w)=>y(E,w),getPublicKey:E=>S(E),utils:{randomPrivateKey:()=>e.randomBytes(e.nByteLength)},GuBytes:x}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const yn=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),is=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),Hl=BigInt(0),xt=BigInt(1),Dn=BigInt(2),Tl=BigInt(5),as=BigInt(10),Nl=BigInt(20),Ll=BigInt(40),us=BigInt(80);function Lc(t){const e=yn,r=t*t%e*t%e,s=we(r,Dn,e)*r%e,c=we(s,xt,e)*t%e,o=we(c,Tl,e)*c%e,i=we(o,as,e)*o%e,l=we(i,Nl,e)*i%e,a=we(l,Ll,e)*l%e,b=we(a,us,e)*a%e,h=we(b,us,e)*a%e,p=we(h,as,e)*o%e;return{pow_p_5_8:we(p,Dn,e)*t%e,b2:r}}function qc(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function Ur(t,e){const n=yn,r=ye(e*e*e,n),s=ye(r*r*e,n),c=Lc(t*s).pow_p_5_8;let o=ye(t*r*c,n);const i=ye(e*o*o,n),l=o,a=ye(o*is,n),b=i===t,h=i===ye(-t,n),p=i===ye(-t*is,n);return b&&(o=l),(h||p)&&(o=a),Rt(o,n)&&(o=ye(-o,n)),{isValid:b||h,value:o}}const ce=Et(yn,void 0,!0),Dr={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:ce,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:fn,randomBytes:Mt,adjustScalarBytes:qc,uvRatio:Ur},Oe=Sn(Dr);function Uc(t,e,n){if(e.length>255)throw new Error("Context is too big");return Er(sn("SigEd25519 no Ed25519 collisions"),new Uint8Array([n?1:0,e.length]),e,t)}Sn({...Dr,domain:Uc});Sn({...Dr,domain:Uc,preHash:fn});Nc({P:yn,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:t=>{const e=yn,{pow_p_5_8:n,b2:r}=Lc(t);return ye(we(n,BigInt(3),e)*r,e)},adjustScalarBytes:qc,randomBytes:Mt});const ql=(ce.ORDER+BigInt(3))/BigInt(8),Ul=ce.pow(Dn,ql),ds=ce.sqrt(ce.neg(ce.ONE)),Dl=(ce.ORDER-BigInt(5))/BigInt(8),bs=BigInt(486662);function Ml(t){let e=ce.sqr(t);e=ce.mul(e,Dn);let n=ce.add(e,ce.ONE),r=ce.neg(bs),s=ce.sqr(n),c=ce.mul(s,n),o=ce.mul(e,bs);o=ce.mul(o,r),o=ce.add(o,s),o=ce.mul(o,r);let i=ce.sqr(c);s=ce.sqr(i),i=ce.mul(i,c),i=ce.mul(i,o),s=ce.mul(s,i);let l=ce.pow(s,Dl);l=ce.mul(l,i);let a=ce.mul(l,ds);s=ce.sqr(l),s=ce.mul(s,c);let b=ce.eql(s,o),h=ce.cmov(a,l,b),p=ce.mul(r,e),d=ce.mul(l,t);d=ce.mul(d,Ul);let m=ce.mul(d,ds),_=ce.mul(o,e);s=ce.sqr(d),s=ce.mul(s,c);let y=ce.eql(s,_),x=ce.cmov(m,d,y);s=ce.sqr(h),s=ce.mul(s,c);let S=ce.eql(s,o),E=ce.cmov(p,r,S),w=ce.cmov(x,h,S),v=ce.isOdd(w);return w=ce.cmov(w,ce.neg(w),S!==v),{xMn:E,xMd:n,yMn:w,yMd:1n}}const Gl=Oo(ce,ce.neg(BigInt(486664)));function Zl(t){const{xMn:e,xMd:n,yMn:r,yMd:s}=Ml(t);let c=ce.mul(e,s);c=ce.mul(c,Gl);let o=ce.mul(n,r),i=ce.sub(e,n),l=ce.add(e,n),a=ce.mul(o,l),b=ce.eql(a,ce.ZERO);c=ce.cmov(c,ce.ZERO,b),o=ce.cmov(o,ce.ONE,b),i=ce.cmov(i,ce.ONE,b),l=ce.cmov(l,ce.ONE,b);const h=ce.invertBatch([o,l]);return{x:ce.mul(c,h[0]),y:ce.mul(i,h[1])}}Ut(Oe.ExtendedPoint,t=>Zl(t[0]),{DST:"edwards25519_XMD:SHA-512_ELL2_RO_",encodeDST:"edwards25519_XMD:SHA-512_ELL2_NU_",p:ce.ORDER,m:1,k:128,expand:"xmd",hash:fn});function er(t){if(!(t instanceof Je))throw new Error("RistrettoPoint expected")}const xr=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),Kl=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),jl=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),Vl=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),Yl=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),hs=t=>Ur(xt,t),zl=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),tr=t=>Oe.CURVE.Fp.create(vt(t)&zl);function ps(t){const{d:e}=Oe.CURVE,n=Oe.CURVE.Fp.ORDER,r=Oe.CURVE.Fp.create,s=r(xr*t*t),c=r((s+xt)*Vl);let o=BigInt(-1);const i=r((o-e*s)*r(s+e));let{isValid:l,value:a}=Ur(c,i),b=r(a*t);Rt(b,n)||(b=r(-b)),l||(a=b),l||(o=s);const h=r(o*(s-xt)*Yl-i),p=a*a,d=r((a+a)*i),m=r(h*Kl),_=r(xt-p),y=r(xt+p);return new Oe.ExtendedPoint(r(d*y),r(_*m),r(m*y),r(d*_))}class Je{constructor(e){this.ep=e}static fromAffine(e){return new Je(Oe.ExtendedPoint.fromAffine(e))}static hashToCurve(e){e=Ee("ristrettoHash",e,64);const n=tr(e.slice(0,32)),r=ps(n),s=tr(e.slice(32,64)),c=ps(s);return new Je(r.add(c))}static fromHex(e){e=Ee("ristrettoHex",e,32);const{a:n,d:r}=Oe.CURVE,s=Oe.CURVE.Fp.ORDER,c=Oe.CURVE.Fp.create,o="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",i=tr(e);if(!ic(Xt(i,32),e)||Rt(i,s))throw new Error(o);const l=c(i*i),a=c(xt+n*l),b=c(xt-n*l),h=c(a*a),p=c(b*b),d=c(n*r*h-p),{isValid:m,value:_}=hs(c(d*p)),y=c(_*b),x=c(_*y*d);let S=c((i+i)*y);Rt(S,s)&&(S=c(-S));const E=c(a*x),w=c(S*E);if(!m||Rt(w,s)||E===Hl)throw new Error(o);return new Je(new Oe.ExtendedPoint(S,E,xt,w))}toRawBytes(){let{ex:e,ey:n,ez:r,et:s}=this.ep;const c=Oe.CURVE.Fp.ORDER,o=Oe.CURVE.Fp.create,i=o(o(r+n)*o(r-n)),l=o(e*n),a=o(l*l),{value:b}=hs(o(i*a)),h=o(b*i),p=o(b*l),d=o(h*p*s);let m;if(Rt(s*d,c)){let y=o(n*xr),x=o(e*xr);e=y,n=x,m=o(h*jl)}else m=p;Rt(e*d,c)&&(n=o(-n));let _=o((r-n)*m);return Rt(_,c)&&(_=o(-_)),Xt(_,32)}toHex(){return qt(this.toRawBytes())}toString(){return this.toHex()}equals(e){er(e);const{ex:n,ey:r}=this.ep,{ex:s,ey:c}=e.ep,o=Oe.CURVE.Fp.create,i=o(n*c)===o(r*s),l=o(r*c)===o(n*s);return i||l}add(e){return er(e),new Je(this.ep.add(e.ep))}subtract(e){return er(e),new Je(this.ep.subtract(e.ep))}multiply(e){return new Je(this.ep.multiply(e))}multiplyUnsafe(e){return new Je(this.ep.multiplyUnsafe(e))}}Je.BASE=new Je(Oe.ExtendedPoint.BASE);Je.ZERO=new Je(Oe.ExtendedPoint.ZERO);function Fl(t){let e;return{c(){e=u("p"),e.textContent=`${Fe.NO_MESSAGE}`},m(n,r){F(n,e,r)},p:_e,d(n){n&&Y(e)}}}function Wl(t){let e,n,r,s,c,o,i,l,a,b,h,p,d;return{c(){e=u("table"),n=u("tbody"),r=u("tr"),s=u("td"),s.textContent="msg",c=u("td"),o=u("code"),i=X(t[4]),l=P(),a=u("tr"),b=u("td"),b.textContent="sigHex",h=u("td"),p=u("code"),d=X(t[5]),g(s,"class","curve-data__key"),g(b,"class","curve-data__key"),g(e,"class","curve-data__table")},m(m,_){F(m,e,_),f(e,n),f(n,r),f(r,s),f(r,c),f(c,o),f(o,i),f(n,l),f(n,a),f(a,b),f(a,h),f(h,p),f(p,d)},p(m,_){_&16&&ee(i,m[4]),_&32&&ee(d,m[5])},d(m){m&&Y(e)}}}function Xl(t){let e,n,r,s,c,o,i,l,a,b,h,p,d,m,_,y,x,S,E,w,v,A,Z,T,H,j,O,N;j=new Bt({});function D(I,k){return I[0]?Wl:Fl}let G=D(t),R=G(t);return{c(){e=u("div"),n=u("h3"),n.textContent="Public key",r=P(),s=u("table"),c=u("tbody"),o=u("tr"),i=u("td"),i.textContent="x",l=u("td"),a=u("code"),b=X(t[1]),h=P(),p=u("tr"),d=u("td"),d.textContent="y",m=u("td"),_=u("code"),y=X(t[2]),x=P(),S=u("tr"),E=u("td"),E.textContent="hex",w=u("td"),v=u("code"),A=X(t[3]),Z=P(),T=u("h3"),T.textContent="Signature",H=P(),be(j.$$.fragment),O=P(),R.c(),g(n,"class","curve-data__header"),g(i,"class","curve-data__key"),g(d,"class","curve-data__key"),g(E,"class","curve-data__key"),g(s,"class","curve-data__table"),g(T,"class","curve-data__header"),g(e,"class","curve-data")},m(I,k){F(I,e,k),f(e,n),f(e,r),f(e,s),f(s,c),f(c,o),f(o,i),f(o,l),f(l,a),f(a,b),f(c,h),f(c,p),f(p,d),f(p,m),f(m,_),f(_,y),f(c,x),f(c,S),f(S,E),f(S,w),f(w,v),f(v,A),f(e,Z),f(e,T),f(e,H),ue(j,e,null),f(e,O),R.m(e,null),N=!0},p(I,[k]){(!N||k&2)&&ee(b,I[1]),(!N||k&4)&&ee(y,I[2]),(!N||k&8)&&ee(A,I[3]),G===(G=D(I))&&R?R.p(I,k):(R.d(1),R=G(I),R&&(R.c(),R.m(e,null)))},i(I){N||(J(j.$$.fragment,I),N=!0)},o(I){se(j.$$.fragment,I),N=!1},d(I){I&&Y(e),de(j),R.d()}}}function $l(t,e,n){let r,s,c;Se(t,nt,p=>n(7,s=p)),Se(t,Ke,p=>n(8,c=p));let{privKey:o}=e,i,l,a,b,h;return Le(Ke,c=Oe.CURVE.n,c),t.$$set=p=>{"privKey"in p&&n(6,o=p.privKey)},t.$$.update=()=>{if(t.$$.dirty&128&&n(0,r=s.length>0),t.$$.dirty&193){const p=Oe.getPublicKey(o),d=Oe.ExtendedPoint.fromHex(p);if(n(1,[i,l]=[d.x,d.y].map(m=>De(m)),i,(n(2,l),n(6,o),n(0,r),n(7,s))),n(3,a=d.toHex()),r){const m=sn(s),_=Oe.sign(m,o);n(4,b=je(m)),n(5,h=je(_))}}},[r,i,l,a,b,h,o,s]}class Ql extends Ge{constructor(e){super(),Me(this,e,$l,Xl,qe,{privKey:6})}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Jl=wt(()=>Lr.create({dkLen:114})),ei=wt(()=>Lr.create({dkLen:64})),xn=BigInt("726838724295606890549323807888004534353641360687318060281490199180612328166730772686396383698676545930088884461843637361053498018365439");function Dc(t){const e=xn,n=BigInt(1),r=BigInt(2),s=BigInt(3),c=BigInt(11),o=BigInt(22),i=BigInt(44),l=BigInt(88),a=BigInt(223),b=t*t*t%e,h=b*b*t%e,p=we(h,s,e)*h%e,d=we(p,s,e)*h%e,m=we(d,r,e)*b%e,_=we(m,c,e)*m%e,y=we(_,o,e)*_%e,x=we(y,i,e)*y%e,S=we(x,l,e)*x%e,E=we(S,i,e)*y%e,w=we(E,r,e)*b%e,v=we(w,n,e)*t%e;return we(v,a,e)*w%e}function Mc(t){return t[0]&=252,t[55]|=128,t[56]=0,t}const te=Et(xn,456,!0),Gc={a:BigInt(1),d:BigInt("726838724295606890549323807888004534353641360687318060281490199180612328166730772686396383698676545930088884461843637361053498018326358"),Fp:te,n:BigInt("181709681073901722637330951972001133588410340171829515070372549795146003961539585716195755291692375963310293709091662304773755859649779"),nBitLength:456,h:BigInt(4),Gx:BigInt("224580040295924300187604334099896036246789641632564134246125461686950415467406032909029192869357953282578032075146446173674602635247710"),Gy:BigInt("298819210078481492676017930443930673437544040154080242095928241372331506189835876003536878655418784733982303233503462500531545062832660"),hash:Jl,randomBytes:Mt,adjustScalarBytes:Mc,domain:(t,e,n)=>{if(e.length>255)throw new Error(`Context is too big: ${e.length}`);return Er(sn("SigEd448"),new Uint8Array([n?1:0,e.length]),e,t)},uvRatio:(t,e)=>{const n=xn,r=ye(t*t*e,n),s=ye(r*t,n),c=ye(s*r*e,n),o=Dc(c),i=ye(s*o,n),l=ye(i*i,n);return{isValid:ye(l*e,n)===t,value:i}}},Wt=Sn(Gc);Sn({...Gc,preHash:ei});Nc({a:BigInt(156326),montgomeryBits:448,nByteLength:57,P:xn,Gu:BigInt(5),powPminus2:t=>{const e=xn,n=Dc(t),r=we(n,BigInt(2),e);return ye(r*t,e)},adjustScalarBytes:Mc,randomBytes:Mt});const ti=(te.ORDER-BigInt(3))/BigInt(4),ms=BigInt(156326);function ni(t){let e=te.sqr(t),n=te.eql(e,te.ONE);e=te.cmov(e,te.ZERO,n);let r=te.sub(te.ONE,e),s=te.neg(ms),c=te.sqr(r),o=te.mul(c,r),i=te.mul(e,te.neg(ms));i=te.mul(i,s),i=te.add(i,c),i=te.mul(i,s);let l=te.sqr(o);c=te.mul(i,o),l=te.mul(l,c);let a=te.pow(l,ti);a=te.mul(a,c);let b=te.mul(s,te.neg(e)),h=te.mul(a,t);h=te.cmov(h,te.ZERO,n),c=te.sqr(a),c=te.mul(c,o);let p=te.eql(c,i),d=te.cmov(b,s,p),m=te.cmov(h,a,p),_=te.isOdd(m);return m=te.cmov(m,te.neg(m),p!==_),{xn:d,xd:r,yn:m,yd:te.ONE}}function ri(t){let{xn:e,xd:n,yn:r,yd:s}=ni(t),c=te.sqr(e),o=te.sqr(n),i=te.sqr(o),l=te.sqr(r),a=te.sqr(s),b=te.sub(c,o),h=te.sub(b,o);b=te.mul(b,o),b=te.mul(b,s),b=te.mul(b,r),b=te.mul(b,4n),h=te.mul(h,c),h=te.mul(h,a);let p=te.mul(l,4n),d=te.add(p,a);d=te.mul(d,i);let m=te.add(d,h);h=te.mul(h,e);let _=te.mul(e,i),y=te.sub(p,a);y=te.mul(y,_),y=te.sub(y,h),d=te.add(c,o),d=te.mul(d,o),d=te.mul(d,n),d=te.mul(d,l),d=te.mul(d,BigInt(-2));let x=te.add(h,d);_=te.mul(_,a),x=te.add(x,_),d=te.mul(m,x);let S=te.eql(d,te.ZERO);b=te.cmov(b,te.ZERO,S),m=te.cmov(m,te.ONE,S),y=te.cmov(y,te.ONE,S),x=te.cmov(x,te.ONE,S);const E=te.invertBatch([m,x]);return{x:te.mul(b,E[0]),y:te.mul(y,E[1])}}Ut(Wt.ExtendedPoint,t=>ri(t[0]),{DST:"edwards448_XOF:SHAKE256_ELL2_RO_",encodeDST:"edwards448_XOF:SHAKE256_ELL2_NU_",p:te.ORDER,m:1,k:224,expand:"xof",hash:Lr});function si(t){let e;return{c(){e=u("p"),e.textContent=`${Fe.NO_MESSAGE}`},m(n,r){F(n,e,r)},p:_e,d(n){n&&Y(e)}}}function ci(t){let e,n,r,s,c,o,i,l,a,b,h,p,d;return{c(){e=u("table"),n=u("tbody"),r=u("tr"),s=u("td"),s.textContent="msg",c=u("td"),o=u("code"),i=X(t[4]),l=P(),a=u("tr"),b=u("td"),b.textContent="sigHex",h=u("td"),p=u("code"),d=X(t[5]),g(s,"class","curve-data__key"),g(b,"class","curve-data__key"),g(e,"class","curve-data__table")},m(m,_){F(m,e,_),f(e,n),f(n,r),f(r,s),f(r,c),f(c,o),f(o,i),f(n,l),f(n,a),f(a,b),f(a,h),f(h,p),f(p,d)},p(m,_){_&16&&ee(i,m[4]),_&32&&ee(d,m[5])},d(m){m&&Y(e)}}}function oi(t){let e,n,r,s,c,o,i,l,a,b,h,p,d,m,_,y,x,S,E,w,v,A,Z,T,H,j,O,N;j=new Bt({});function D(I,k){return I[0]?ci:si}let G=D(t),R=G(t);return{c(){e=u("div"),n=u("h3"),n.textContent="Public key",r=P(),s=u("table"),c=u("tbody"),o=u("tr"),i=u("td"),i.textContent="x",l=u("td"),a=u("code"),b=X(t[1]),h=P(),p=u("tr"),d=u("td"),d.textContent="y",m=u("td"),_=u("code"),y=X(t[2]),x=P(),S=u("tr"),E=u("td"),E.textContent="hex",w=u("td"),v=u("code"),A=X(t[3]),Z=P(),T=u("h3"),T.textContent="Signature",H=P(),be(j.$$.fragment),O=P(),R.c(),g(n,"class","curve-data__header"),g(i,"class","curve-data__key"),g(d,"class","curve-data__key"),g(E,"class","curve-data__key"),g(s,"class","curve-data__table"),g(T,"class","curve-data__header"),g(e,"class","curve-data")},m(I,k){F(I,e,k),f(e,n),f(e,r),f(e,s),f(s,c),f(c,o),f(o,i),f(o,l),f(l,a),f(a,b),f(c,h),f(c,p),f(p,d),f(p,m),f(m,_),f(_,y),f(c,x),f(c,S),f(S,E),f(S,w),f(w,v),f(v,A),f(e,Z),f(e,T),f(e,H),ue(j,e,null),f(e,O),R.m(e,null),N=!0},p(I,[k]){(!N||k&2)&&ee(b,I[1]),(!N||k&4)&&ee(y,I[2]),(!N||k&8)&&ee(A,I[3]),G===(G=D(I))&&R?R.p(I,k):(R.d(1),R=G(I),R&&(R.c(),R.m(e,null)))},i(I){N||(J(j.$$.fragment,I),N=!0)},o(I){se(j.$$.fragment,I),N=!1},d(I){I&&Y(e),de(j),R.d()}}}function fi(t,e,n){let r,s,c;Se(t,nt,p=>n(7,s=p)),Se(t,Ke,p=>n(8,c=p));let{privKey:o}=e,i,l,a,b,h;return Le(Ke,c=Wt.CURVE.n,c),t.$$set=p=>{"privKey"in p&&n(6,o=p.privKey)},t.$$.update=()=>{if(t.$$.dirty&128&&n(0,r=s.length>0),t.$$.dirty&193){const p=Wt.getPublicKey(o),d=Wt.ExtendedPoint.fromHex(p);if(n(1,[i,l]=[d.x,d.y].map(m=>De(m)),i,(n(2,l),n(6,o),n(0,r),n(7,s))),n(3,a=d.toHex()),r){const m=sn(s),_=Wt.sign(m,o);n(4,b=je(m)),n(5,h=je(_))}}},[r,i,l,a,b,h,o,s]}class li extends Ge{constructor(e){super(),Me(this,e,fi,oi,qe,{privKey:6})}}function ii(t){const{Fp:e,Fr:n,Fp2:r,Fp6:s,Fp12:c}=t,o=nn(t.x),i=32;function l(O){const{x:N,y:D}=O,G=N,R=D,I=r.ONE;let k=G,C=R,L=I,U=[];for(let W=o-2;W>=0;W--){let $=r.sqr(C),V=r.sqr(L),q=r.multiplyByB(r.mul(V,3n)),z=r.mul(q,3n),ne=r.sub(r.sub(r.sqr(r.add(C,L)),V),$);if(U.push([r.sub(q,$),r.mul(r.sqr(k),3n),r.neg(ne)]),k=r.div(r.mul(r.mul(r.sub($,z),k),C),2n),C=r.sub(r.sqr(r.div(r.add($,z),2n)),r.mul(r.sqr(q),3n)),L=r.mul($,ne),Nt(t.x,W)){let oe=r.sub(C,r.mul(R,L)),ie=r.sub(k,r.mul(G,L));U.push([r.sub(r.mul(oe,G),r.mul(ie,R)),r.neg(oe),ie]);let me=r.sqr(ie),he=r.mul(me,ie),xe=r.mul(me,k),ge=r.add(r.sub(he,r.mul(xe,2n)),r.mul(r.sqr(oe),L));k=r.mul(ie,ge),C=r.sub(r.mul(r.sub(xe,ge),oe),r.mul(he,C)),L=r.mul(L,he)}}return U}function a(O,N){const{x:D}=t,G=N[0],R=N[1];let I=c.ONE;for(let k=0,C=o-2;C>=0;C--,k++){const L=O[k];if(I=c.multiplyBy014(I,L[0],r.mul(L[1],G),r.mul(L[2],R)),Nt(D,C)){k+=1;const U=O[k];I=c.multiplyBy014(I,U[0],r.mul(U[1],G),r.mul(U[2],R))}C!==0&&(I=c.sqr(I))}return c.conjugate(I)}const b={randomPrivateKey:()=>n.toBytes(bc(t.randomBytes(i+8),t.r))},h=ur({n:n.ORDER,...t.G1}),p=Object.assign(h,Ut(h.ProjectivePoint,t.G1.mapToCurve,{...t.htfDefaults,...t.G1.htfDefaults}));function d(O){const N=O;return N._PPRECOMPUTES||(N._PPRECOMPUTES=l(O.toAffine())),N._PPRECOMPUTES}const m=ur({n:n.ORDER,...t.G2}),_=Object.assign(m,Ut(m.ProjectivePoint,t.G2.mapToCurve,{...t.htfDefaults,...t.G2.htfDefaults})),{Signature:y}=t.G2;function x(O,N,D=!0){if(O.equals(p.ProjectivePoint.ZERO)||N.equals(_.ProjectivePoint.ZERO))throw new Error("pairing is not available for ZERO point");O.assertValidity(),N.assertValidity();const G=O.toAffine(),R=a(d(N),[G.x,G.y]);return D?c.finalExponentiate(R):R}function S(O){return O instanceof p.ProjectivePoint?O:p.ProjectivePoint.fromHex(O)}function E(O){return O instanceof _.ProjectivePoint?O:y.decode(O)}function w(O,N){return O instanceof _.ProjectivePoint?O:_.hashToCurve(Ee("point",O),N)}function v(O){return p.ProjectivePoint.fromPrivateKey(O).toRawBytes(!0)}function A(O,N,D){const G=w(O,D);G.assertValidity();const R=G.multiply(p.normPrivateKeyToScalar(N));return O instanceof _.ProjectivePoint?R:y.encode(R)}function Z(O,N,D,G){const R=S(D),I=w(N,G),k=p.ProjectivePoint.BASE,C=E(O),L=x(R.negate(),I,!1),U=x(k,C,!1),W=c.finalExponentiate(c.mul(U,L));return c.eql(W,c.ONE)}function T(O){if(!O.length)throw new Error("Expected non-empty array");const D=O.map(S).reduce((G,R)=>G.add(R),p.ProjectivePoint.ZERO);return O[0]instanceof p.ProjectivePoint?(D.assertValidity(),D):D.toRawBytes(!0)}function H(O){if(!O.length)throw new Error("Expected non-empty array");const D=O.map(E).reduce((G,R)=>G.add(R),_.ProjectivePoint.ZERO);return O[0]instanceof _.ProjectivePoint?(D.assertValidity(),D):y.encode(D)}function j(O,N,D,G){if(!N.length)throw new Error("Expected non-empty messages array");if(D.length!==N.length)throw new Error("Pubkey count should equal msg count");const R=E(O),I=N.map(C=>w(C,G)),k=D.map(S);try{const C=[];for(const W of new Set(I)){const $=I.reduce((V,q,z)=>q===W?V.add(k[z]):V,p.ProjectivePoint.ZERO);C.push(x($,W,!1))}C.push(x(p.ProjectivePoint.BASE.negate(),R,!1));const L=C.reduce((W,$)=>c.mul(W,$),c.ONE),U=c.finalExponentiate(L);return c.eql(U,c.ONE)}catch{return!1}}return p.ProjectivePoint.BASE._setWindowSize(4),{CURVE:t,Fr:n,Fp:e,Fp2:r,Fp6:s,Fp12:c,G1:p,G2:_,Signature:y,millerLoop:a,calcPairingPrecomputes:l,pairing:x,getPublicKey:v,sign:A,verify:Z,aggregatePublicKeys:T,aggregateSignatures:H,verifyBatch:j,utils:b}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const K=Et(0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaabn),_s=Et(0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001n),gs=({c0:t,c1:e},{c0:n,c1:r})=>({c0:K.add(t,n),c1:K.add(e,r)}),ys=({c0:t,c1:e},{c0:n,c1:r})=>({c0:K.sub(t,n),c1:K.sub(e,r)}),xs=({c0:t,c1:e},n)=>{if(typeof n=="bigint")return{c0:K.mul(t,n),c1:K.mul(e,n)};const{c0:r,c1:s}=n;let c=K.mul(t,r),o=K.mul(e,s);const i=K.sub(c,o),l=K.sub(K.mul(K.add(t,e),K.add(r,s)),K.add(c,o));return{c0:i,c1:l}},vs=({c0:t,c1:e})=>{const n=K.add(t,e),r=K.sub(t,e),s=K.add(t,t);return{c0:K.mul(n,r),c1:K.mul(s,e)}},On=0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaabn**2n,B={ORDER:On,BITS:nn(On),BYTES:Math.ceil(nn(On)/8),MASK:cn(nn(On)),ZERO:{c0:K.ZERO,c1:K.ZERO},ONE:{c0:K.ONE,c1:K.ZERO},create:t=>t,isValid:({c0:t,c1:e})=>typeof t=="bigint"&&typeof e=="bigint",is0:({c0:t,c1:e})=>K.is0(t)&&K.is0(e),eql:({c0:t,c1:e},{c0:n,c1:r})=>K.eql(t,n)&&K.eql(e,r),neg:({c0:t,c1:e})=>({c0:K.neg(t),c1:K.neg(e)}),pow:(t,e)=>Kn(B,t,e),invertBatch:t=>jn(B,t),add:gs,sub:ys,mul:xs,sqr:vs,addN:gs,subN:ys,mulN:xs,sqrN:vs,div:(t,e)=>B.mul(t,typeof e=="bigint"?K.inv(K.create(e)):B.inv(e)),inv:({c0:t,c1:e})=>{const n=K.inv(K.create(t*t+e*e));return{c0:K.mul(n,K.create(t)),c1:K.mul(n,K.create(-e))}},sqrt:t=>{if(B.eql(t,B.ZERO))return B.ZERO;const e=B.pow(t,(B.ORDER+8n)/16n),n=B.div(B.sqr(e),t),r=ui,s=[r[0],r[2],r[4],r[6]].find(d=>B.eql(d,n));if(!s)throw new Error("No root");const c=r.indexOf(s),o=r[c/2];if(!o)throw new Error("Invalid root");const i=B.div(e,o),l=B.neg(i),{re:a,im:b}=B.reim(i),{re:h,im:p}=B.reim(l);return b>p||b===p&&a>h?i:l},isOdd:t=>{const{re:e,im:n}=B.reim(t),r=e%2n,s=e===0n,c=n%2n;return BigInt(r||s&&c)==1n},fromBytes(t){if(t.length!==B.BYTES)throw new Error(`fromBytes wrong length=${t.length}`);return{c0:K.fromBytes(t.subarray(0,K.BYTES)),c1:K.fromBytes(t.subarray(K.BYTES))}},toBytes:({c0:t,c1:e})=>Ie(K.toBytes(t),K.toBytes(e)),cmov:({c0:t,c1:e},{c0:n,c1:r},s)=>({c0:K.cmov(t,n,s),c1:K.cmov(e,r,s)}),reim:({c0:t,c1:e})=>({re:t,im:e}),mulByNonresidue:({c0:t,c1:e})=>({c0:K.sub(t,e),c1:K.add(t,e)}),multiplyByB:({c0:t,c1:e})=>{let n=K.mul(t,4n),r=K.mul(e,4n);return{c0:K.sub(n,r),c1:K.add(n,r)}},fromBigTuple:t=>{if(t.length!==2)throw new Error("Invalid tuple");const e=t.map(n=>K.create(n));return{c0:e[0],c1:e[1]}},frobeniusMap:({c0:t,c1:e},n)=>({c0:t,c1:K.mul(e,ai[n%2])})},ai=[0x1n,0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaaan].map(t=>K.create(t)),Ot=0x6af0e0437ff400b6831e36d6bd17ffe48395dabc2d3435e77f76e17009241c5ee67992f72ec05f4c81084fbede3cc09n,ui=[[1n,0n],[Ot,-Ot],[0n,1n],[Ot,Ot],[-1n,0n],[-Ot,Ot],[0n,-1n],[-Ot,-Ot]].map(t=>B.fromBigTuple(t)),ws=({c0:t,c1:e,c2:n},{c0:r,c1:s,c2:c})=>({c0:B.add(t,r),c1:B.add(e,s),c2:B.add(n,c)}),Es=({c0:t,c1:e,c2:n},{c0:r,c1:s,c2:c})=>({c0:B.sub(t,r),c1:B.sub(e,s),c2:B.sub(n,c)}),Bs=({c0:t,c1:e,c2:n},r)=>{if(typeof r=="bigint")return{c0:B.mul(t,r),c1:B.mul(e,r),c2:B.mul(n,r)};const{c0:s,c1:c,c2:o}=r,i=B.mul(t,s),l=B.mul(e,c),a=B.mul(n,o);return{c0:B.add(i,B.mulByNonresidue(B.sub(B.mul(B.add(e,n),B.add(c,o)),B.add(l,a)))),c1:B.add(B.sub(B.mul(B.add(t,e),B.add(s,c)),B.add(i,l)),B.mulByNonresidue(a)),c2:B.sub(B.add(l,B.mul(B.add(t,n),B.add(s,o))),B.add(i,a))}},ks=({c0:t,c1:e,c2:n})=>{let r=B.sqr(t),s=B.mul(B.mul(t,e),2n),c=B.mul(B.mul(e,n),2n),o=B.sqr(n);return{c0:B.add(B.mulByNonresidue(c),r),c1:B.add(B.mulByNonresidue(o),s),c2:B.sub(B.sub(B.add(B.add(s,B.sqr(B.add(B.sub(t,e),n))),c),r),o)}},re={ORDER:B.ORDER,BITS:3*B.BITS,BYTES:3*B.BYTES,MASK:cn(3*B.BITS),ZERO:{c0:B.ZERO,c1:B.ZERO,c2:B.ZERO},ONE:{c0:B.ONE,c1:B.ZERO,c2:B.ZERO},create:t=>t,isValid:({c0:t,c1:e,c2:n})=>B.isValid(t)&&B.isValid(e)&&B.isValid(n),is0:({c0:t,c1:e,c2:n})=>B.is0(t)&&B.is0(e)&&B.is0(n),neg:({c0:t,c1:e,c2:n})=>({c0:B.neg(t),c1:B.neg(e),c2:B.neg(n)}),eql:({c0:t,c1:e,c2:n},{c0:r,c1:s,c2:c})=>B.eql(t,r)&&B.eql(e,s)&&B.eql(n,c),sqrt:()=>{throw new Error("Not implemented")},div:(t,e)=>re.mul(t,typeof e=="bigint"?K.inv(K.create(e)):re.inv(e)),pow:(t,e)=>Kn(re,t,e),invertBatch:t=>jn(re,t),add:ws,sub:Es,mul:Bs,sqr:ks,addN:ws,subN:Es,mulN:Bs,sqrN:ks,inv:({c0:t,c1:e,c2:n})=>{let r=B.sub(B.sqr(t),B.mulByNonresidue(B.mul(n,e))),s=B.sub(B.mulByNonresidue(B.sqr(n)),B.mul(t,e)),c=B.sub(B.sqr(e),B.mul(t,n)),o=B.inv(B.add(B.mulByNonresidue(B.add(B.mul(n,s),B.mul(e,c))),B.mul(t,r)));return{c0:B.mul(o,r),c1:B.mul(o,s),c2:B.mul(o,c)}},fromBytes:t=>{if(t.length!==re.BYTES)throw new Error(`fromBytes wrong length=${t.length}`);return{c0:B.fromBytes(t.subarray(0,B.BYTES)),c1:B.fromBytes(t.subarray(B.BYTES,2*B.BYTES)),c2:B.fromBytes(t.subarray(2*B.BYTES))}},toBytes:({c0:t,c1:e,c2:n})=>Ie(B.toBytes(t),B.toBytes(e),B.toBytes(n)),cmov:({c0:t,c1:e,c2:n},{c0:r,c1:s,c2:c},o)=>({c0:B.cmov(t,r,o),c1:B.cmov(e,s,o),c2:B.cmov(n,c,o)}),fromBigSix:t=>{if(!Array.isArray(t)||t.length!==6)throw new Error("Invalid Fp6 usage");return{c0:B.fromBigTuple(t.slice(0,2)),c1:B.fromBigTuple(t.slice(2,4)),c2:B.fromBigTuple(t.slice(4,6))}},frobeniusMap:({c0:t,c1:e,c2:n},r)=>({c0:B.frobeniusMap(t,r),c1:B.mul(B.frobeniusMap(e,r),di[r%6]),c2:B.mul(B.frobeniusMap(n,r),bi[r%6])}),mulByNonresidue:({c0:t,c1:e,c2:n})=>({c0:B.mulByNonresidue(n),c1:t,c2:e}),multiplyBy1:({c0:t,c1:e,c2:n},r)=>({c0:B.mulByNonresidue(B.mul(n,r)),c1:B.mul(t,r),c2:B.mul(e,r)}),multiplyBy01({c0:t,c1:e,c2:n},r,s){let c=B.mul(t,r),o=B.mul(e,s);return{c0:B.add(B.mulByNonresidue(B.sub(B.mul(B.add(e,n),s),o)),c),c1:B.sub(B.sub(B.mul(B.add(r,s),B.add(t,e)),c),o),c2:B.add(B.sub(B.mul(B.add(t,n),r),c),o)}},multiplyByFp2:({c0:t,c1:e,c2:n},r)=>({c0:B.mul(t,r),c1:B.mul(e,r),c2:B.mul(n,r)})},di=[[0x1n,0x0n],[0x0n,0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaacn],[0x00000000000000005f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffen,0x0n],[0x0n,0x1n],[0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaacn,0x0n],[0x0n,0x00000000000000005f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffen]].map(t=>B.fromBigTuple(t)),bi=[[0x1n,0x0n],[0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaadn,0x0n],[0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaacn,0x0n],[0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaaan,0x0n],[0x00000000000000005f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffen,0x0n],[0x00000000000000005f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffeffffn,0x0n]].map(t=>B.fromBigTuple(t)),Mr=0xd201000000010000n,hi=nn(Mr),Ss=({c0:t,c1:e},{c0:n,c1:r})=>({c0:re.add(t,n),c1:re.add(e,r)}),Is=({c0:t,c1:e},{c0:n,c1:r})=>({c0:re.sub(t,n),c1:re.sub(e,r)}),Cs=({c0:t,c1:e},n)=>{if(typeof n=="bigint")return{c0:re.mul(t,n),c1:re.mul(e,n)};let{c0:r,c1:s}=n,c=re.mul(t,r),o=re.mul(e,s);return{c0:re.add(c,re.mulByNonresidue(o)),c1:re.sub(re.mul(re.add(t,e),re.add(r,s)),re.add(c,o))}},As=({c0:t,c1:e})=>{let n=re.mul(t,e);return{c0:re.sub(re.sub(re.mul(re.add(re.mulByNonresidue(e),t),re.add(t,e)),n),re.mulByNonresidue(n)),c1:re.add(n,n)}};function nr(t,e){const n=B.sqr(t),r=B.sqr(e);return{first:B.add(B.mulByNonresidue(r),n),second:B.sub(B.sub(B.sqr(B.add(t,e)),n),r)}}const ae={ORDER:B.ORDER,BITS:2*B.BITS,BYTES:2*B.BYTES,MASK:cn(2*B.BITS),ZERO:{c0:re.ZERO,c1:re.ZERO},ONE:{c0:re.ONE,c1:re.ZERO},create:t=>t,isValid:({c0:t,c1:e})=>re.isValid(t)&&re.isValid(e),is0:({c0:t,c1:e})=>re.is0(t)&&re.is0(e),neg:({c0:t,c1:e})=>({c0:re.neg(t),c1:re.neg(e)}),eql:({c0:t,c1:e},{c0:n,c1:r})=>re.eql(t,n)&&re.eql(e,r),sqrt:()=>{throw new Error("Not implemented")},inv:({c0:t,c1:e})=>{let n=re.inv(re.sub(re.sqr(t),re.mulByNonresidue(re.sqr(e))));return{c0:re.mul(t,n),c1:re.neg(re.mul(e,n))}},div:(t,e)=>ae.mul(t,typeof e=="bigint"?K.inv(K.create(e)):ae.inv(e)),pow:(t,e)=>Kn(ae,t,e),invertBatch:t=>jn(ae,t),add:Ss,sub:Is,mul:Cs,sqr:As,addN:Ss,subN:Is,mulN:Cs,sqrN:As,fromBytes:t=>{if(t.length!==ae.BYTES)throw new Error(`fromBytes wrong length=${t.length}`);return{c0:re.fromBytes(t.subarray(0,re.BYTES)),c1:re.fromBytes(t.subarray(re.BYTES))}},toBytes:({c0:t,c1:e})=>Ie(re.toBytes(t),re.toBytes(e)),cmov:({c0:t,c1:e},{c0:n,c1:r},s)=>({c0:re.cmov(t,n,s),c1:re.cmov(e,r,s)}),fromBigTwelve:t=>({c0:re.fromBigSix(t.slice(0,6)),c1:re.fromBigSix(t.slice(6,12))}),frobeniusMap(t,e){const n=re.frobeniusMap(t.c0,e),{c0:r,c1:s,c2:c}=re.frobeniusMap(t.c1,e),o=pi[e%12];return{c0:n,c1:re.create({c0:B.mul(r,o),c1:B.mul(s,o),c2:B.mul(c,o)})}},multiplyBy014:({c0:t,c1:e},n,r,s)=>{let c=re.multiplyBy01(t,n,r),o=re.multiplyBy1(e,s);return{c0:re.add(re.mulByNonresidue(o),c),c1:re.sub(re.sub(re.multiplyBy01(re.add(e,t),n,B.add(r,s)),c),o)}},multiplyByFp2:({c0:t,c1:e},n)=>({c0:re.multiplyByFp2(t,n),c1:re.multiplyByFp2(e,n)}),conjugate:({c0:t,c1:e})=>({c0:t,c1:re.neg(e)}),_cyclotomicSquare:({c0:t,c1:e})=>{const{c0:n,c1:r,c2:s}=t,{c0:c,c1:o,c2:i}=e,{first:l,second:a}=nr(n,o),{first:b,second:h}=nr(c,s),{first:p,second:d}=nr(r,i);let m=B.mulByNonresidue(d);return{c0:re.create({c0:B.add(B.mul(B.sub(l,n),2n),l),c1:B.add(B.mul(B.sub(b,r),2n),b),c2:B.add(B.mul(B.sub(p,s),2n),p)}),c1:re.create({c0:B.add(B.mul(B.add(m,c),2n),m),c1:B.add(B.mul(B.add(a,o),2n),a),c2:B.add(B.mul(B.add(h,i),2n),h)})}},_cyclotomicExp(t,e){let n=ae.ONE;for(let r=hi-1;r>=0;r--)n=ae._cyclotomicSquare(n),Nt(e,r)&&(n=ae.mul(n,t));return n},finalExponentiate:t=>{const e=Mr,n=ae.div(ae.frobeniusMap(t,6),t),r=ae.mul(ae.frobeniusMap(n,2),n),s=ae.conjugate(ae._cyclotomicExp(r,e)),c=ae.mul(ae.conjugate(ae._cyclotomicSquare(r)),s),o=ae.conjugate(ae._cyclotomicExp(c,e)),i=ae.conjugate(ae._cyclotomicExp(o,e)),l=ae.mul(ae.conjugate(ae._cyclotomicExp(i,e)),ae._cyclotomicSquare(s)),a=ae.conjugate(ae._cyclotomicExp(l,e)),b=ae.frobeniusMap(ae.mul(s,i),2),h=ae.frobeniusMap(ae.mul(o,r),3),p=ae.frobeniusMap(ae.mul(l,ae.conjugate(r)),1),d=ae.mul(ae.mul(a,ae.conjugate(c)),r);return ae.mul(ae.mul(ae.mul(b,h),p),d)}},pi=[[0x1n,0x0n],[0x1904d3bf02bb0667c231beb4202c0d1f0fd603fd3cbd5f4f7b2443d784bab9c4f67ea53d63e7813d8d0775ed92235fb8n,0x00fc3e2b36c4e03288e9e902231f9fb854a14787b6c7b36fec0c8ec971f63c5f282d5ac14d6c7ec22cf78a126ddc4af3n],[0x00000000000000005f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffeffffn,0x0n],[0x135203e60180a68ee2e9c448d77a2cd91c3dedd930b1cf60ef396489f61eb45e304466cf3e67fa0af1ee7b04121bdea2n,0x06af0e0437ff400b6831e36d6bd17ffe48395dabc2d3435e77f76e17009241c5ee67992f72ec05f4c81084fbede3cc09n],[0x00000000000000005f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffen,0x0n],[0x144e4211384586c16bd3ad4afa99cc9170df3560e77982d0db45f3536814f0bd5871c1908bd478cd1ee605167ff82995n,0x05b2cfd9013a5fd8df47fa6b48b1e045f39816240c0b8fee8beadf4d8e9c0566c63a3e6e257f87329b18fae980078116n],[0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaaan,0x0n],[0x00fc3e2b36c4e03288e9e902231f9fb854a14787b6c7b36fec0c8ec971f63c5f282d5ac14d6c7ec22cf78a126ddc4af3n,0x1904d3bf02bb0667c231beb4202c0d1f0fd603fd3cbd5f4f7b2443d784bab9c4f67ea53d63e7813d8d0775ed92235fb8n],[0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaacn,0x0n],[0x06af0e0437ff400b6831e36d6bd17ffe48395dabc2d3435e77f76e17009241c5ee67992f72ec05f4c81084fbede3cc09n,0x135203e60180a68ee2e9c448d77a2cd91c3dedd930b1cf60ef396489f61eb45e304466cf3e67fa0af1ee7b04121bdea2n],[0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaadn,0x0n],[0x05b2cfd9013a5fd8df47fa6b48b1e045f39816240c0b8fee8beadf4d8e9c0566c63a3e6e257f87329b18fae980078116n,0x144e4211384586c16bd3ad4afa99cc9170df3560e77982d0db45f3536814f0bd5871c1908bd478cd1ee605167ff82995n]].map(t=>B.fromBigTuple(t)),mi=Pr(B,[[["0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6","0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6"],["0x0","0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71a"],["0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71e","0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38d"],["0x171d6541fa38ccfaed6dea691f5fb614cb14b4e7f4e810aa22d6108f142b85757098e38d0f671c7188e2aaaaaaaa5ed1","0x0"]],[["0x0","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa63"],["0xc","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa9f"],["0x1","0x0"]],[["0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706","0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706"],["0x0","0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97be"],["0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71c","0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38f"],["0x124c9ad43b6cf79bfbf7043de3811ad0761b0f37a1e26286b0e977c69aa274524e79097a56dc4bd9e1b371c71c718b10","0x0"]],[["0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fb","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fb"],["0x0","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa9d3"],["0x12","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa99"],["0x1","0x0"]]].map(t=>t.map(e=>B.fromBigTuple(e.map(BigInt))))),_i=Pr(K,[["0x11a05f2b1e833340b809101dd99815856b303e88a2d7005ff2627b56cdb4e2c85610c2d5f2e62d6eaeac1662734649b7","0x17294ed3e943ab2f0588bab22147a81c7c17e75b2f6a8417f565e33c70d1e86b4838f2a6f318c356e834eef1b3cb83bb","0xd54005db97678ec1d1048c5d10a9a1bce032473295983e56878e501ec68e25c958c3e3d2a09729fe0179f9dac9edcb0","0x1778e7166fcc6db74e0609d307e55412d7f5e4656a8dbf25f1b33289f1b330835336e25ce3107193c5b388641d9b6861","0xe99726a3199f4436642b4b3e4118e5499db995a1257fb3f086eeb65982fac18985a286f301e77c451154ce9ac8895d9","0x1630c3250d7313ff01d1201bf7a74ab5db3cb17dd952799b9ed3ab9097e68f90a0870d2dcae73d19cd13c1c66f652983","0xd6ed6553fe44d296a3726c38ae652bfb11586264f0f8ce19008e218f9c86b2a8da25128c1052ecaddd7f225a139ed84","0x17b81e7701abdbe2e8743884d1117e53356de5ab275b4db1a682c62ef0f2753339b7c8f8c8f475af9ccb5618e3f0c88e","0x80d3cf1f9a78fc47b90b33563be990dc43b756ce79f5574a2c596c928c5d1de4fa295f296b74e956d71986a8497e317","0x169b1f8e1bcfa7c42e0c37515d138f22dd2ecb803a0c5c99676314baf4bb1b7fa3190b2edc0327797f241067be390c9e","0x10321da079ce07e272d8ec09d2565b0dfa7dccdde6787f96d50af36003b14866f69b771f8c285decca67df3f1605fb7b","0x6e08c248e260e70bd1e962381edee3d31d79d7e22c837bc23c0bf1bc24c6b68c24b1b80b64d391fa9c8ba2e8ba2d229"],["0x8ca8d548cff19ae18b2e62f4bd3fa6f01d5ef4ba35b48ba9c9588617fc8ac62b558d681be343df8993cf9fa40d21b1c","0x12561a5deb559c4348b4711298e536367041e8ca0cf0800c0126c2588c48bf5713daa8846cb026e9e5c8276ec82b3bff","0xb2962fe57a3225e8137e629bff2991f6f89416f5a718cd1fca64e00b11aceacd6a3d0967c94fedcfcc239ba5cb83e19","0x3425581a58ae2fec83aafef7c40eb545b08243f16b1655154cca8abc28d6fd04976d5243eecf5c4130de8938dc62cd8","0x13a8e162022914a80a6f1d5f43e7a07dffdfc759a12062bb8d6b44e833b306da9bd29ba81f35781d539d395b3532a21e","0xe7355f8e4e667b955390f7f0506c6e9395735e9ce9cad4d0a43bcef24b8982f7400d24bc4228f11c02df9a29f6304a5","0x772caacf16936190f3e0c63e0596721570f5799af53a1894e2e073062aede9cea73b3538f0de06cec2574496ee84a3a","0x14a7ac2a9d64a8b230b3f5b074cf01996e7f63c21bca68a81996e1cdf9822c580fa5b9489d11e2d311f7d99bbdcc5a5e","0xa10ecf6ada54f825e920b3dafc7a3cce07f8d1d7161366b74100da67f39883503826692abba43704776ec3a79a1d641","0x95fc13ab9e92ad4476d6e3eb3a56680f682b4ee96f7d03776df533978f31c1593174e4b4b7865002d6384d168ecdd0a","0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"],["0x90d97c81ba24ee0259d1f094980dcfa11ad138e48a869522b52af6c956543d3cd0c7aee9b3ba3c2be9845719707bb33","0x134996a104ee5811d51036d776fb46831223e96c254f383d0f906343eb67ad34d6c56711962fa8bfe097e75a2e41c696","0xcc786baa966e66f4a384c86a3b49942552e2d658a31ce2c344be4b91400da7d26d521628b00523b8dfe240c72de1f6","0x1f86376e8981c217898751ad8746757d42aa7b90eeb791c09e4a3ec03251cf9de405aba9ec61deca6355c77b0e5f4cb","0x8cc03fdefe0ff135caf4fe2a21529c4195536fbe3ce50b879833fd221351adc2ee7f8dc099040a841b6daecf2e8fedb","0x16603fca40634b6a2211e11db8f0a6a074a7d0d4afadb7bd76505c3d3ad5544e203f6326c95a807299b23ab13633a5f0","0x4ab0b9bcfac1bbcb2c977d027796b3ce75bb8ca2be184cb5231413c4d634f3747a87ac2460f415ec961f8855fe9d6f2","0x987c8d5333ab86fde9926bd2ca6c674170a05bfe3bdd81ffd038da6c26c842642f64550fedfe935a15e4ca31870fb29","0x9fc4018bd96684be88c9e221e4da1bb8f3abd16679dc26c1e8b6e6a1f20cabe69d65201c78607a360370e577bdba587","0xe1bba7a1186bdb5223abde7ada14a23c42a0ca7915af6fe06985e7ed1e4d43b9b3f7055dd4eba6f2bafaaebca731c30","0x19713e47937cd1be0dfd0b8f1d43fb93cd2fcbcb6caf493fd1183e416389e61031bf3a5cce3fbafce813711ad011c132","0x18b46a908f36f6deb918c143fed2edcc523559b8aaf0c2462e6bfe7f911f643249d9cdf41b44d606ce07c8a4d0074d8e","0xb182cac101b9399d155096004f53f447aa7b12a3426b08ec02710e807b4633f06c851c1919211f20d4c04f00b971ef8","0x245a394ad1eca9b72fc00ae7be315dc757b3b080d4c158013e6632d3c40659cc6cf90ad1c232a6442d9d3f5db980133","0x5c129645e44cf1102a159f748c4a3fc5e673d81d7e86568d9ab0f5d396a7ce46ba1049b6579afb7866b1e715475224b","0x15e6be4e990f03ce4ea50b3b42df2eb5cb181d8f84965a3957add4fa95af01b2b665027efec01c7704b456be69c8b604"],["0x16112c4c3a9c98b252181140fad0eae9601a6de578980be6eec3232b5be72e7a07f3688ef60c206d01479253b03663c1","0x1962d75c2381201e1a0cbd6c43c348b885c84ff731c4d59ca4a10356f453e01f78a4260763529e3532f6102c2e49a03d","0x58df3306640da276faaae7d6e8eb15778c4855551ae7f310c35a5dd279cd2eca6757cd636f96f891e2538b53dbf67f2","0x16b7d288798e5395f20d23bf89edb4d1d115c5dbddbcd30e123da489e726af41727364f2c28297ada8d26d98445f5416","0xbe0e079545f43e4b00cc912f8228ddcc6d19c9f0f69bbb0542eda0fc9dec916a20b15dc0fd2ededda39142311a5001d","0x8d9e5297186db2d9fb266eaac783182b70152c65550d881c5ecd87b6f0f5a6449f38db9dfa9cce202c6477faaf9b7ac","0x166007c08a99db2fc3ba8734ace9824b5eecfdfa8d0cf8ef5dd365bc400a0051d5fa9c01a58b1fb93d1a1399126a775c","0x16a3ef08be3ea7ea03bcddfabba6ff6ee5a4375efa1f4fd7feb34fd206357132b920f5b00801dee460ee415a15812ed9","0x1866c8ed336c61231a1be54fd1d74cc4f9fb0ce4c6af5920abc5750c4bf39b4852cfe2f7bb9248836b233d9d55535d4a","0x167a55cda70a6e1cea820597d94a84903216f763e13d87bb5308592e7ea7d4fbc7385ea3d529b35e346ef48bb8913f55","0x4d2f259eea405bd48f010a01ad2911d9c6dd039bb61a6290e591b36e636a5c871a5c29f4f83060400f8b49cba8f6aa8","0xaccbb67481d033ff5852c1e48c50c477f94ff8aefce42d28c0f9a88cea7913516f968986f7ebbea9684b529e2561092","0xad6b9514c767fe3c3613144b45f1496543346d98adf02267d5ceef9a00d9b8693000763e3b90ac11e99b138573345cc","0x2660400eb2e4f3b628bdd0d53cd76f2bf565b94e72927c1cb748df27942480e420517bd8714cc80d1fadc1326ed06f7","0xe0fa1d816ddc03e6b24255e0d7819c171c40f65e273b853324efcd6356caa205ca2f570f13497804415473a1d634b8f","0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"]].map(t=>t.map(e=>BigInt(e)))),gi=on(B,{A:B.create({c0:K.create(0n),c1:K.create(240n)}),B:B.create({c0:K.create(1012n),c1:K.create(1012n)}),Z:B.create({c0:K.create(-2n),c1:K.create(-1n)})}),yi=on(K,{A:K.create(0x144698a3b8e9433d693a02c96d4982b0ea985383ee66a8d8e8981aefd881ac98936f8da0e0f97f5cf428082d584c1dn),B:K.create(0x12e2908d11688030018b12e8753eee3b2016c1f0f24f4070a0b9c14fcef35ef55a23215a316ceaa5d1cc48e98e172be0n),Z:K.create(11n)}),Zc=re.create({c0:B.ZERO,c1:B.ONE,c2:B.ZERO}),Kc=ae.create({c0:Zc,c1:re.ZERO}),jc=ae.create({c0:re.ZERO,c1:Zc}),[xi,vi]=ae.invertBatch([Kc,jc]);function wi(t,e){const n=ae.mul(ae.frobeniusMap(ae.multiplyByFp2(xi,t),1),Kc).c0.c0,r=ae.mul(ae.frobeniusMap(ae.multiplyByFp2(vi,e),1),jc).c0.c0;return[n,r]}function Ps(t,e){const n=e.toAffine(),r=wi(n.x,n.y);return new t(r[0],r[1],B.ONE)}const Ei=0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaacn;function Bi(t,e){return[B.mul(t,Ei),B.neg(e)]}function ki(t,e){const n=e.toAffine(),r=Bi(n.x,n.y);return new t(r[0],r[1],B.ONE)}const rr=Object.freeze({DST:"BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_",encodeDST:"BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_",p:K.ORDER,m:2,k:128,expand:"xmd",hash:tt}),sr=K.BITS,vr=K.BITS+1,Nn=K.BITS+2,cr=K.toBytes(gt(gt(0n,vr,!0),Nn,!0)),Te=ii({Fr:_s,Fp:K,Fp2:B,Fp6:re,Fp12:ae,r:_s.ORDER,G1:{Fp:K,h:0x396c8c005555e1568c00aaab0000aaabn,Gx:0x17f1d3a73197d7942695638c4fa9ac0fc3688c4f9774b905a14e3a3f171bac586c55e83ff97a1aeffb3af00adb22c6bbn,Gy:0x08b3f481e3aaa0f1a09e30ed741d8ae4fcf5e095d5d00af600db18cb2c04b3edd03cc744a2888ae40caa232946c5e7e1n,a:K.ZERO,b:4n,htfDefaults:{...rr,m:1},wrapPrivateKey:!0,allowInfinityPoint:!0,isTorsionFree:(t,e)=>{const n=0x5f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffen,r=new t(K.mul(e.px,n),e.py,e.pz);return e.multiplyUnsafe(Te.CURVE.x).negate().multiplyUnsafe(Te.CURVE.x).equals(r)},clearCofactor:(t,e)=>e.multiplyUnsafe(Te.CURVE.x).add(e),mapToCurve:t=>{const{x:e,y:n}=yi(K.create(t[0]));return _i(e,n)},fromBytes:t=>{if(t.length===48){const e=K.ORDER,n=Ne(t);if(Nt(n,vr)===1n)return{x:0n,y:0n};const s=K.create(n&K.MASK),c=K.add(K.pow(s,3n),K.create(Te.CURVE.G1.b));let o=K.sqrt(c);if(!o)throw new Error("Invalid compressed G1 point");const i=Nt(n,sr);return o*2n/e!==i&&(o=K.neg(o)),{x:K.create(s),y:K.create(o)}}else if(t.length===96){if(t[0]&1<<6)return Te.G1.ProjectivePoint.ZERO.toAffine();const e=Ne(t.slice(0,K.BYTES)),n=Ne(t.slice(K.BYTES));return{x:K.create(e),y:K.create(n)}}else throw new Error("Invalid point G1, expected 48/96 bytes")},toBytes:(t,e,n)=>{const r=e.equals(t.ZERO),{x:s,y:c}=e.toAffine();if(n){if(r)return cr.slice();const o=K.ORDER;let i;return i=gt(s,sr,Boolean(c*2n/o)),i=gt(i,Nn,!0),He(i,K.BYTES)}else return r?Ie(new Uint8Array([64]),new Uint8Array(2*K.BYTES-1)):Ie(He(s,K.BYTES),He(c,K.BYTES))}},G2:{Fp:B,h:0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5n,Gx:B.fromBigTuple([0x024aa2b2f08f0a91260805272dc51051c6e47ad4fa403b02b4510b647ae3d1770bac0326a805bbefd48056c8c121bdb8n,0x13e02b6052719f607dacd3a088274f65596bd0d09920b61ab5da61bbdc7f5049334cf11213945d57e5ac7d055d042b7en]),Gy:B.fromBigTuple([0x0ce5d527727d6e118cc9cdc6da2e351aadfd9baa8cbdd3a76d429a695160d12c923ac9cc3baca289e193548608b82801n,0x0606c4a02ea734cc32acd2b02bc28b99cb3e287e85a763af267492ab572e99ab3f370d275cec1da1aaa9075ff05f79ben]),a:B.ZERO,b:B.fromBigTuple([4n,4n]),hEff:0xbc69f08f2ee75b3584c6a0ea91b352888e2a8e9145ad7689986ff031508ffe1329c2f178731db956d82bf015d1212b02ec0ec69d7477c1ae954cbc06689f6a359894c0adebbf6b4e8020005aaa95551n,htfDefaults:{...rr},wrapPrivateKey:!0,allowInfinityPoint:!0,mapToCurve:t=>{const{x:e,y:n}=gi(B.fromBigTuple(t));return mi(e,n)},isTorsionFree:(t,e)=>e.multiplyUnsafe(Te.CURVE.x).negate().equals(Ps(t,e)),clearCofactor:(t,e)=>{const{x:n}=Te.CURVE;let r=e.multiplyUnsafe(n).negate(),s=Ps(t,e),c=e.double();return c=ki(t,c),c=c.subtract(s),s=r.add(s),s=s.multiplyUnsafe(n).negate(),c=c.add(s),c=c.subtract(r),c.subtract(e)},fromBytes:t=>{const e=t[0]&224;if(e===32||e===96||e===224)throw new Error("Invalid encoding flag: "+e);const n=e&128,r=e&64,s=e&32,c=K.BYTES,o=(i,l,a)=>Ne(i.slice(l,a));if(t.length===96&&n){const{b:i}=Te.CURVE.G2,l=K.ORDER;if(t[0]=t[0]&31,r){if(t.reduce((_,y)=>_!==0?y+1:y,0)>0)throw new Error("Invalid compressed G2 point");return{x:B.ZERO,y:B.ZERO}}const a=o(t,0,c),b=o(t,c,2*c),h=B.create({c0:K.create(b),c1:K.create(a)}),p=B.add(B.pow(h,3n),i);let d=B.sqrt(p);const m=d.c1===0n?d.c0*2n/l:d.c1*2n/l?1n:0n;return d=s>0&&m>0?d:B.neg(d),{x:h,y:d}}else if(t.length===192&&!n){if(t[0]&1<<6)return{x:B.ZERO,y:B.ZERO};const i=o(t,0,c),l=o(t,c,2*c),a=o(t,2*c,3*c),b=o(t,3*c,4*c);return{x:B.fromBigTuple([l,i]),y:B.fromBigTuple([b,a])}}else throw new Error("Invalid point G2, expected 96/192 bytes")},toBytes:(t,e,n)=>{const r=e.equals(t.ZERO),{x:s,y:c}=e.toAffine();if(n){const o=K.ORDER;if(r)return Ie(cr,He(0n,K.BYTES));const i=Boolean(c.c1===0n?c.c0*2n/o:c.c1*2n/o);let l=gt(s.c1,sr,i);return l=gt(l,Nn,!0),Ie(He(l,K.BYTES),He(s.c0,K.BYTES))}else{if(r)return Ie(new Uint8Array([64]),new Uint8Array(4*K.BYTES-1));const{re:o,im:i}=B.reim(s),{re:l,im:a}=B.reim(c);return Ie(He(i,K.BYTES),He(o,K.BYTES),He(a,K.BYTES),He(l,K.BYTES))}},Signature:{decode(t){t=Ee("signatureHex",t);const e=K.ORDER,n=t.length/2;if(n!==48&&n!==96)throw new Error("Invalid compressed signature length, must be 96 or 192");const r=Ne(t.slice(0,n)),s=Ne(t.slice(n));if(Nt(r,vr)===1n)return Te.G2.ProjectivePoint.ZERO;const o=K.create(r&K.MASK),i=K.create(s),l=B.create({c0:i,c1:o}),a=B.add(B.pow(l,3n),Te.CURVE.G2.b);let b=B.sqrt(a);if(!b)throw new Error("Failed to find a square root");const{re:h,im:p}=B.reim(b),d=Nt(r,381),m=p>0n&&p*2n/e!==d,_=p===0n&&h*2n/e!==d;(m||_)&&(b=B.neg(b));const y=Te.G2.ProjectivePoint.fromAffine({x:l,y:b});return y.assertValidity(),y},encode(t){if(t.assertValidity(),t.equals(Te.G2.ProjectivePoint.ZERO))return Ie(cr,He(0n,K.BYTES));const e=t.toAffine(),{re:n,im:r}=B.reim(e.x),{re:s,im:c}=B.reim(e.y),o=c>0n?c*2n:s*2n,i=Boolean(o/K.ORDER&1n),l=gt(gt(r,381,i),Nn,!0),a=n;return Ie(He(l,K.BYTES),He(a,K.BYTES))}}},x:Mr,htfDefaults:rr,hash:tt,randomBytes:Mt});function Si(t){let e;return{c(){e=u("p"),e.textContent=`${Fe.NO_MESSAGE}`},m(n,r){F(n,e,r)},p:_e,d(n){n&&Y(e)}}}function Ii(t){let e,n,r,s,c,o,i,l,a,b,h,p,d,m,_,y,x,S,E,w,v,A,Z,T,H,j,O,N,D,G,R,I,k,C,L;return{c(){e=u("table"),n=u("tbody"),r=u("tr"),s=u("td"),s.textContent="msgHash",c=u("td"),o=u("code"),i=X(t[4]),l=P(),a=u("tr"),b=u("td"),b.textContent="x",h=u("td"),p=u("code"),d=X(t[5]),m=X(" +"),_=u("br"),y=u("code"),x=X(t[6]),S=X("×i"),E=P(),w=u("tr"),v=u("td"),v.textContent="y",A=u("td"),Z=u("code"),T=X(t[7]),H=X(" +"),j=u("br"),O=u("code"),N=X(t[8]),D=X("×i"),G=P(),R=u("tr"),I=u("td"),I.textContent="sigHex",k=u("td"),C=u("code"),L=X(t[9]),g(s,"class","curve-data__key"),g(b,"class","curve-data__key"),g(v,"class","curve-data__key"),g(I,"class","curve-data__key"),g(e,"class","curve-data__table")},m(U,W){F(U,e,W),f(e,n),f(n,r),f(r,s),f(r,c),f(c,o),f(o,i),f(n,l),f(n,a),f(a,b),f(a,h),f(h,p),f(p,d),f(h,m),f(h,_),f(h,y),f(y,x),f(y,S),f(n,E),f(n,w),f(w,v),f(w,A),f(A,Z),f(Z,T),f(A,H),f(A,j),f(A,O),f(O,N),f(O,D),f(n,G),f(n,R),f(R,I),f(R,k),f(k,C),f(C,L)},p(U,W){W&16&&ee(i,U[4]),W&32&&ee(d,U[5]),W&64&&ee(x,U[6]),W&128&&ee(T,U[7]),W&256&&ee(N,U[8]),W&512&&ee(L,U[9])},d(U){U&&Y(e)}}}function Ci(t){let e,n,r,s,c,o,i,l,a,b,h,p,d,m,_,y,x,S,E,w,v,A,Z,T,H,j,O,N,D,G;N=new Bt({});function R(C,L){return C[0]?Ii:Si}let I=R(t),k=I(t);return{c(){e=u("div"),n=u("h3"),n.textContent="Public key G1",r=P(),s=u("table"),c=u("tbody"),o=u("tr"),i=u("td"),i.textContent="x",l=u("td"),a=u("code"),b=X(t[1]),h=P(),p=u("tr"),d=u("td"),d.textContent="y",m=u("td"),_=u("code"),y=X(t[2]),x=P(),S=u("tr"),E=u("td"),E.textContent="hex",w=u("td"),v=u("code"),A=X(t[3]),Z=P(),T=u("h3"),T.textContent="Signature G2",H=P(),j=u("div"),j.innerHTML="<small>bls consists of two curves: G1 (ordinary) and G2 (complex numbers). Most implementations use G1 for pubkeys and G2 for signatures. So, signatures will coordinates in form of <code>(x₀, x₁×i), (y₀, y₁×i)</code></small>",O=P(),be(N.$$.fragment),D=P(),k.c(),g(n,"class","curve-data__header"),g(i,"class","curve-data__key"),g(d,"class","curve-data__key"),g(E,"class","curve-data__key"),g(s,"class","curve-data__table"),g(T,"class","curve-data__header"),g(e,"class","curve-data")},m(C,L){F(C,e,L),f(e,n),f(e,r),f(e,s),f(s,c),f(c,o),f(o,i),f(o,l),f(l,a),f(a,b),f(c,h),f(c,p),f(p,d),f(p,m),f(m,_),f(_,y),f(c,x),f(c,S),f(S,E),f(S,w),f(w,v),f(v,A),f(e,Z),f(e,T),f(e,H),f(e,j),f(e,O),ue(N,e,null),f(e,D),k.m(e,null),G=!0},p(C,[L]){(!G||L&2)&&ee(b,C[1]),(!G||L&4)&&ee(y,C[2]),(!G||L&8)&&ee(A,C[3]),I===(I=R(C))&&k?k.p(C,L):(k.d(1),k=I(C),k&&(k.c(),k.m(e,null)))},i(C){G||(J(N.$$.fragment,C),G=!0)},o(C){se(N.$$.fragment,C),G=!1},d(C){C&&Y(e),de(N),k.d()}}}function Ai(t,e,n){let r,s,c;Se(t,nt,y=>n(11,s=y)),Se(t,Ke,y=>n(12,c=y));let{privKey:o}=e,i,l,a,b,h,p,d,m,_;return Le(Ke,c=Te.CURVE.r,c),t.$$set=y=>{"privKey"in y&&n(10,o=y.privKey)},t.$$.update=()=>{if(t.$$.dirty&2048&&n(0,r=s.length>0),t.$$.dirty&3073){const y=Te.getPublicKey(o),x=Te.G1.ProjectivePoint.fromHex(y);if(n(1,[i,l]=[x.x,x.y].map(S=>De(S)),i,(n(2,l),n(10,o),n(0,r),n(11,s))),n(3,a=je(y)),r){const S=tt(s),E=Te.sign(S,o),w=Te.G2.ProjectivePoint.fromHex(E);n(5,[h,p,d,m]=[w.x.c0,w.x.c1,w.y.c0,w.y.c1].map(v=>De(v)),h,(n(6,p),n(10,o),n(0,r),n(11,s)),(n(7,d),n(10,o),n(0,r),n(11,s)),(n(8,m),n(10,o),n(0,r),n(11,s))),n(4,b=je(S)),n(9,_=je(E))}}},[r,i,l,a,b,h,p,d,m,_,o,s]}class Pi extends Ge{constructor(e){super(),Me(this,e,Ai,Ci,qe,{privKey:10})}}function Os(t,e,n){const r=t.slice();return r[18]=e[n],r[20]=n,r}function Oi(t){let e;return{c(){e=u("p"),e.textContent=`${wr}`,g(e,"class","error svelte-t5ype6")},m(n,r){F(n,e,r)},p:_e,d(n){n&&Y(e)}}}function Rs(t){let e,n;return e=new kn({props:{hash:t[18],checked:t[20]===0}}),e.$on("change",t[11]),{c(){be(e.$$.fragment)},m(r,s){ue(e,r,s),n=!0},p:_e,i(r){n||(J(e.$$.fragment,r),n=!0)},o(r){se(e.$$.fragment,r),n=!1},d(r){de(e,r)}}}function Ri(t){let e,n,r=t[10],s=[];for(let o=0;o<r.length;o+=1)s[o]=Rs(Os(t,r,o));const c=o=>se(s[o],1,1,()=>{s[o]=null});return{c(){for(let o=0;o<s.length;o+=1)s[o].c();e=ht()},m(o,i){for(let l=0;l<s.length;l+=1)s[l].m(o,i);F(o,e,i),n=!0},p(o,i){if(i&3072){r=o[10];let l;for(l=0;l<r.length;l+=1){const a=Os(o,r,l);s[l]?(s[l].p(a,i),J(s[l],1)):(s[l]=Rs(a),s[l].c(),J(s[l],1),s[l].m(e.parentNode,e))}for(We(),l=r.length;l<s.length;l+=1)c(l);Xe()}},i(o){if(!n){for(let i=0;i<r.length;i+=1)J(s[i]);n=!0}},o(o){s=s.filter(Boolean);for(let i=0;i<s.length;i+=1)se(s[i]);n=!1},d(o){bt(s,o),o&&Y(e)}}}function Hi(t){let e;return{c(){e=u("p"),e.textContent=`${Fe.NO_MESSAGE}`},m(n,r){F(n,e,r)},p:_e,d(n){n&&Y(e)}}}function Ti(t){let e,n,r,s,c,o,i,l,a,b,h,p,d,m,_,y,x,S,E,w,v,A,Z,T,H,j,O,N,D,G,R;return{c(){e=u("table"),n=u("tbody"),r=u("tr"),s=u("td"),s.textContent="msgHash",c=u("td"),o=u("code"),i=X(t[9]),l=P(),a=u("tr"),b=u("td"),b.textContent="r",h=u("td"),p=u("code"),d=X(t[5]),m=P(),_=u("tr"),y=u("td"),y.textContent="s",x=u("td"),S=u("code"),E=X(t[6]),w=P(),v=u("tr"),A=u("td"),A.textContent="compact",Z=u("td"),T=u("code"),H=X(t[7]),j=P(),O=u("tr"),N=u("td"),N.textContent="der",D=u("td"),G=u("code"),R=X(t[8]),g(s,"class","curve-data__key"),g(b,"class","curve-data__key"),g(y,"class","curve-data__key"),g(A,"class","curve-data__key"),g(N,"class","curve-data__key"),g(e,"class","curve-data__table")},m(I,k){F(I,e,k),f(e,n),f(n,r),f(r,s),f(r,c),f(c,o),f(o,i),f(n,l),f(n,a),f(a,b),f(a,h),f(h,p),f(p,d),f(n,m),f(n,_),f(_,y),f(_,x),f(x,S),f(S,E),f(n,w),f(n,v),f(v,A),f(v,Z),f(Z,T),f(T,H),f(n,j),f(n,O),f(O,N),f(O,D),f(D,G),f(G,R)},p(I,k){k&512&&ee(i,I[9]),k&32&&ee(d,I[5]),k&64&&ee(E,I[6]),k&128&&ee(H,I[7]),k&256&&ee(R,I[8])},d(I){I&&Y(e)}}}function Ni(t){let e,n,r,s,c,o,i,l,a,b,h,p,d,m,_,y,x,S,E,w,v,A,Z,T,H,j,O,N,D,G,R,I,k,C,L,U,W,$=wr.length&&Oi();k=new Bt({}),L=new Bn({props:{$$slots:{default:[Ri]},$$scope:{ctx:t}}});function V(ne,oe){return ne[0]?Ti:Hi}let q=V(t),z=q(t);return{c(){$&&$.c(),e=P(),n=u("div"),r=u("h3"),r.textContent="Public key",s=P(),c=u("table"),o=u("tbody"),i=u("tr"),l=u("td"),l.textContent="x",a=u("td"),b=u("code"),h=X(t[1]),p=P(),d=u("tr"),m=u("td"),m.textContent="y",_=u("td"),y=u("code"),x=X(t[2]),S=P(),E=u("tr"),w=u("td"),w.textContent="33b hex",v=u("td"),A=u("code"),Z=X(t[3]),T=P(),H=u("tr"),j=u("td"),j.textContent="64b hex",O=u("td"),N=u("code"),D=X(t[4]),G=P(),R=u("h3"),R.textContent="Signature",I=P(),be(k.$$.fragment),C=P(),be(L.$$.fragment),U=P(),z.c(),g(r,"class","curve-data__header"),g(l,"class","curve-data__key"),g(m,"class","curve-data__key"),g(w,"class","curve-data__key"),g(j,"class","curve-data__key"),g(c,"class","curve-data__table"),g(R,"class","curve-data__header"),g(n,"class","curve-data")},m(ne,oe){$&&$.m(ne,oe),F(ne,e,oe),F(ne,n,oe),f(n,r),f(n,s),f(n,c),f(c,o),f(o,i),f(i,l),f(i,a),f(a,b),f(b,h),f(o,p),f(o,d),f(d,m),f(d,_),f(_,y),f(y,x),f(o,S),f(o,E),f(E,w),f(E,v),f(v,A),f(A,Z),f(o,T),f(o,H),f(H,j),f(H,O),f(O,N),f(N,D),f(n,G),f(n,R),f(n,I),ue(k,n,null),f(n,C),ue(L,n,null),f(n,U),z.m(n,null),W=!0},p(ne,[oe]){wr.length&&$.p(ne,oe),(!W||oe&2)&&ee(h,ne[1]),(!W||oe&4)&&ee(x,ne[2]),(!W||oe&8)&&ee(Z,ne[3]),(!W||oe&16)&&ee(D,ne[4]);const ie={};oe&2097152&&(ie.$$scope={dirty:oe,ctx:ne}),L.$set(ie),q===(q=V(ne))&&z?z.p(ne,oe):(z.d(1),z=q(ne),z&&(z.c(),z.m(n,null)))},i(ne){W||(J(k.$$.fragment,ne),J(L.$$.fragment,ne),W=!0)},o(ne){se(k.$$.fragment,ne),se(L.$$.fragment,ne),W=!1},d(ne){$&&$.d(ne),ne&&Y(e),ne&&Y(n),de(k),de(L),z.d()}}}let wr="";function Li(t,e,n){let r,s,c;Se(t,gr,v=>n(16,s=v)),Se(t,nt,v=>n(15,c=v));let{privKey:o}=e,{CURVE:i}=e,l,a,b,h,p,d,m,_,y,x="sha256";const S={sha256:tt,sha3_256:Tr,keccak_256:Nr},E=Object.keys(S),w=v=>{n(14,x=v.detail)};return t.$$set=v=>{"privKey"in v&&n(12,o=v.privKey),"CURVE"in v&&n(13,i=v.CURVE)},t.$$.update=()=>{if(t.$$.dirty&32768&&n(0,r=c.length>0),t.$$.dirty&61441)try{const v=i.getPublicKey(o),A=i.ProjectivePoint.fromHex(v);if(n(1,[l,a]=[A.x,A.y].map(Z=>De(Z)),l,(n(2,a),n(13,i),n(12,o),n(0,r),n(14,x),n(15,c))),n(3,b=A.toHex(!0)),n(4,h=A.toHex(!1)),r){const Z=S[x],T=Z(c),H=i.sign(T,o);n(5,[p,d]=[H.r,H.s].map(j=>De(j)),p,(n(6,d),n(13,i),n(12,o),n(0,r),n(14,x),n(15,c))),n(7,m=H.toCompactHex()),n(8,_=H.toDERHex()),n(9,y=je(T))}}catch(v){Le(gr,s=Tt(v),s)}},[r,l,a,b,h,p,d,m,_,y,E,w,o,i,x,c]}class qi extends Ge{constructor(e){super(),Me(this,e,Li,Ni,qe,{privKey:12,CURVE:13})}}function Ui(t){let e,n,r,s,c,o,i,l,a,b,h,p,d;return{c(){e=u("div"),n=u("div"),r=u("label"),r.innerHTML="<strong>Private key in hex format</strong>",s=P(),c=u("button"),c.textContent="Generate Random",o=P(),i=u("div"),l=u("input"),a=P(),b=u("div"),h=X(t[1]),g(r,"for","priv-key-input"),g(r,"class","priv-key__label svelte-rjm8o7"),g(c,"type","button"),g(c,"class","priv-key__btn button svelte-rjm8o7"),g(n,"class","priv-key__header svelte-rjm8o7"),g(l,"class","text-input"),g(l,"id","priv-key-input"),g(l,"type","text"),g(l,"maxlength",t[0]),l.value=t[2],g(b,"class","error svelte-rjm8o7"),g(e,"class","priv-key svelte-rjm8o7")},m(m,_){F(m,e,_),f(e,n),f(n,r),f(n,s),f(n,c),f(e,o),f(e,i),f(i,l),f(e,a),f(e,b),f(b,h),p||(d=[ke(c,"click",t[3]),ke(l,"input",t[4])],p=!0)},p(m,[_]){_&1&&g(l,"maxlength",m[0]),_&4&&l.value!==m[2]&&(l.value=m[2]),_&2&&ee(h,m[1])},i:_e,o:_e,d(m){m&&Y(e),p=!1,dt(d)}}}function Di(t){return/[^0-9A-Fa-f]/g.test(t)}function Mi(t,e,n){let r,s;Se(t,ut,h=>n(2,r=h)),Se(t,Ke,h=>n(7,s=h));let{keyLength:c}=e,{curve:o}=e,i=o,l="";function a(){const h=window.crypto.getRandomValues(new Uint8Array(c/2));Le(ut,r=je(h),r),n(1,l="")}function b(h){const p=h.target.value,d=o.split("_").join(" ");p.length!==c||Di(p)?n(1,l=`Key must be ${c/2} bytes (${c} hex digits) for ${d}`):BigInt(`0x${p}`)>=s?n(1,l="Key is out of curve's order (n)"):(Le(ut,r=p,r),n(1,l=""))}return t.$$set=h=>{"keyLength"in h&&n(0,c=h.keyLength),"curve"in h&&n(5,o=h.curve)},t.$$.update=()=>{t.$$.dirty&96&&i!==o&&(n(6,i=o),n(1,l=""))},[c,l,r,a,b,o,i]}class Gi extends Ge{constructor(e){super(),Me(this,e,Mi,Ui,qe,{keyLength:0,curve:5})}}function Hs(t){let e,n;return{c(){e=u("div"),n=X(t[6]),g(e,"class","error svelte-1rwp4r1")},m(r,s){F(r,e,s),f(e,n)},p(r,s){s&64&&ee(n,r[6])},d(r){r&&Y(e)}}}function Ts(t){let e,n;return{c(){e=u("div"),n=X(t[7]),g(e,"class","error svelte-1rwp4r1")},m(r,s){F(r,e,s),f(e,n)},p(r,s){s&128&&ee(n,r[7])},d(r){r&&Y(e)}}}function Ns(t){let e,n;return{c(){e=u("div"),n=X(t[8]),g(e,"class","error svelte-1rwp4r1")},m(r,s){F(r,e,s),f(e,n)},p(r,s){s&256&&ee(n,r[8])},d(r){r&&Y(e)}}}function Ls(t){let e,n;return{c(){e=u("div"),n=X(t[9]),g(e,"class","error svelte-1rwp4r1")},m(r,s){F(r,e,s),f(e,n)},p(r,s){s&512&&ee(n,r[9])},d(r){r&&Y(e)}}}function qs(t){let e,n;return{c(){e=u("div"),n=X(t[10]),g(e,"class","error svelte-1rwp4r1")},m(r,s){F(r,e,s),f(e,n)},p(r,s){s&1024&&ee(n,r[10])},d(r){r&&Y(e)}}}function Us(t){let e;return{c(){e=u("small"),e.textContent="(random coordinates for points will be generated)",g(e,"class","create-note svelte-1rwp4r1")},m(n,r){F(n,e,r)},d(n){n&&Y(e)}}}function Zi(t){let e,n,r,s,c,o,i,l,a,b,h,p,d,m,_,y,x,S,E,w,v,A,Z,T,H,j,O,N,D,G,R,I,k,C,L,U,W,$,V,q,z,ne,oe=t[6]&&Hs(t),ie=t[7]&&Ts(t),me=t[8]&&Ns(t),he=t[9]&&Ls(t),xe=t[10]&&qs(t),ge=t[0]==2&&Us();return{c(){e=u("h3"),e.textContent="Define custom weierstrass curve",n=P(),r=u("div"),r.innerHTML=`<div class="subheader svelte-1rwp4r1">Curve&#39;s formula is <b>y² = x³ + ax + b</b></div> 
  <div>Generator point (<b>G</b>) used for curve calculator:
    <ul class="curve-desc__coords svelte-1rwp4r1"><li class="svelte-1rwp4r1"><b class="svelte-1rwp4r1">Gx</b>: <code class="svelte-1rwp4r1">0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296</code></li> 
      <li class="svelte-1rwp4r1"><b class="svelte-1rwp4r1">Gy</b>: <code class="svelte-1rwp4r1">0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5</code></li></ul> 
    <b>a</b> and <b>b</b> params must be non-floating point integers. <b>P</b>, <b>n</b> and <b>h</b> must be positive and non-floating point integers.</div>`,s=P(),c=u("div"),o=u("div"),i=u("label"),i.innerHTML="<strong>a</strong> - constant &quot;a&quot;",l=P(),a=u("input"),b=P(),oe&&oe.c(),h=P(),p=u("div"),d=u("label"),d.innerHTML="<strong>b</strong> - constant &quot;b&quot;",m=P(),_=u("input"),y=P(),ie&&ie.c(),x=P(),S=u("div"),E=u("label"),E.innerHTML="<strong>P</strong> - modulus at <b>y² ≡ x³ + ax + b (mod p)</b>",w=P(),v=u("input"),A=P(),me&&me.c(),Z=P(),T=u("div"),H=u("label"),H.innerHTML="<strong>n</strong> - curve order, the count of all possible EC points",j=P(),O=u("input"),N=P(),he&&he.c(),D=P(),G=u("div"),R=u("label"),R.innerHTML="<strong>h</strong> - cofactor, the number of subgroups",I=P(),k=u("input"),C=P(),xe&&xe.c(),L=P(),U=u("div"),W=X(t[11]),$=P(),V=u("button"),V.textContent="Create curve",q=P(),ge&&ge.c(),g(e,"class","header svelte-1rwp4r1"),g(r,"class","curve-desc svelte-1rwp4r1"),g(i,"for","a"),g(i,"class","priv-key__label"),g(a,"class","text-input svelte-1rwp4r1"),g(a,"id","a"),g(a,"type","text"),g(a,"name","a"),g(a,"placeholder","a"),g(o,"class","curve__field svelte-1rwp4r1"),g(d,"for","b"),g(d,"class","priv-key__label"),g(_,"class","text-input svelte-1rwp4r1"),g(_,"id","b"),g(_,"type","text"),g(_,"name","b"),g(_,"placeholder","b"),g(p,"class","curve__field svelte-1rwp4r1"),g(E,"for","P"),g(E,"class","priv-key__label"),g(v,"class","text-input svelte-1rwp4r1"),g(v,"id","P"),g(v,"type","text"),g(v,"name","P"),g(v,"placeholder","P"),g(S,"class","curve__field svelte-1rwp4r1"),g(H,"for","n"),g(H,"class","priv-key__label"),g(O,"class","text-input svelte-1rwp4r1"),g(O,"id","n"),g(O,"type","text"),g(O,"name","n"),g(O,"placeholder","n"),g(T,"class","curve__field svelte-1rwp4r1"),g(R,"for","h"),g(R,"class","priv-key__label"),g(k,"class","text-input svelte-1rwp4r1"),g(k,"id","h"),g(k,"type","text"),g(k,"name","h"),g(k,"placeholder","h"),g(G,"class","curve__field svelte-1rwp4r1"),g(U,"class","error svelte-1rwp4r1"),g(V,"class","button svelte-1rwp4r1"),g(c,"class","curve svelte-1rwp4r1")},m(fe,ve){F(fe,e,ve),F(fe,n,ve),F(fe,r,ve),F(fe,s,ve),F(fe,c,ve),f(c,o),f(o,i),f(o,l),f(o,a),ct(a,t[1]),f(o,b),oe&&oe.m(o,null),f(c,h),f(c,p),f(p,d),f(p,m),f(p,_),ct(_,t[2]),f(p,y),ie&&ie.m(p,null),f(c,x),f(c,S),f(S,E),f(S,w),f(S,v),ct(v,t[3]),f(S,A),me&&me.m(S,null),f(c,Z),f(c,T),f(T,H),f(T,j),f(T,O),ct(O,t[4]),f(T,N),he&&he.m(T,null),f(c,D),f(c,G),f(G,R),f(G,I),f(G,k),ct(k,t[5]),f(G,C),xe&&xe.m(G,null),f(c,L),f(c,U),f(U,W),f(c,$),f(c,V),f(c,q),ge&&ge.m(c,null),z||(ne=[ke(a,"input",t[15]),ke(_,"input",t[16]),ke(v,"input",t[17]),ke(O,"input",t[18]),ke(k,"input",t[19]),ke(V,"click",t[12])],z=!0)},p(fe,[ve]){ve&2&&a.value!==fe[1]&&ct(a,fe[1]),fe[6]?oe?oe.p(fe,ve):(oe=Hs(fe),oe.c(),oe.m(o,null)):oe&&(oe.d(1),oe=null),ve&4&&_.value!==fe[2]&&ct(_,fe[2]),fe[7]?ie?ie.p(fe,ve):(ie=Ts(fe),ie.c(),ie.m(p,null)):ie&&(ie.d(1),ie=null),ve&8&&v.value!==fe[3]&&ct(v,fe[3]),fe[8]?me?me.p(fe,ve):(me=Ns(fe),me.c(),me.m(S,null)):me&&(me.d(1),me=null),ve&16&&O.value!==fe[4]&&ct(O,fe[4]),fe[9]?he?he.p(fe,ve):(he=Ls(fe),he.c(),he.m(T,null)):he&&(he.d(1),he=null),ve&32&&k.value!==fe[5]&&ct(k,fe[5]),fe[10]?xe?xe.p(fe,ve):(xe=qs(fe),xe.c(),xe.m(G,null)):xe&&(xe.d(1),xe=null),ve&2048&&ee(W,fe[11]),fe[0]==2?ge||(ge=Us(),ge.c(),ge.m(c,null)):ge&&(ge.d(1),ge=null)},i:_e,o:_e,d(fe){fe&&Y(e),fe&&Y(n),fe&&Y(r),fe&&Y(s),fe&&Y(c),oe&&oe.d(),ie&&ie.d(),me&&me.d(),he&&he.d(),xe&&xe.d(),ge&&ge.d(),z=!1,dt(ne)}}}function Ki(t,e,n){let r,s,c;Se(t,yr,O=>n(13,s=O)),Se(t,gr,O=>n(14,c=O));let{demo:o}=e;const i=Mn();let l="",{a,b,p:h,n:p,h:d}=_r;const{Gx:m,Gy:_}=_r;let y="",x="",S="",E="",w="";const v=()=>{if(r)return;if(n(1,a=BigInt(a)),n(2,b=BigInt(b)),n(3,h=BigInt(h)),n(4,p=BigInt(p)),n(5,d=BigInt(d)),ye(_**2n,h)!==ye(m**3n+a*m+b,h)){n(11,l="Values of a, b, p, Gx, and Gy do not match the equation y² ≡ x³ + ax + b (mod p)");return}let O;try{O=Cc(a,b,h,p,d,m,_)}catch(N){n(11,l=Tt(N));return}n(11,l=""),i("showData",O)};function A(){a=this.value,n(1,a)}function Z(){b=this.value,n(2,b)}function T(){h=this.value,n(3,h)}function H(){p=this.value,n(4,p)}function j(){d=this.value,n(5,d)}return t.$$set=O=>{"demo"in O&&n(0,o=O.demo)},t.$$.update=()=>{t.$$.dirty&16385&&o==1&&n(11,l=c),t.$$.dirty&8193&&o==2&&n(11,l=s),t.$$.dirty&62&&(n(6,y=n(7,x=n(8,S=n(9,E=n(10,w=""))))),mr(a)||n(6,y=`a ${Fe.INT}`),mr(b)||n(7,x=`b ${Fe.INT}`),Tn(h)||n(8,S=`P ${Fe.POSITIVE_INT}`),Tn(p)||n(9,E=`n ${Fe.POSITIVE_INT}`),Tn(d)||n(10,w=`h ${Fe.POSITIVE_INT}`)),t.$$.dirty&1984&&(r=y.length||x.length||S.length||E.length||w.length)},[o,a,b,h,p,d,y,x,S,E,w,l,v,s,c,A,Z,T,H,j]}class Vc extends Ge{constructor(e){super(),Me(this,e,Ki,Zi,qe,{demo:0})}}function Ds(t){let e,n;return{c(){e=u("div"),n=X(t[3]),g(e,"class","error svelte-oqfmga")},m(r,s){F(r,e,s),f(e,n)},p(r,s){s&8&&ee(n,r[3])},d(r){r&&Y(e)}}}function ji(t){let e,n,r,s,c,o,i,l,a,b,h=t[3].length&&Ds(t);return{c(){e=u("div"),n=u("label"),r=u("strong"),s=X(t[2]),c=P(),o=u("input"),i=P(),h&&h.c(),l=ht(),g(n,"class","point-input__label svelte-oqfmga"),g(n,"for",t[0]),g(o,"class","text-input"),g(o,"id",t[0]),g(o,"type","text"),o.value=t[1],g(e,"class","point-input svelte-oqfmga")},m(p,d){F(p,e,d),f(e,n),f(n,r),f(r,s),f(e,c),f(e,o),F(p,i,d),h&&h.m(p,d),F(p,l,d),a||(b=ke(o,"input",t[4]),a=!0)},p(p,[d]){d&4&&ee(s,p[2]),d&1&&g(n,"for",p[0]),d&1&&g(o,"id",p[0]),d&2&&o.value!==p[1]&&(o.value=p[1]),p[3].length?h?h.p(p,d):(h=Ds(p),h.c(),h.m(l.parentNode,l)):h&&(h.d(1),h=null)},i:_e,o:_e,d(p){p&&Y(e),p&&Y(i),h&&h.d(p),p&&Y(l),a=!1,b()}}}function Vi(t,e,n){const r=Mn();let{field:s}=e,{value:c}=e,{label:o}=e,i="";const l=a=>{const{value:b}=a.target;if(b!=="-"){if(!mr(b)){n(3,i=`${o} should be non floating point integer`);return}n(3,i=""),r("input",{value:b,field:s})}};return t.$$set=a=>{"field"in a&&n(0,s=a.field),"value"in a&&n(1,c=a.value),"label"in a&&n(2,o=a.label)},[s,c,o,i,l]}class ft extends Ge{constructor(e){super(),Me(this,e,Vi,ji,qe,{field:0,value:1,label:2})}}function Yi(t){let e,n,r,s,c,o,i;return{c(){e=u("div"),n=u("input"),r=P(),s=u("label"),c=X(t[2]),g(n,"type","radio"),g(n,"name",t[0]),n.value=t[1],g(n,"id",t[1]),n.checked=t[3],g(s,"for",t[1]),g(e,"class","ecc-radio")},m(l,a){F(l,e,a),f(e,n),f(e,r),f(e,s),f(s,c),o||(i=ke(n,"change",t[5]),o=!0)},p(l,[a]){a&1&&g(n,"name",l[0]),a&2&&(n.value=l[1]),a&2&&g(n,"id",l[1]),a&8&&(n.checked=l[3]),a&4&&ee(c,l[2]),a&2&&g(s,"for",l[1])},i:_e,o:_e,d(l){l&&Y(e),o=!1,i()}}}function zi(t,e,n){const r=Mn();let{name:s}=e,{value:c}=e,{title:o}=e,{checked:i=!1}=e;const l=()=>{r("change",c)};return t.$$set=a=>{"name"in a&&n(0,s=a.name),"value"in a&&n(1,c=a.value),"title"in a&&n(2,o=a.title),"checked"in a&&n(3,i=a.checked)},[s,c,o,i,r,l]}class Gr extends Ge{constructor(e){super(),Me(this,e,zi,Yi,qe,{name:0,value:1,title:2,checked:3})}}function Ms(t,e,n){const r=t.slice();return r[66]=e[n],r}function Gs(t,e,n){const r=t.slice();return r[69]=e[n],r[71]=n,r}function Zs(t,e,n){const r=t.slice();return r[72]=e[n],r}function Fi(t){let e,n,r=t[66].type+"",s,c,o,i,l,a,b=t[66].list,h=[];for(let m=0;m<b.length;m+=1)h[m]=js(Gs(t,b,m));const p=m=>se(h[m],1,1,()=>{h[m]=null});let d=t[66].type==="ECDSA"&&$i(t);return{c(){e=u("div"),n=u("div"),s=X(r),c=P(),o=u("div");for(let m=0;m<h.length;m+=1)h[m].c();i=P(),d&&d.c(),l=P(),g(n,"class","curves-list__title"),g(e,"class","curves-list")},m(m,_){F(m,e,_),f(e,n),f(n,s),f(e,c),f(e,o);for(let y=0;y<h.length;y+=1)h[y].m(o,null);f(e,i),d&&d.m(e,null),f(e,l),a=!0},p(m,_){if(_[0]&134217728){b=m[66].list;let y;for(y=0;y<b.length;y+=1){const x=Gs(m,b,y);h[y]?(h[y].p(x,_),J(h[y],1)):(h[y]=js(x),h[y].c(),J(h[y],1),h[y].m(o,null))}for(We(),y=b.length;y<h.length;y+=1)p(y);Xe()}m[66].type==="ECDSA"&&d.p(m,_)},i(m){if(!a){for(let _=0;_<b.length;_+=1)J(h[_]);J(d),a=!0}},o(m){h=h.filter(Boolean);for(let _=0;_<h.length;_+=1)se(h[_]);se(d),a=!1},d(m){m&&Y(e),bt(h,m),d&&d.d()}}}function Wi(t){let e,n,r,s;return n=new Gr({props:{name:"points_curve",value:`points_${t[66].type}_${t[69]}`,checked:t[66].type=="ECDSA"&&t[71]==0,title:t[69]}}),n.$on("change",t[27]),{c(){e=u("div"),be(n.$$.fragment),r=P(),g(e,"class","ecc-radio")},m(c,o){F(c,e,o),ue(n,e,null),f(e,r),s=!0},p:_e,i(c){s||(J(n.$$.fragment,c),s=!0)},o(c){se(n.$$.fragment,c),s=!1},d(c){c&&Y(e),de(n)}}}function Xi(t){let e,n,r=t[66].options,s=[];for(let o=0;o<r.length;o+=1)s[o]=Ks(Zs(t,r,o));const c=o=>se(s[o],1,1,()=>{s[o]=null});return{c(){for(let o=0;o<s.length;o+=1)s[o].c();e=ht()},m(o,i){for(let l=0;l<s.length;l+=1)s[l].m(o,i);F(o,e,i),n=!0},p(o,i){if(i[0]&134217728){r=o[66].options;let l;for(l=0;l<r.length;l+=1){const a=Zs(o,r,l);s[l]?(s[l].p(a,i),J(s[l],1)):(s[l]=Ks(a),s[l].c(),J(s[l],1),s[l].m(e.parentNode,e))}for(We(),l=r.length;l<s.length;l+=1)c(l);Xe()}},i(o){if(!n){for(let i=0;i<r.length;i+=1)J(s[i]);n=!0}},o(o){s=s.filter(Boolean);for(let i=0;i<s.length;i+=1)se(s[i]);n=!1},d(o){bt(s,o),o&&Y(e)}}}function Ks(t){let e,n;return e=new Gr({props:{name:"points_curve",value:`points_${t[66].type}_${t[69]}_${t[72]}`,title:`${t[69]} - ${t[72]}`}}),e.$on("change",t[27]),{c(){be(e.$$.fragment)},m(r,s){ue(e,r,s),n=!0},p:_e,i(r){n||(J(e.$$.fragment,r),n=!0)},o(r){se(e.$$.fragment,r),n=!1},d(r){de(e,r)}}}function js(t){let e,n,r,s;const c=[Xi,Wi],o=[];function i(l,a){return l[69]=="bls12-381"?0:1}return e=i(t),n=o[e]=c[e](t),{c(){n.c(),r=ht()},m(l,a){o[e].m(l,a),F(l,r,a),s=!0},p(l,a){n.p(l,a)},i(l){s||(J(n),s=!0)},o(l){se(n),s=!1},d(l){o[e].d(l),l&&Y(r)}}}function $i(t){let e,n;return e=new Gr({props:{name:"points_curve",value:"points_custom",title:"create curve"}}),e.$on("change",t[27]),{c(){be(e.$$.fragment)},m(r,s){ue(e,r,s),n=!0},p:_e,i(r){n||(J(e.$$.fragment,r),n=!0)},o(r){se(e.$$.fragment,r),n=!1},d(r){de(e,r)}}}function Vs(t){let e,n,r=t[66].type!=="Schnorr"&&Fi(t);return{c(){r&&r.c(),e=ht()},m(s,c){r&&r.m(s,c),F(s,e,c),n=!0},p(s,c){s[66].type!=="Schnorr"&&r.p(s,c)},i(s){n||(J(r),n=!0)},o(s){se(r),n=!1},d(s){r&&r.d(s),s&&Y(e)}}}function Ys(t){let e,n;return e=new Vc({props:{demo:2}}),e.$on("showData",t[28]),{c(){be(e.$$.fragment)},m(r,s){ue(e,r,s),n=!0},p:_e,i(r){n||(J(e.$$.fragment,r),n=!0)},o(r){se(e.$$.fragment,r),n=!1},d(r){de(e,r)}}}function Qi(t){let e,n,r,s;return e=new ft({props:{label:"x",field:"a_x",value:t[0]}}),e.$on("input",t[29]),r=new ft({props:{label:"y",field:"a_y",value:t[1]}}),r.$on("input",t[29]),{c(){be(e.$$.fragment),n=P(),be(r.$$.fragment)},m(c,o){ue(e,c,o),F(c,n,o),ue(r,c,o),s=!0},p(c,o){const i={};o[0]&1&&(i.value=c[0]),e.$set(i);const l={};o[0]&2&&(l.value=c[1]),r.$set(l)},i(c){s||(J(e.$$.fragment,c),J(r.$$.fragment,c),s=!0)},o(c){se(e.$$.fragment,c),se(r.$$.fragment,c),s=!1},d(c){de(e,c),c&&Y(n),de(r,c)}}}function Ji(t){let e,n,r,s,c,o,i,l,a,b,h,p;return r=new ft({props:{label:"c0",field:"a_x_c0",value:t[6]}}),r.$on("input",t[29]),c=new ft({props:{label:"c1",field:"a_x_c1",value:t[7]}}),c.$on("input",t[29]),a=new ft({props:{label:"c0",field:"a_y_c0",value:t[8]}}),a.$on("input",t[29]),h=new ft({props:{label:"c1",field:"a_y_c1",value:t[9]}}),h.$on("input",t[29]),{c(){e=u("div"),e.innerHTML="<strong>x</strong>",n=P(),be(r.$$.fragment),s=P(),be(c.$$.fragment),o=P(),i=u("div"),i.innerHTML="<strong>y</strong>",l=P(),be(a.$$.fragment),b=P(),be(h.$$.fragment)},m(d,m){F(d,e,m),F(d,n,m),ue(r,d,m),F(d,s,m),ue(c,d,m),F(d,o,m),F(d,i,m),F(d,l,m),ue(a,d,m),F(d,b,m),ue(h,d,m),p=!0},p(d,m){const _={};m[0]&64&&(_.value=d[6]),r.$set(_);const y={};m[0]&128&&(y.value=d[7]),c.$set(y);const x={};m[0]&256&&(x.value=d[8]),a.$set(x);const S={};m[0]&512&&(S.value=d[9]),h.$set(S)},i(d){p||(J(r.$$.fragment,d),J(c.$$.fragment,d),J(a.$$.fragment,d),J(h.$$.fragment,d),p=!0)},o(d){se(r.$$.fragment,d),se(c.$$.fragment,d),se(a.$$.fragment,d),se(h.$$.fragment,d),p=!1},d(d){d&&Y(e),d&&Y(n),de(r,d),d&&Y(s),de(c,d),d&&Y(o),d&&Y(i),d&&Y(l),de(a,d),d&&Y(b),de(h,d)}}}function zs(t){let e,n,r,s,c,o,i,l,a,b,h,p,d,m,_,y,x,S,E,w,v;const A=[ta,ea],Z=[];function T(H,j){return H[23]?0:1}return m=T(t),_=Z[m]=A[m](t),{c(){e=u("div"),n=u("div"),r=u("strong"),r.textContent="Point B",s=P(),c=u("small"),c.textContent="(x, y)",o=P(),i=u("span"),l=u("button"),l.textContent="Base",a=P(),b=u("button"),b.textContent="Zero",h=P(),p=u("button"),p.textContent="Random",d=P(),_.c(),y=P(),x=u("div"),S=X(t[21]),g(l,"class","point-header__btn button svelte-1csuk34"),g(b,"class","point-header__btn button svelte-1csuk34"),g(p,"class","point-header__btn button svelte-1csuk34"),g(i,"class","point-header__btns svelte-1csuk34"),g(n,"class","point-header svelte-1csuk34"),g(x,"class","error svelte-1csuk34"),g(e,"class","fields-block svelte-1csuk34")},m(H,j){F(H,e,j),f(e,n),f(n,r),f(n,s),f(n,c),f(n,o),f(n,i),f(i,l),f(i,a),f(i,b),f(i,h),f(i,p),f(e,d),Z[m].m(e,null),f(e,y),f(e,x),f(x,S),E=!0,w||(v=[ke(l,"click",t[40]),ke(b,"click",t[41]),ke(p,"click",t[42])],w=!0)},p(H,j){let O=m;m=T(H),m===O?Z[m].p(H,j):(We(),se(Z[O],1,1,()=>{Z[O]=null}),Xe(),_=Z[m],_?_.p(H,j):(_=Z[m]=A[m](H),_.c()),J(_,1),_.m(e,y)),(!E||j[0]&2097152)&&ee(S,H[21])},i(H){E||(J(_),E=!0)},o(H){se(_),E=!1},d(H){H&&Y(e),Z[m].d(),w=!1,dt(v)}}}function ea(t){let e,n,r,s;return e=new ft({props:{label:"x",field:"b_x",value:t[2]}}),e.$on("input",t[29]),r=new ft({props:{label:"y",field:"b_y",value:t[3]}}),r.$on("input",t[29]),{c(){be(e.$$.fragment),n=P(),be(r.$$.fragment)},m(c,o){ue(e,c,o),F(c,n,o),ue(r,c,o),s=!0},p(c,o){const i={};o[0]&4&&(i.value=c[2]),e.$set(i);const l={};o[0]&8&&(l.value=c[3]),r.$set(l)},i(c){s||(J(e.$$.fragment,c),J(r.$$.fragment,c),s=!0)},o(c){se(e.$$.fragment,c),se(r.$$.fragment,c),s=!1},d(c){de(e,c),c&&Y(n),de(r,c)}}}function ta(t){let e,n,r,s,c,o,i,l,a,b,h,p;return r=new ft({props:{label:"c0",field:"b_x_c0",value:t[10]}}),r.$on("input",t[29]),c=new ft({props:{label:"c1",field:"b_x_c1",value:t[11]}}),c.$on("input",t[29]),a=new ft({props:{label:"c0",field:"b_y_c0",value:t[12]}}),a.$on("input",t[29]),h=new ft({props:{label:"c1",field:"b_y_c1",value:t[13]}}),h.$on("input",t[29]),{c(){e=u("div"),e.innerHTML="<strong>x</strong>",n=P(),be(r.$$.fragment),s=P(),be(c.$$.fragment),o=P(),i=u("div"),i.innerHTML="<strong>y</strong>",l=P(),be(a.$$.fragment),b=P(),be(h.$$.fragment)},m(d,m){F(d,e,m),F(d,n,m),ue(r,d,m),F(d,s,m),ue(c,d,m),F(d,o,m),F(d,i,m),F(d,l,m),ue(a,d,m),F(d,b,m),ue(h,d,m),p=!0},p(d,m){const _={};m[0]&1024&&(_.value=d[10]),r.$set(_);const y={};m[0]&2048&&(y.value=d[11]),c.$set(y);const x={};m[0]&4096&&(x.value=d[12]),a.$set(x);const S={};m[0]&8192&&(S.value=d[13]),h.$set(S)},i(d){p||(J(r.$$.fragment,d),J(c.$$.fragment,d),J(a.$$.fragment,d),J(h.$$.fragment,d),p=!0)},o(d){se(r.$$.fragment,d),se(c.$$.fragment,d),se(a.$$.fragment,d),se(h.$$.fragment,d),p=!1},d(d){d&&Y(e),d&&Y(n),de(r,d),d&&Y(s),de(c,d),d&&Y(o),d&&Y(i),d&&Y(l),de(a,d),d&&Y(b),de(h,d)}}}function Fs(t){let e,n,r,s,c,o,i,l,a,b,h,p,d,m,_;return{c(){e=u("div"),n=u("div"),n.innerHTML=`<strong>Scalar</strong> 
      <small>(number used for multiply operation)</small>`,r=P(),s=u("div"),c=u("input"),o=P(),i=u("div"),l=u("input"),a=P(),b=u("label"),b.textContent="Is hex",h=P(),p=u("div"),d=X(t[22]),g(n,"class","point-header svelte-1csuk34"),g(c,"class","text-input"),g(c,"id","scalar"),g(c,"type","text"),c.value=t[18],g(s,"class","point-input svelte-1csuk34"),g(l,"id","scalar-hex"),g(l,"class","scalar-checkbox svelte-1csuk34"),g(l,"type","checkbox"),g(b,"for","scalar-hex"),g(p,"class","error svelte-1csuk34"),g(e,"class","fields-block svelte-1csuk34")},m(y,x){F(y,e,x),f(e,n),f(e,r),f(e,s),f(s,c),f(e,o),f(e,i),f(i,l),f(i,a),f(i,b),f(e,h),f(e,p),f(p,d),m||(_=[ke(c,"input",t[30]),ke(l,"click",t[31])],m=!0)},p(y,x){x[0]&262144&&c.value!==y[18]&&(c.value=y[18]),x[0]&4194304&&ee(d,y[22])},d(y){y&&Y(e),m=!1,dt(_)}}}function na(t){let e,n,r,s,c,o,i,l,a,b,h,p,d,m;return{c(){e=u("table"),n=u("tr"),r=u("td"),r.innerHTML="<strong>x:</strong>",s=P(),c=u("td"),o=u("code"),i=X(t[4]),l=P(),a=u("tr"),b=u("td"),b.innerHTML="<strong>y:</strong>",h=P(),p=u("td"),d=u("code"),m=X(t[5]),g(r,"class","result__col result__col_title svelte-1csuk34"),g(o,"class","svelte-1csuk34"),g(c,"class","result__col svelte-1csuk34"),g(n,"class","result__row"),g(b,"class","result__col result__col_title svelte-1csuk34"),g(d,"class","svelte-1csuk34"),g(p,"class","result__col svelte-1csuk34"),g(a,"class","result__row"),g(e,"class","result")},m(_,y){F(_,e,y),f(e,n),f(n,r),f(n,s),f(n,c),f(c,o),f(o,i),f(e,l),f(e,a),f(a,b),f(a,h),f(a,p),f(p,d),f(d,m)},p(_,y){y[0]&16&&ee(i,_[4]),y[0]&32&&ee(m,_[5])},d(_){_&&Y(e)}}}function ra(t){let e,n,r,s,c,o,i,l,a,b,h,p,d,m,_,y,x,S,E,w,v,A,Z,T,H,j,O,N,D,G,R,I;return{c(){e=u("table"),n=u("tr"),n.innerHTML='<td colspan="2"><strong>x</strong></td>',r=P(),s=u("tr"),c=u("td"),c.innerHTML="<strong>c0:</strong>",o=P(),i=u("td"),l=u("code"),a=X(t[14]),b=P(),h=u("tr"),p=u("td"),p.innerHTML="<strong>c1:</strong>",d=P(),m=u("td"),_=u("code"),y=X(t[15]),x=P(),S=u("tr"),S.innerHTML='<td colspan="2"><strong>y</strong></td>',E=P(),w=u("tr"),v=u("td"),v.innerHTML="<strong>c0:</strong>",A=P(),Z=u("td"),T=u("code"),H=X(t[16]),j=P(),O=u("tr"),N=u("td"),N.innerHTML="<strong>c1:</strong>",D=P(),G=u("td"),R=u("code"),I=X(t[17]),g(c,"class","result__col result__col_title svelte-1csuk34"),g(l,"class","svelte-1csuk34"),g(i,"class","result__col svelte-1csuk34"),g(s,"class","result__row"),g(p,"class","result__col result__col_title svelte-1csuk34"),g(_,"class","svelte-1csuk34"),g(m,"class","result__col svelte-1csuk34"),g(h,"class","result__row"),g(v,"class","result__col result__col_title svelte-1csuk34"),g(T,"class","svelte-1csuk34"),g(Z,"class","result__col svelte-1csuk34"),g(w,"class","result__row"),g(N,"class","result__col result__col_title svelte-1csuk34"),g(R,"class","svelte-1csuk34"),g(G,"class","result__col svelte-1csuk34"),g(O,"class","result__row"),g(e,"class","result")},m(k,C){F(k,e,C),f(e,n),f(e,r),f(e,s),f(s,c),f(s,o),f(s,i),f(i,l),f(l,a),f(e,b),f(e,h),f(h,p),f(h,d),f(h,m),f(m,_),f(_,y),f(e,x),f(e,S),f(e,E),f(e,w),f(w,v),f(w,A),f(w,Z),f(Z,T),f(T,H),f(e,j),f(e,O),f(O,N),f(O,D),f(O,G),f(G,R),f(R,I)},p(k,C){C[0]&16384&&ee(a,k[14]),C[0]&32768&&ee(y,k[15]),C[0]&65536&&ee(H,k[16]),C[0]&131072&&ee(I,k[17])},d(k){k&&Y(e)}}}function sa(t){let e,n,r,s,c,o,i,l,a,b,h,p,d,m,_,y,x,S,E,w,v,A,Z,T,H,j,O,N,D,G,R,I,k,C,L,U,W,$,V,q,z,ne,oe,ie,me,he,xe,ge,fe,ve,$e,lt,pt,it,mt,kt,ze=Un,Be=[];for(let M=0;M<ze.length;M+=1)Be[M]=Vs(Ms(t,ze,M));const Ve=M=>se(Be[M],1,1,()=>{Be[M]=null});let Ce=t[26]&&Ys(t);const $t=[Ji,Qi],rt=[];function Qt(M,Q){return M[23]?0:1}v=Qt(t),A=rt[v]=$t[v](t);let Pe=t[25]&&zs(t),Ze=t[24]&&Fs(t);function ln(M,Q){return M[23]?ra:na}let Kt=ln(t),Qe=Kt(t);return{c(){e=u("h3"),e.textContent="Demo 2: Elliptic curve point operations (add, subtract, multiply)",n=P(),r=u("p"),r.textContent=`This form allows adding, subtracting, and multiplying points on the chosen elliptic curve.
  By default, random coordinates are generated for A and B points.`,s=P(),c=u("div");for(let M=0;M<Be.length;M+=1)Be[M].c();o=P(),Ce&&Ce.c(),i=P(),l=u("div"),a=u("div"),b=u("strong"),b.textContent="Point A",h=P(),p=u("small"),p.textContent="(x, y)",d=P(),m=u("span"),_=u("button"),_.textContent="Base",y=P(),x=u("button"),x.textContent="Zero",S=P(),E=u("button"),E.textContent="Random",w=P(),A.c(),Z=P(),T=u("div"),H=X(t[20]),j=P(),O=u("div"),N=u("span"),D=u("input"),G=P(),R=u("label"),R.textContent="Add",I=P(),k=u("span"),C=u("input"),L=P(),U=u("label"),U.textContent="Subtract",W=P(),$=u("span"),V=u("input"),q=P(),z=u("label"),z.textContent="Multiply",ne=P(),Pe&&Pe.c(),oe=P(),Ze&&Ze.c(),ie=P(),me=u("div"),he=u("button"),he.textContent="Calculate",xe=P(),ge=u("div"),fe=X(t[19]),ve=P(),$e=u("div"),$e.innerHTML=`<strong>Result C</strong> 
  <small>(x, y)</small>`,lt=P(),Qe.c(),pt=ht(),g(e,"class","header svelte-1csuk34"),g(r,"class","subheader svelte-1csuk34"),g(c,"class","curves-list-container svelte-1csuk34"),g(_,"class","point-header__btn button svelte-1csuk34"),g(x,"class","point-header__btn button svelte-1csuk34"),g(E,"class","point-header__btn button svelte-1csuk34"),g(m,"class","point-header__btns svelte-1csuk34"),g(a,"class","point-header svelte-1csuk34"),g(T,"class","error svelte-1csuk34"),g(l,"class","fields-block svelte-1csuk34"),g(D,"type","radio"),g(D,"name","operation"),D.value="add",g(D,"id","add"),D.checked=!0,g(R,"for","add"),g(N,"class","operation svelte-1csuk34"),g(C,"type","radio"),g(C,"name","operation"),C.value="subtract",g(C,"id","subtract"),g(U,"for","subtract"),g(k,"class","operation svelte-1csuk34"),g(V,"type","radio"),g(V,"name","operation"),V.value="multiply",g(V,"id","multiply"),g(z,"for","multiply"),g($,"class","operation svelte-1csuk34"),g(O,"class","operations svelte-1csuk34"),g(he,"class","button"),g(me,"class","operations svelte-1csuk34"),g(ge,"class","error svelte-1csuk34"),g($e,"class","point-header svelte-1csuk34")},m(M,Q){F(M,e,Q),F(M,n,Q),F(M,r,Q),F(M,s,Q),F(M,c,Q);for(let le=0;le<Be.length;le+=1)Be[le].m(c,null);F(M,o,Q),Ce&&Ce.m(M,Q),F(M,i,Q),F(M,l,Q),f(l,a),f(a,b),f(a,h),f(a,p),f(a,d),f(a,m),f(m,_),f(m,y),f(m,x),f(m,S),f(m,E),f(l,w),rt[v].m(l,null),f(l,Z),f(l,T),f(T,H),F(M,j,Q),F(M,O,Q),f(O,N),f(N,D),f(N,G),f(N,R),f(O,I),f(O,k),f(k,C),f(k,L),f(k,U),f(O,W),f(O,$),f($,V),f($,q),f($,z),F(M,ne,Q),Pe&&Pe.m(M,Q),F(M,oe,Q),Ze&&Ze.m(M,Q),F(M,ie,Q),F(M,me,Q),f(me,he),F(M,xe,Q),F(M,ge,Q),f(ge,fe),F(M,ve,Q),F(M,$e,Q),F(M,lt,Q),Qe.m(M,Q),F(M,pt,Q),it=!0,mt||(kt=[ke(_,"click",t[37]),ke(x,"click",t[38]),ke(E,"click",t[39]),ke(D,"change",t[35]),ke(C,"change",t[35]),ke(V,"change",t[35]),ke(he,"click",t[36])],mt=!0)},p(M,Q){if(Q[0]&134217728){ze=Un;let Ae;for(Ae=0;Ae<ze.length;Ae+=1){const St=Ms(M,ze,Ae);Be[Ae]?(Be[Ae].p(St,Q),J(Be[Ae],1)):(Be[Ae]=Vs(St),Be[Ae].c(),J(Be[Ae],1),Be[Ae].m(c,null))}for(We(),Ae=ze.length;Ae<Be.length;Ae+=1)Ve(Ae);Xe()}M[26]?Ce?(Ce.p(M,Q),Q[0]&67108864&&J(Ce,1)):(Ce=Ys(M),Ce.c(),J(Ce,1),Ce.m(i.parentNode,i)):Ce&&(We(),se(Ce,1,1,()=>{Ce=null}),Xe());let le=v;v=Qt(M),v===le?rt[v].p(M,Q):(We(),se(rt[le],1,1,()=>{rt[le]=null}),Xe(),A=rt[v],A?A.p(M,Q):(A=rt[v]=$t[v](M),A.c()),J(A,1),A.m(l,Z)),(!it||Q[0]&1048576)&&ee(H,M[20]),M[25]?Pe?(Pe.p(M,Q),Q[0]&33554432&&J(Pe,1)):(Pe=zs(M),Pe.c(),J(Pe,1),Pe.m(oe.parentNode,oe)):Pe&&(We(),se(Pe,1,1,()=>{Pe=null}),Xe()),M[24]?Ze?Ze.p(M,Q):(Ze=Fs(M),Ze.c(),Ze.m(ie.parentNode,ie)):Ze&&(Ze.d(1),Ze=null),(!it||Q[0]&524288)&&ee(fe,M[19]),Kt===(Kt=ln(M))&&Qe?Qe.p(M,Q):(Qe.d(1),Qe=Kt(M),Qe&&(Qe.c(),Qe.m(pt.parentNode,pt)))},i(M){if(!it){for(let Q=0;Q<ze.length;Q+=1)J(Be[Q]);J(Ce),J(A),J(Pe),it=!0}},o(M){Be=Be.filter(Boolean);for(let Q=0;Q<Be.length;Q+=1)se(Be[Q]);se(Ce),se(A),se(Pe),it=!1},d(M){M&&Y(e),M&&Y(n),M&&Y(r),M&&Y(s),M&&Y(c),bt(Be,M),M&&Y(o),Ce&&Ce.d(M),M&&Y(i),M&&Y(l),rt[v].d(),M&&Y(j),M&&Y(O),M&&Y(ne),Pe&&Pe.d(M),M&&Y(oe),Ze&&Ze.d(M),M&&Y(ie),M&&Y(me),M&&Y(xe),M&&Y(ge),M&&Y(ve),M&&Y($e),M&&Y(lt),Qe.d(M),M&&Y(pt),mt=!1,dt(kt)}}}const ca="number must be positive and non-floating point integer, for hex click checkbox above",oa="number must be a hex number, for decimals uncheck checkbox above";function fa(t,e,n){let r;Se(t,yr,M=>n(47,r=M));let s=Ye.ProjectivePoint,c=Ye;const{a:o,b:i,p:l,n:a,h:b,Gx:h,Gy:p}=_r;let d="",m="",_="",y="",x="",S="",E="",w="",v="",A="",Z="",T="",H="",j="",O="",N="",D="",G="",R="31415",I="",k="",C="",L="",U=!1,W=!1,$=!0,V="add",q=!1,z=!1;no(()=>{Ve("A"),Ve("B")});const ne=M=>{const Q=M.detail.toLowerCase().split("points_")[1];switch(Q){case"ecdsa_secp256k1":c=Ye,s=Ye.ProjectivePoint;break;case"ecdsa_p256":c=Lt,s=Lt.ProjectivePoint;break;case"ecdsa_p384":c=zt,s=zt.ProjectivePoint;break;case"ecdsa_p521":c=Ft,s=Ft.ProjectivePoint;break;case"eddsa_ed25519":c=Oe,s=Oe.ExtendedPoint;break;case"eddsa_ed448":c=Wt,s=Wt.ExtendedPoint;break;case"bls_bls12-381_g1":c=Te,s=Te.G1.ProjectivePoint;break;case"bls_bls12-381_g2":c=Te,s=Te.G2.ProjectivePoint;break;case"custom":try{c=Cc(o,i,l,a,b,h,p),s=c.ProjectivePoint}catch(le){Le(yr,r=Tt(le),r)}break;default:c=Ye,s=Ye.ProjectivePoint;break}n(23,U=Q==="bls_bls12-381_g2"),n(26,z=Q==="custom"),Ve("A"),Ve("B"),Ce()},oe=M=>{c=M.detail,s=c.ProjectivePoint,Ve("A"),Ve("B"),Ce()},ie=M=>{const Q=s.fromAffine(M);try{Q.assertValidity()}catch(le){if(le.message!=="bad point: ZERO")throw le}return Q},me=()=>U?{x:{c0:BigInt(E),c1:BigInt(w)},y:{c0:BigInt(v),c1:BigInt(A)}}:{x:BigInt(d),y:BigInt(m)},he=()=>U?{x:{c0:BigInt(Z),c1:BigInt(T)},y:{c0:BigInt(H),c1:BigInt(j)}}:{x:BigInt(_),y:BigInt(y)},xe=()=>{let M,Q;n(20,k=n(21,C=""));try{const le=me();M=ie(le)}catch(le){n(20,k=Tt(le))}try{const le=he();Q=ie(le)}catch(le){n(21,C=Tt(le))}return[M,Q]},ge=()=>{const[M,Q]=xe();if(!(!M||!Q)){n(19,I="");try{const le=M.add(Q);kt(le)}catch(le){n(19,I=Tt(le))}}},fe=()=>{const[M,Q]=xe();if(!(!M||!Q)){n(19,I="");try{const le=M.subtract(Q);kt(le)}catch(le){n(19,I=Tt(le))}}},ve=()=>{if(!L){n(19,I="");try{const M=me(),Q=ie(M),le=BigInt(q?`0x${R}`:R),Ae=Q.multiply(le);kt(Ae)}catch(M){n(19,I=Tt(M))}}},$e=M=>{const{field:Q,value:le}=M.detail;Q==="a_x"&&n(0,d=le),Q==="a_y"&&n(1,m=le),Q==="b_x"&&n(2,_=le),Q==="b_y"&&n(3,y=le),Q==="a_x_c0"&&n(6,E=le),Q==="a_x_c1"&&n(7,w=le),Q==="a_y_c0"&&n(8,v=le),Q==="a_y_c1"&&n(9,A=le),Q==="b_x_c0"&&n(10,Z=le),Q==="b_x_c1"&&n(11,T=le),Q==="b_y_c0"&&n(12,H=le),Q==="b_y_c1"&&n(13,j=le)},lt=M=>{n(18,R=M.target.value),it()},pt=M=>{q=M.target.checked,it()},it=()=>{if(q){if(Rf(R)){n(22,L=oa);return}}else if(!Tn(R)){n(22,L=ca);return}n(22,L="")},mt=(M,Q)=>{const le=M.toAffine();if(U){const[Ae,St,In,Zr]=[le.x.c0,le.x.c1,le.y.c0,le.y.c1].map(Yc=>De(Yc));Q==="A"?n(6,[E,w,v,A]=[Ae,St,In,Zr],E,n(7,w),n(8,v),n(9,A)):n(10,[Z,T,H,j]=[Ae,St,In,Zr],Z,n(11,T),n(12,H),n(13,j))}else{const[Ae,St]=[le.x,le.y].map(In=>De(In));Q==="A"?n(0,[d,m]=[Ae,St],d,n(1,m)):Q==="B"&&n(2,[_,y]=[Ae,St],_,n(3,y))}},kt=M=>{const Q=M.toAffine();U?n(14,[O,N,D,G]=[Q.x.c0,Q.x.c1,Q.y.c0,Q.y.c1].map(le=>De(le)),O,n(15,N),n(16,D),n(17,G)):n(4,[x,S]=[Q.x,Q.y].map(le=>De(le)),x,n(5,S))},ze=M=>{mt(s.BASE,M)},Be=M=>{mt(s.ZERO,M)},Ve=M=>{const Q=c.utils.randomPrivateKey(),le=s.fromPrivateKey(Q);mt(le,M)},Ce=()=>{n(4,x=n(5,S=n(14,O=n(15,N=n(16,D=n(17,G=""))))))};return[d,m,_,y,x,S,E,w,v,A,Z,T,H,j,O,N,D,G,R,I,k,C,L,U,W,$,z,ne,oe,$e,lt,pt,ze,Be,Ve,M=>{V=M.target.value,n(24,W=V==="multiply"),n(25,$=!W),n(20,k=n(21,C=n(22,L="")))},()=>{V==="add"?ge():V==="subtract"?fe():V==="multiply"&&ve()},()=>ze("A"),()=>Be("A"),()=>Ve("A"),()=>ze("B"),()=>Be("B"),()=>Ve("B")]}class la extends Ge{constructor(e){super(),Me(this,e,fa,sa,qe,{},null,[-1,-1,-1])}}function Ws(t,e,n){const r=t.slice();return r[8]=e[n],r}function Xs(t,e,n){const r=t.slice();return r[11]=e[n],r[13]=n,r}function $s(t){let e,n,r,s,c=t[11]+"",o,i,l;return{c(){e=u("div"),n=u("input"),r=P(),s=u("label"),o=X(c),g(n,"type","radio"),g(n,"name","curve"),n.value=t[11],g(n,"id",`${t[8].type}_${t[11]}`),n.checked=t[8].type=="ECDSA"&&t[13]==0,g(s,"for",`${t[8].type}_${t[11]}`),g(e,"class","ecc-radio")},m(a,b){F(a,e,b),f(e,n),f(e,r),f(e,s),f(s,o),i||(l=ke(n,"change",t[5]),i=!0)},p:_e,d(a){a&&Y(e),i=!1,l()}}}function ia(t){let e,n,r,s,c,o;return{c(){e=u("div"),n=u("input"),r=P(),s=u("label"),s.textContent="create curve",g(n,"type","radio"),g(n,"name","curve"),n.value="custom",g(n,"id","custom"),g(s,"for","custom"),g(e,"class","ecc-radio")},m(i,l){F(i,e,l),f(e,n),f(e,r),f(e,s),c||(o=ke(n,"change",t[5]),c=!0)},p:_e,d(i){i&&Y(e),c=!1,o()}}}function Qs(t){let e,n,r=t[8].type+"",s,c,o,i,l,a=t[8].list,b=[];for(let p=0;p<a.length;p+=1)b[p]=$s(Xs(t,a,p));let h=t[8].type==="ECDSA"&&ia(t);return{c(){e=u("div"),n=u("div"),s=X(r),c=P(),o=u("div");for(let p=0;p<b.length;p+=1)b[p].c();i=P(),h&&h.c(),l=P(),g(n,"class","curves-list__title"),g(e,"class","curves-list")},m(p,d){F(p,e,d),f(e,n),f(n,s),f(e,c),f(e,o);for(let m=0;m<b.length;m+=1)b[m].m(o,null);f(o,i),h&&h.m(o,null),f(e,l)},p(p,d){if(d&32){a=p[8].list;let m;for(m=0;m<a.length;m+=1){const _=Xs(p,a,m);b[m]?b[m].p(_,d):(b[m]=$s(_),b[m].c(),b[m].m(o,i))}for(;m<b.length;m+=1)b[m].d(1);b.length=a.length}p[8].type==="ECDSA"&&h.p(p,d)},d(p){p&&Y(e),bt(b,p),h&&h.d()}}}function Js(t){let e,n;return e=new Vc({props:{demo:1}}),e.$on("showData",t[6]),{c(){be(e.$$.fragment)},m(r,s){ue(e,r,s),n=!0},p:_e,i(r){n||(J(e.$$.fragment,r),n=!0)},o(r){se(e.$$.fragment,r),n=!1},d(r){de(e,r)}}}function aa(t){let e,n;return e=new qi({props:{CURVE:t[1],privKey:t[4]}}),{c(){be(e.$$.fragment)},m(r,s){ue(e,r,s),n=!0},p(r,s){const c={};s&2&&(c.CURVE=r[1]),s&16&&(c.privKey=r[4]),e.$set(c)},i(r){n||(J(e.$$.fragment,r),n=!0)},o(r){se(e.$$.fragment,r),n=!1},d(r){de(e,r)}}}function ua(t){let e,n;return e=new Pi({props:{privKey:t[4]}}),{c(){be(e.$$.fragment)},m(r,s){ue(e,r,s),n=!0},p(r,s){const c={};s&16&&(c.privKey=r[4]),e.$set(c)},i(r){n||(J(e.$$.fragment,r),n=!0)},o(r){se(e.$$.fragment,r),n=!1},d(r){de(e,r)}}}function da(t){let e,n;return e=new li({props:{privKey:t[4]}}),{c(){be(e.$$.fragment)},m(r,s){ue(e,r,s),n=!0},p(r,s){const c={};s&16&&(c.privKey=r[4]),e.$set(c)},i(r){n||(J(e.$$.fragment,r),n=!0)},o(r){se(e.$$.fragment,r),n=!1},d(r){de(e,r)}}}function ba(t){let e,n;return e=new Ql({props:{privKey:t[4]}}),{c(){be(e.$$.fragment)},m(r,s){ue(e,r,s),n=!0},p(r,s){const c={};s&16&&(c.privKey=r[4]),e.$set(c)},i(r){n||(J(e.$$.fragment,r),n=!0)},o(r){se(e.$$.fragment,r),n=!1},d(r){de(e,r)}}}function ha(t){let e,n;return e=new Al({props:{privKey:t[4]}}),{c(){be(e.$$.fragment)},m(r,s){ue(e,r,s),n=!0},p(r,s){const c={};s&16&&(c.privKey=r[4]),e.$set(c)},i(r){n||(J(e.$$.fragment,r),n=!0)},o(r){se(e.$$.fragment,r),n=!1},d(r){de(e,r)}}}function pa(t){let e,n;return e=new Bl({props:{privKey:t[4]}}),{c(){be(e.$$.fragment)},m(r,s){ue(e,r,s),n=!0},p(r,s){const c={};s&16&&(c.privKey=r[4]),e.$set(c)},i(r){n||(J(e.$$.fragment,r),n=!0)},o(r){se(e.$$.fragment,r),n=!1},d(r){de(e,r)}}}function ma(t){let e,n;return e=new pl({props:{privKey:t[4]}}),{c(){be(e.$$.fragment)},m(r,s){ue(e,r,s),n=!0},p(r,s){const c={};s&16&&(c.privKey=r[4]),e.$set(c)},i(r){n||(J(e.$$.fragment,r),n=!0)},o(r){se(e.$$.fragment,r),n=!1},d(r){de(e,r)}}}function _a(t){let e,n;return e=new tl({props:{privKey:t[4]}}),{c(){be(e.$$.fragment)},m(r,s){ue(e,r,s),n=!0},p(r,s){const c={};s&16&&(c.privKey=r[4]),e.$set(c)},i(r){n||(J(e.$$.fragment,r),n=!0)},o(r){se(e.$$.fragment,r),n=!1},d(r){de(e,r)}}}function ga(t){let e,n;return e=new zf({props:{privKey:t[4]}}),{c(){be(e.$$.fragment)},m(r,s){ue(e,r,s),n=!0},p(r,s){const c={};s&16&&(c.privKey=r[4]),e.$set(c)},i(r){n||(J(e.$$.fragment,r),n=!0)},o(r){se(e.$$.fragment,r),n=!1},d(r){de(e,r)}}}function ya(t){let e,n,r,s,c,o,i,l,a,b;e=new Gi({props:{curve:t[3],keyLength:t[2]}});let h=Un,p=[];for(let x=0;x<h.length;x+=1)p[x]=Qs(Ws(t,h,x));let d=t[0]&&Js(t);const m=[ga,_a,ma,pa,ha,ba,da,ua,aa],_=[];function y(x,S){return x[3]=="ecdsa_secp256k1"?0:x[3]=="ecdsa_p256"?1:x[3]=="ecdsa_p384"?2:x[3]=="ecdsa_p521"?3:x[3]=="schnorr_secp256k1"?4:x[3]=="eddsa_ed25519"?5:x[3]=="eddsa_ed448"?6:x[3]=="bls_bls12-381"?7:x[3]=="custom"?8:-1}return~(o=y(t))&&(i=_[o]=m[o](t)),a=new la({}),{c(){be(e.$$.fragment),n=P(),r=u("div");for(let x=0;x<p.length;x+=1)p[x].c();s=P(),d&&d.c(),c=P(),i&&i.c(),l=P(),be(a.$$.fragment),g(r,"class","curves-list-container")},m(x,S){ue(e,x,S),F(x,n,S),F(x,r,S);for(let E=0;E<p.length;E+=1)p[E].m(r,null);F(x,s,S),d&&d.m(x,S),F(x,c,S),~o&&_[o].m(x,S),F(x,l,S),ue(a,x,S),b=!0},p(x,[S]){const E={};if(S&8&&(E.curve=x[3]),S&4&&(E.keyLength=x[2]),e.$set(E),S&32){h=Un;let v;for(v=0;v<h.length;v+=1){const A=Ws(x,h,v);p[v]?p[v].p(A,S):(p[v]=Qs(A),p[v].c(),p[v].m(r,null))}for(;v<p.length;v+=1)p[v].d(1);p.length=h.length}x[0]?d?(d.p(x,S),S&1&&J(d,1)):(d=Js(x),d.c(),J(d,1),d.m(c.parentNode,c)):d&&(We(),se(d,1,1,()=>{d=null}),Xe());let w=o;o=y(x),o===w?~o&&_[o].p(x,S):(i&&(We(),se(_[w],1,1,()=>{_[w]=null}),Xe()),~o?(i=_[o],i?i.p(x,S):(i=_[o]=m[o](x),i.c()),J(i,1),i.m(l.parentNode,l)):i=null)},i(x){b||(J(e.$$.fragment,x),J(d),J(i),J(a.$$.fragment,x),b=!0)},o(x){se(e.$$.fragment,x),se(d),se(i),se(a.$$.fragment,x),b=!1},d(x){de(e,x),x&&Y(n),x&&Y(r),bt(p,x),x&&Y(s),d&&d.d(x),x&&Y(c),~o&&_[o].d(x),x&&Y(l),de(a,x)}}}function xa(t,e,n){let r,s;Se(t,ut,h=>n(4,r=h)),Se(t,nt,h=>n(7,s=h)),Le(ut,r=An,r),Le(nt,s="greetings from noble",s);let c=!1,o=Lt,i=An.length,l="ecdsa_secp256k1";return[c,o,i,l,r,h=>{n(3,l=h.target.id.toLowerCase()),l==="ecdsa_p384"?Le(ut,r=Hf,r):l==="ecdsa_p521"?Le(ut,r=Nf,r):l==="eddsa_ed448"?Le(ut,r=Tf,r):Le(ut,r=An,r),n(2,i=r.length),n(0,c=l==="custom")},h=>{n(1,o=h.detail),n(3,l="custom"),Le(ut,r=An,r),n(2,i=r.length)}]}class va extends Ge{constructor(e){super(),Me(this,e,xa,ya,qe,{})}}new va({target:document.getElementById("app-ecc-calculator")});
