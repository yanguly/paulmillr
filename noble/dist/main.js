function ve(){}function Tc(t,e){for(const n in e)t[n]=e[n];return t}function js(t){return t()}function Nr(){return Object.create(null)}function at(t){t.forEach(js)}function Vs(t){return typeof t=="function"}function Me(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function Nc(t){return Object.keys(t).length===0}function Lc(t,...e){if(t==null)return ve;const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function Ce(t,e,n){t.$$.on_destroy.push(Lc(e,n))}function qc(t,e,n,r){if(t){const s=zs(t,e,n,r);return t[0](s)}}function zs(t,e,n,r){return t[1]&&r?Tc(n.ctx.slice(),t[1](r(e))):n.ctx}function Uc(t,e,n,r){if(t[2]&&r){const s=t[2](r(n));if(e.dirty===void 0)return s;if(typeof s=="object"){const o=[],c=Math.max(e.dirty.length,s.length);for(let l=0;l<c;l+=1)o[l]=e.dirty[l]|s[l];return o}return e.dirty|s}return e.dirty}function Mc(t,e,n,r,s,o){if(s){const c=zs(e,n,r,o);t.p(c,s)}}function Dc(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let r=0;r<n;r++)e[r]=-1;return e}return-1}function Le(t,e,n){return t.set(n),e}function f(t,e){t.appendChild(e)}function V(t,e,n){t.insertBefore(e,n||null)}function j(t){t.parentNode&&t.parentNode.removeChild(t)}function ut(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function u(t){return document.createElement(t)}function F(t){return document.createTextNode(t)}function O(){return F(" ")}function dt(){return F("")}function ke(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function g(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function Gc(t){return Array.from(t.childNodes)}function Q(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function tt(t,e){t.value=e??""}function Zc(t,e,{bubbles:n=!1,cancelable:r=!1}={}){const s=document.createEvent("CustomEvent");return s.initCustomEvent(t,n,r,e),s}let ln;function fn(t){ln=t}function Ys(){if(!ln)throw new Error("Function called outside component initialization");return ln}function Kc(t){Ys().$$.on_mount.push(t)}function pr(){const t=Ys();return(e,n,{cancelable:r=!1}={})=>{const s=t.$$.callbacks[e];if(s){const o=Zc(e,n,{cancelable:r});return s.slice().forEach(c=>{c.call(t,o)}),!o.defaultPrevented}return!0}}const $t=[],Lr=[],Sn=[],qr=[],jc=Promise.resolve();let er=!1;function Vc(){er||(er=!0,jc.then(Fs))}function tr(t){Sn.push(t)}const Zn=new Set;let Wt=0;function Fs(){if(Wt!==0)return;const t=ln;do{try{for(;Wt<$t.length;){const e=$t[Wt];Wt++,fn(e),zc(e.$$)}}catch(e){throw $t.length=0,Wt=0,e}for(fn(null),$t.length=0,Wt=0;Lr.length;)Lr.pop()();for(let e=0;e<Sn.length;e+=1){const n=Sn[e];Zn.has(n)||(Zn.add(n),n())}Sn.length=0}while($t.length);for(;qr.length;)qr.pop()();er=!1,Zn.clear(),fn(t)}function zc(t){if(t.fragment!==null){t.update(),at(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(tr)}}const In=new Set;let Gt;function lt(){Gt={r:0,c:[],p:Gt}}function it(){Gt.r||at(Gt.c),Gt=Gt.p}function ne(t,e){t&&t.i&&(In.delete(t),t.i(e))}function oe(t,e,n,r){if(t&&t.o){if(In.has(t))return;In.add(t),Gt.c.push(()=>{In.delete(t),r&&(n&&t.d(1),r())}),t.o(e)}else r&&r()}function ge(t){t&&t.c()}function pe(t,e,n,r){const{fragment:s,after_update:o}=t.$$;s&&s.m(e,n),r||tr(()=>{const c=t.$$.on_mount.map(js).filter(Vs);t.$$.on_destroy?t.$$.on_destroy.push(...c):at(c),t.$$.on_mount=[]}),o.forEach(tr)}function _e(t,e){const n=t.$$;n.fragment!==null&&(at(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Yc(t,e){t.$$.dirty[0]===-1&&($t.push(t),Vc(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Ge(t,e,n,r,s,o,c,l=[-1]){const i=ln;fn(t);const a=t.$$={fragment:null,ctx:[],props:o,update:ve,not_equal:s,bound:Nr(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(i?i.$$.context:[])),callbacks:Nr(),dirty:l,skip_bound:!1,root:e.target||i.$$.root};c&&c(a.root);let b=!1;if(a.ctx=n?n(t,e.props||{},(p,h,...d)=>{const _=d.length?d[0]:h;return a.ctx&&s(a.ctx[p],a.ctx[p]=_)&&(!a.skip_bound&&a.bound[p]&&a.bound[p](_),b&&Yc(t,p)),h}):[],a.update(),b=!0,at(a.before_update),a.fragment=r?r(a.ctx):!1,e.target){if(e.hydrate){const p=Gc(e.target);a.fragment&&a.fragment.l(p),p.forEach(j)}else a.fragment&&a.fragment.c();e.intro&&ne(t.$$.fragment),pe(t,e.target,e.anchor,e.customElement),Fs()}fn(i)}class Ze{$destroy(){_e(this,1),this.$destroy=ve}$on(e,n){if(!Vs(n))return ve;const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(n),()=>{const s=r.indexOf(n);s!==-1&&r.splice(s,1)}}$set(e){this.$$set&&!Nc(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function nr(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function Fc(t){if(typeof t!="boolean")throw new Error(`Expected boolean, not ${t}`)}function Ws(t,...e){if(!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new TypeError(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function Wc(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");nr(t.outputLen),nr(t.blockLen)}function Xc(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function $c(t,e){Ws(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const Fe={number:nr,bool:Fc,bytes:Ws,hash:Wc,exists:Xc,output:$c},Ur={node:void 0,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0};/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Qc=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),Kn=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),ot=(t,e)=>t<<32-e|t>>>e,Jc=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Jc)throw new Error("Non little-endian hardware is not supported");const eo=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Ke(t){if(!(t instanceof Uint8Array))throw new Error("Uint8Array expected");let e="";for(let n=0;n<t.length;n++)e+=eo[t[n]];return e}function en(t){if(typeof t!="string")throw new TypeError(`utf8ToBytes expected string, got ${typeof t}`);return new TextEncoder().encode(t)}function mn(t){if(typeof t=="string"&&(t=en(t)),!(t instanceof Uint8Array))throw new TypeError(`Expected input type is Uint8Array (got ${typeof t})`);return t}function _r(...t){if(!t.every(r=>r instanceof Uint8Array))throw new Error("Uint8Array list expected");if(t.length===1)return t[0];const e=t.reduce((r,s)=>r+s.length,0),n=new Uint8Array(e);for(let r=0,s=0;r<t.length;r++){const o=t[r];n.set(o,s),s+=o.length}return n}class mr{clone(){return this._cloneInto()}}function vt(t){const e=r=>t().update(mn(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function to(t){const e=(r,s)=>t(s).update(mn(r)).digest(),n=t({});return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=r=>t(r),e}function Lt(t=32){if(Ur.web)return Ur.web.getRandomValues(new Uint8Array(t));throw new Error("The environment doesn't have randomBytes function")}function no(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const s=BigInt(32),o=BigInt(4294967295),c=Number(n>>s&o),l=Number(n&o),i=r?4:0,a=r?0:4;t.setUint32(e+i,c,r),t.setUint32(e+a,l,r)}class Xs extends mr{constructor(e,n,r,s){super(),this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Kn(this.buffer)}update(e){Fe.exists(this);const{view:n,buffer:r,blockLen:s}=this;e=mn(e);const o=e.length;for(let c=0;c<o;){const l=Math.min(s-this.pos,o-c);if(l===s){const i=Kn(e);for(;s<=o-c;c+=s)this.process(i,c);continue}r.set(e.subarray(c,c+l),this.pos),this.pos+=l,c+=l,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Fe.exists(this),Fe.output(e,this),this.finished=!0;const{buffer:n,view:r,blockLen:s,isLE:o}=this;let{pos:c}=this;n[c++]=128,this.buffer.subarray(c).fill(0),this.padOffset>s-c&&(this.process(r,0),c=0);for(let p=c;p<s;p++)n[p]=0;no(r,s-8,BigInt(this.length*8),o),this.process(r,0);const l=Kn(e),i=this.outputLen;if(i%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const a=i/4,b=this.get();if(a>b.length)throw new Error("_sha2: outputLen bigger than state");for(let p=0;p<a;p++)l.setUint32(4*p,b[p],o)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:r,length:s,finished:o,destroyed:c,pos:l}=this;return e.length=s,e.pos=l,e.finished=o,e.destroyed=c,s%n&&e.buffer.set(r),e}}const ro=(t,e,n)=>t&e^~t&n,so=(t,e,n)=>t&e^t&n^e&n,co=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Bt=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),kt=new Uint32Array(64);class $s extends Xs{constructor(){super(64,32,8,!1),this.A=Bt[0]|0,this.B=Bt[1]|0,this.C=Bt[2]|0,this.D=Bt[3]|0,this.E=Bt[4]|0,this.F=Bt[5]|0,this.G=Bt[6]|0,this.H=Bt[7]|0}get(){const{A:e,B:n,C:r,D:s,E:o,F:c,G:l,H:i}=this;return[e,n,r,s,o,c,l,i]}set(e,n,r,s,o,c,l,i){this.A=e|0,this.B=n|0,this.C=r|0,this.D=s|0,this.E=o|0,this.F=c|0,this.G=l|0,this.H=i|0}process(e,n){for(let p=0;p<16;p++,n+=4)kt[p]=e.getUint32(n,!1);for(let p=16;p<64;p++){const h=kt[p-15],d=kt[p-2],_=ot(h,7)^ot(h,18)^h>>>3,m=ot(d,17)^ot(d,19)^d>>>10;kt[p]=m+kt[p-7]+_+kt[p-16]|0}let{A:r,B:s,C:o,D:c,E:l,F:i,G:a,H:b}=this;for(let p=0;p<64;p++){const h=ot(l,6)^ot(l,11)^ot(l,25),d=b+h+ro(l,i,a)+co[p]+kt[p]|0,m=(ot(r,2)^ot(r,13)^ot(r,22))+so(r,s,o)|0;b=a,a=i,i=l,l=c+d|0,c=o,o=s,s=r,r=d+m|0}r=r+this.A|0,s=s+this.B|0,o=o+this.C|0,c=c+this.D|0,l=l+this.E|0,i=i+this.F|0,a=a+this.G|0,b=b+this.H|0,this.set(r,s,o,c,l,i,a,b)}roundClean(){kt.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class oo extends $s{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}const We=vt(()=>new $s);vt(()=>new oo);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const fo=BigInt(0),gr=BigInt(1),lo=BigInt(2),Tn=t=>t instanceof Uint8Array,io=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Ht(t){if(!Tn(t))throw new Error("Uint8Array expected");let e="";for(let n=0;n<t.length;n++)e+=io[t[n]];return e}function Qs(t){const e=t.toString(16);return e.length&1?`0${e}`:e}function yr(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return BigInt(t===""?"0":`0x${t}`)}function Jt(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);if(t.length%2)throw new Error("hex string is invalid: unpadded "+t.length);const e=new Uint8Array(t.length/2);for(let n=0;n<e.length;n++){const r=n*2,s=t.slice(r,r+2),o=Number.parseInt(s,16);if(Number.isNaN(o)||o<0)throw new Error("invalid byte sequence");e[n]=o}return e}function He(t){return yr(Ht(t))}function xt(t){if(!Tn(t))throw new Error("Uint8Array expected");return yr(Ht(Uint8Array.from(t).reverse()))}const Pe=(t,e)=>Jt(t.toString(16).padStart(e*2,"0")),zt=(t,e)=>Pe(t,e).reverse(),ao=t=>Jt(Qs(t));function Ee(t,e,n){let r;if(typeof e=="string")try{r=Jt(e)}catch(o){throw new Error(`${t} must be valid hex string, got "${e}". Cause: ${o}`)}else if(Tn(e))r=Uint8Array.from(e);else throw new Error(`${t} must be hex string or Uint8Array`);const s=r.length;if(typeof n=="number"&&s!==n)throw new Error(`${t} expected ${n} bytes, got ${s}`);return r}function Ie(...t){const e=new Uint8Array(t.reduce((r,s)=>r+s.length,0));let n=0;return t.forEach(r=>{if(!Tn(r))throw new Error("Uint8Array expected");e.set(r,n),n+=r.length}),e}function Js(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function Nn(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new TextEncoder().encode(t)}function Qt(t){let e;for(e=0;t>0n;t>>=gr,e+=1);return e}const Pt=(t,e)=>t>>BigInt(e)&1n,mt=(t,e,n)=>t|(n?gr:fo)<<BigInt(e),tn=t=>(lo<<BigInt(t-1))-gr,jn=t=>new Uint8Array(t),Mr=t=>Uint8Array.from(t);function ec(t,e,n){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof n!="function")throw new Error("hmacFn must be a function");let r=jn(t),s=jn(t),o=0;const c=()=>{r.fill(1),s.fill(0),o=0},l=(...p)=>n(s,r,...p),i=(p=jn())=>{s=l(Mr([0]),p),r=l(),p.length!==0&&(s=l(Mr([1]),p),r=l())},a=()=>{if(o++>=1e3)throw new Error("drbg: tried 1000 values");let p=0;const h=[];for(;p<e;){r=l();const d=r.slice();h.push(d),p+=r.length}return Ie(...h)};return(p,h)=>{c(),i(p);let d;for(;!(d=h(a()));)i();return c(),d}}const uo={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function qt(t,e,n={}){const r=(s,o,c)=>{const l=uo[o];if(typeof l!="function")throw new Error(`Invalid validator "${o}", expected function`);const i=t[s];if(!(c&&i===void 0)&&!l(i,t))throw new Error(`Invalid param ${String(s)}=${i} (${typeof i}), expected ${o}`)};for(const[s,o]of Object.entries(e))r(s,o,!1);for(const[s,o]of Object.entries(n))r(s,o,!0);return t}const bo=Object.freeze(Object.defineProperty({__proto__:null,bitGet:Pt,bitLen:Qt,bitMask:tn,bitSet:mt,bytesToHex:Ht,bytesToNumberBE:He,bytesToNumberLE:xt,concatBytes:Ie,createHmacDrbg:ec,ensureBytes:Ee,equalBytes:Js,hexToBytes:Jt,hexToNumber:yr,numberToBytesBE:Pe,numberToBytesLE:zt,numberToHexUnpadded:Qs,numberToVarBytesBE:ao,utf8ToBytes:Nn,validateObject:qt},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const qe=BigInt(0),Oe=BigInt(1),Mt=BigInt(2),ho=BigInt(3),rr=BigInt(4),Dr=BigInt(5),Gr=BigInt(8);BigInt(9);BigInt(16);function ye(t,e){const n=t%e;return n>=qe?n:e+n}function tc(t,e,n){if(n<=qe||e<qe)throw new Error("Expected power/modulo > 0");if(n===Oe)return qe;let r=Oe;for(;e>qe;)e&Oe&&(r=r*t%n),t=t*t%n,e>>=Oe;return r}function we(t,e,n){let r=t;for(;e-- >qe;)r*=r,r%=n;return r}function sr(t,e){if(t===qe||e<=qe)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let n=ye(t,e),r=e,s=qe,o=Oe;for(;n!==qe;){const l=r/n,i=r%n,a=s-o*l;r=n,n=i,s=o,o=a}if(r!==Oe)throw new Error("invert: does not exist");return ye(s,e)}function po(t){const e=(t-Oe)/Mt;let n,r,s;for(n=t-Oe,r=0;n%Mt===qe;n/=Mt,r++);for(s=Mt;s<t&&tc(s,e,t)!==t-Oe;s++);if(r===1){const c=(t+Oe)/rr;return function(i,a){const b=i.pow(a,c);if(!i.eql(i.sqr(b),a))throw new Error("Cannot find square root");return b}}const o=(n+Oe)/Mt;return function(l,i){if(l.pow(i,e)===l.neg(l.ONE))throw new Error("Cannot find square root");let a=r,b=l.pow(l.mul(l.ONE,s),n),p=l.pow(i,o),h=l.pow(i,n);for(;!l.eql(h,l.ONE);){if(l.eql(h,l.ZERO))return l.ZERO;let d=1;for(let m=l.sqr(h);d<a&&!l.eql(m,l.ONE);d++)m=l.sqr(m);const _=l.pow(b,Oe<<BigInt(a-d-1));b=l.sqr(_),p=l.mul(p,_),h=l.mul(h,b),a=d}return p}}function _o(t){if(t%rr===ho){const e=(t+Oe)/rr;return function(r,s){const o=r.pow(s,e);if(!r.eql(r.sqr(o),s))throw new Error("Cannot find square root");return o}}if(t%Gr===Dr){const e=(t-Dr)/Gr;return function(r,s){const o=r.mul(s,Mt),c=r.pow(o,e),l=r.mul(s,c),i=r.mul(r.mul(l,Mt),c),a=r.mul(l,r.sub(i,r.ONE));if(!r.eql(r.sqr(a),s))throw new Error("Cannot find square root");return a}}return po(t)}const At=(t,e)=>(ye(t,e)&Oe)===Oe,mo=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function nc(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},n=mo.reduce((r,s)=>(r[s]="function",r),e);return qt(t,n)}function Ln(t,e,n){if(n<qe)throw new Error("Expected power > 0");if(n===qe)return t.ONE;if(n===Oe)return e;let r=t.ONE,s=e;for(;n>qe;)n&Oe&&(r=t.mul(r,s)),s=t.sqr(s),n>>=1n;return r}function qn(t,e){const n=new Array(e.length),r=e.reduce((o,c,l)=>t.is0(c)?o:(n[l]=o,t.mul(o,c)),t.ONE),s=t.inv(r);return e.reduceRight((o,c,l)=>t.is0(c)?o:(n[l]=t.mul(o,n[l]),t.mul(o,c)),s),n}function xr(t,e){const n=e!==void 0?e:t.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function wt(t,e,n=!1,r={}){if(t<=qe)throw new Error(`Expected Fp ORDER > 0, got ${t}`);const{nBitLength:s,nByteLength:o}=xr(t,e);if(o>2048)throw new Error("Field lengths over 2048 bytes are not supported");const c=_o(t),l=Object.freeze({ORDER:t,BITS:s,BYTES:o,MASK:tn(s),ZERO:qe,ONE:Oe,create:i=>ye(i,t),isValid:i=>{if(typeof i!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof i}`);return qe<=i&&i<t},is0:i=>i===qe,isOdd:i=>(i&Oe)===Oe,neg:i=>ye(-i,t),eql:(i,a)=>i===a,sqr:i=>ye(i*i,t),add:(i,a)=>ye(i+a,t),sub:(i,a)=>ye(i-a,t),mul:(i,a)=>ye(i*a,t),pow:(i,a)=>Ln(l,i,a),div:(i,a)=>ye(i*sr(a,t),t),sqrN:i=>i*i,addN:(i,a)=>i+a,subN:(i,a)=>i-a,mulN:(i,a)=>i*a,inv:i=>sr(i,t),sqrt:r.sqrt||(i=>c(l,i)),invertBatch:i=>qn(l,i),cmov:(i,a,b)=>b?a:i,toBytes:i=>n?zt(i,o):Pe(i,o),fromBytes:i=>{if(i.length!==o)throw new Error(`Fp.fromBytes: expected ${o}, got ${i.length}`);return n?xt(i):He(i)}});return Object.freeze(l)}function go(t,e){if(!t.isOdd)throw new Error("Field doesn't have isOdd");const n=t.sqrt(e);return t.isOdd(n)?t.neg(n):n}function rc(t,e,n=!1){t=Ee("privateHash",t);const r=t.length,s=xr(e).nByteLength+8;if(s<24||r<s||r>1024)throw new Error(`hashToPrivateScalar: expected ${s}-1024 bytes of input, got ${r}`);const o=n?xt(t):He(t);return ye(o,e-Oe)+Oe}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const yo=BigInt(0),Vn=BigInt(1);function sc(t,e){const n=(s,o)=>{const c=o.negate();return s?c:o},r=s=>{const o=Math.ceil(e/s)+1,c=2**(s-1);return{windows:o,windowSize:c}};return{constTimeNegate:n,unsafeLadder(s,o){let c=t.ZERO,l=s;for(;o>yo;)o&Vn&&(c=c.add(l)),l=l.double(),o>>=Vn;return c},precomputeWindow(s,o){const{windows:c,windowSize:l}=r(o),i=[];let a=s,b=a;for(let p=0;p<c;p++){b=a,i.push(b);for(let h=1;h<l;h++)b=b.add(a),i.push(b);a=b.double()}return i},wNAF(s,o,c){const{windows:l,windowSize:i}=r(s);let a=t.ZERO,b=t.BASE;const p=BigInt(2**s-1),h=2**s,d=BigInt(s);for(let _=0;_<l;_++){const m=_*i;let y=Number(c&p);c>>=d,y>i&&(y-=h,c+=Vn);const x=m,S=m+Math.abs(y)-1,k=_%2!==0,w=y<0;y===0?b=b.add(n(k,o[x])):a=a.add(n(w,o[S]))}return{p:a,f:b}},wNAFCached(s,o,c,l){const i=s._WINDOW_SIZE||1;let a=o.get(s);return a||(a=this.precomputeWindow(s,i),i!==1&&o.set(s,l(a))),this.wNAF(i,a,c)}}}function vr(t){return nc(t.Fp),qt(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...xr(t.n,t.nBitLength),...t})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function xo(t){const e=vr(t);qt(e,{a:"field",b:"field",fromBytes:"function",toBytes:"function"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean"});const{endo:n,Fp:r,a:s}=e;if(n){if(!r.eql(s,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof n!="object"||typeof n.beta!="bigint"||typeof n.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}const{bytesToNumberBE:vo,hexToBytes:wo}=bo,Zt={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(t){const{Err:e}=Zt;if(t.length<2||t[0]!==2)throw new e("Invalid signature integer tag");const n=t[1],r=t.subarray(2,n+2);if(!n||r.length!==n)throw new e("Invalid signature integer: wrong length");if(r[0]===0&&r[1]<=127)throw new e("Invalid signature integer: trailing length");return{d:vo(r),l:t.subarray(n+2)}},toSig(t){const{Err:e}=Zt,n=typeof t=="string"?wo(t):t;if(!(n instanceof Uint8Array))throw new Error("ui8a expected");let r=n.length;if(r<2||n[0]!=48)throw new e("Invalid signature tag");if(n[1]!==r-2)throw new e("Invalid signature: incorrect length");const{d:s,l:o}=Zt._parseInt(n.subarray(2)),{d:c,l}=Zt._parseInt(o);if(l.length)throw new e("Invalid signature: left bytes after parsing");return{r:s,s:c}},hexFromSig(t){const e=a=>Number.parseInt(a[0],16)>=8?"00"+a:a,n=a=>{const b=a.toString(16);return b.length&1?`0${b}`:b},r=e(n(t.s)),s=e(n(t.r)),o=r.length/2,c=s.length/2,l=n(o),i=n(c);return`30${n(c+o+4)}02${i}${s}02${l}${r}`}},gt=BigInt(0),nt=BigInt(1);function cr(t){const e=xo(t),{Fp:n}=e;function r(h){const{a:d,b:_}=e,m=n.sqr(h),y=n.mul(m,h);return n.add(n.add(y,n.mul(h,d)),_)}function s(h){return typeof h=="bigint"&&gt<h&&h<e.n}function o(h){if(!s(h))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(h){const{allowedPrivateKeyLengths:d,nByteLength:_,wrapPrivateKey:m,n:y}=e;if(d&&typeof h!="bigint"){if(h instanceof Uint8Array&&(h=Ht(h)),typeof h!="string"||!d.includes(h.length))throw new Error("Invalid key");h=h.padStart(_*2,"0")}let x;try{x=typeof h=="bigint"?h:He(Ee("private key",h,_))}catch{throw new Error(`private key must be ${_} bytes, hex or bigint, not ${typeof h}`)}return m&&(x=ye(x,y)),o(x),x}const l=new Map;function i(h){if(!(h instanceof a))throw new Error("ProjectivePoint expected")}class a{constructor(d,_,m){if(this.px=d,this.py=_,this.pz=m,d==null||!n.isValid(d))throw new Error("x required");if(_==null||!n.isValid(_))throw new Error("y required");if(m==null||!n.isValid(m))throw new Error("z required")}static fromAffine(d){const{x:_,y:m}=d||{};if(!d||!n.isValid(_)||!n.isValid(m))throw new Error("invalid affine point");if(d instanceof a)throw new Error("projective point not allowed");const y=x=>n.eql(x,n.ZERO);return y(_)&&y(m)?a.ZERO:new a(_,m,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(d){const _=n.invertBatch(d.map(m=>m.pz));return d.map((m,y)=>m.toAffine(_[y])).map(a.fromAffine)}static fromHex(d){const _=a.fromAffine(e.fromBytes(Ee("pointHex",d)));return _.assertValidity(),_}static fromPrivateKey(d){return a.BASE.multiply(c(d))}_setWindowSize(d){this._WINDOW_SIZE=d,l.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint)return;throw new Error("bad point: ZERO")}const{x:d,y:_}=this.toAffine();if(!n.isValid(d)||!n.isValid(_))throw new Error("bad point: x or y not FE");const m=n.sqr(_),y=r(d);if(!n.eql(m,y))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:d}=this.toAffine();if(n.isOdd)return!n.isOdd(d);throw new Error("Field doesn't support isOdd")}equals(d){i(d);const{px:_,py:m,pz:y}=this,{px:x,py:S,pz:k}=d,w=n.eql(n.mul(_,k),n.mul(x,y)),v=n.eql(n.mul(m,k),n.mul(S,y));return w&&v}negate(){return new a(this.px,n.neg(this.py),this.pz)}double(){const{a:d,b:_}=e,m=n.mul(_,3n),{px:y,py:x,pz:S}=this;let k=n.ZERO,w=n.ZERO,v=n.ZERO,A=n.mul(y,y),G=n.mul(x,x),T=n.mul(S,S),H=n.mul(y,x);return H=n.add(H,H),v=n.mul(y,S),v=n.add(v,v),k=n.mul(d,v),w=n.mul(m,T),w=n.add(k,w),k=n.sub(G,w),w=n.add(G,w),w=n.mul(k,w),k=n.mul(H,k),v=n.mul(m,v),T=n.mul(d,T),H=n.sub(A,T),H=n.mul(d,H),H=n.add(H,v),v=n.add(A,A),A=n.add(v,A),A=n.add(A,T),A=n.mul(A,H),w=n.add(w,A),T=n.mul(x,S),T=n.add(T,T),A=n.mul(T,H),k=n.sub(k,A),v=n.mul(T,G),v=n.add(v,v),v=n.add(v,v),new a(k,w,v)}add(d){i(d);const{px:_,py:m,pz:y}=this,{px:x,py:S,pz:k}=d;let w=n.ZERO,v=n.ZERO,A=n.ZERO;const G=e.a,T=n.mul(e.b,3n);let H=n.mul(_,x),D=n.mul(m,S),R=n.mul(y,k),N=n.add(_,m),Z=n.add(x,S);N=n.mul(N,Z),Z=n.add(H,D),N=n.sub(N,Z),Z=n.add(_,y);let M=n.add(x,k);return Z=n.mul(Z,M),M=n.add(H,R),Z=n.sub(Z,M),M=n.add(m,y),w=n.add(S,k),M=n.mul(M,w),w=n.add(D,R),M=n.sub(M,w),A=n.mul(G,Z),w=n.mul(T,R),A=n.add(w,A),w=n.sub(D,A),A=n.add(D,A),v=n.mul(w,A),D=n.add(H,H),D=n.add(D,H),R=n.mul(G,R),Z=n.mul(T,Z),D=n.add(D,R),R=n.sub(H,R),R=n.mul(G,R),Z=n.add(Z,R),H=n.mul(D,Z),v=n.add(v,H),H=n.mul(M,Z),w=n.mul(N,w),w=n.sub(w,H),H=n.mul(N,D),A=n.mul(M,A),A=n.add(A,H),new a(w,v,A)}subtract(d){return this.add(d.negate())}is0(){return this.equals(a.ZERO)}wNAF(d){return p.wNAFCached(this,l,d,_=>{const m=n.invertBatch(_.map(y=>y.pz));return _.map((y,x)=>y.toAffine(m[x])).map(a.fromAffine)})}multiplyUnsafe(d){const _=a.ZERO;if(d===gt)return _;if(o(d),d===nt)return this;const{endo:m}=e;if(!m)return p.unsafeLadder(this,d);let{k1neg:y,k1:x,k2neg:S,k2:k}=m.splitScalar(d),w=_,v=_,A=this;for(;x>gt||k>gt;)x&nt&&(w=w.add(A)),k&nt&&(v=v.add(A)),A=A.double(),x>>=nt,k>>=nt;return y&&(w=w.negate()),S&&(v=v.negate()),v=new a(n.mul(v.px,m.beta),v.py,v.pz),w.add(v)}multiply(d){o(d);let _=d,m,y;const{endo:x}=e;if(x){const{k1neg:S,k1:k,k2neg:w,k2:v}=x.splitScalar(_);let{p:A,f:G}=this.wNAF(k),{p:T,f:H}=this.wNAF(v);A=p.constTimeNegate(S,A),T=p.constTimeNegate(w,T),T=new a(n.mul(T.px,x.beta),T.py,T.pz),m=A.add(T),y=G.add(H)}else{const{p:S,f:k}=this.wNAF(_);m=S,y=k}return a.normalizeZ([m,y])[0]}multiplyAndAddUnsafe(d,_,m){const y=a.BASE,x=(k,w)=>w===gt||w===nt||!k.equals(y)?k.multiplyUnsafe(w):k.multiply(w),S=x(this,_).add(x(d,m));return S.is0()?void 0:S}toAffine(d){const{px:_,py:m,pz:y}=this,x=this.is0();d==null&&(d=x?n.ONE:n.inv(y));const S=n.mul(_,d),k=n.mul(m,d),w=n.mul(y,d);if(x)return{x:n.ZERO,y:n.ZERO};if(!n.eql(w,n.ONE))throw new Error("invZ was invalid");return{x:S,y:k}}isTorsionFree(){const{h:d,isTorsionFree:_}=e;if(d===nt)return!0;if(_)return _(a,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:d,clearCofactor:_}=e;return d===nt?this:_?_(a,this):this.multiplyUnsafe(e.h)}toRawBytes(d=!0){return this.assertValidity(),e.toBytes(a,this,d)}toHex(d=!0){return Ht(this.toRawBytes(d))}}a.BASE=new a(e.Gx,e.Gy,n.ONE),a.ZERO=new a(n.ZERO,n.ONE,n.ZERO);const b=e.nBitLength,p=sc(a,e.endo?Math.ceil(b/2):b);return{ProjectivePoint:a,normPrivateKeyToScalar:c,weierstrassEquation:r,isWithinCurveOrder:s}}function Eo(t){const e=vr(t);return qt(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function Bo(t){const e=Eo(t),n=e.n,r=e.Fp,s=r.BYTES+1,o=2*r.BYTES+1;function c(P){return gt<P&&P<r.ORDER}function l(P){return ye(P,n)}function i(P){return sr(P,n)}const{ProjectivePoint:a,normPrivateKeyToScalar:b,weierstrassEquation:p,isWithinCurveOrder:h}=cr({...e,toBytes(P,I,B){const C=I.toAffine(),q=r.toBytes(C.x),U=Ie;return B?U(Uint8Array.from([I.hasEvenY()?2:3]),q):U(Uint8Array.from([4]),q,r.toBytes(C.y))},fromBytes(P){const I=P.length,B=P[0],C=P.subarray(1);if(I===s&&(B===2||B===3)){const q=He(C);if(!c(q))throw new Error("Point is not on curve");const U=p(q);let z=r.sqrt(U);const X=(z&nt)===nt;return(B&1)===1!==X&&(z=r.neg(z)),{x:q,y:z}}else if(I===o&&B===4){const q=r.fromBytes(C.subarray(0,r.BYTES)),U=r.fromBytes(C.subarray(r.BYTES,2*r.BYTES));return{x:q,y:U}}else throw new Error(`Point of length ${I} was invalid. Expected ${s} compressed bytes or ${o} uncompressed bytes`)}}),d=P=>Ht(Pe(P,e.nByteLength));function _(P){const I=n>>nt;return P>I}function m(P){return _(P)?l(-P):P}const y=(P,I,B)=>He(P.slice(I,B));class x{constructor(I,B,C){this.r=I,this.s=B,this.recovery=C,this.assertValidity()}static fromCompact(I){const B=e.nByteLength;return I=Ee("compactSignature",I,B*2),new x(y(I,0,B),y(I,B,2*B))}static fromDER(I){const{r:B,s:C}=Zt.toSig(Ee("DER",I));return new x(B,C)}assertValidity(){if(!h(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!h(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(I){return new x(this.r,this.s,I)}recoverPublicKey(I){const{r:B,s:C,recovery:q}=this,U=G(Ee("msgHash",I));if(q==null||![0,1,2,3].includes(q))throw new Error("recovery id invalid");const z=q===2||q===3?B+e.n:B;if(z>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");const X=q&1?"03":"02",W=a.fromHex(X+d(z)),L=i(z),Y=l(-U*L),$=l(C*L),se=a.BASE.multiplyAndAddUnsafe(W,Y,$);if(!se)throw new Error("point at infinify");return se.assertValidity(),se}hasHighS(){return _(this.s)}normalizeS(){return this.hasHighS()?new x(this.r,l(-this.s),this.recovery):this}toDERRawBytes(){return Jt(this.toDERHex())}toDERHex(){return Zt.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Jt(this.toCompactHex())}toCompactHex(){return d(this.r)+d(this.s)}}const S={isValidPrivateKey(P){try{return b(P),!0}catch{return!1}},normPrivateKeyToScalar:b,randomPrivateKey:()=>{const P=e.randomBytes(r.BYTES+8),I=rc(P,n);return Pe(I,e.nByteLength)},precompute(P=8,I=a.BASE){return I._setWindowSize(P),I.multiply(BigInt(3)),I}};function k(P,I=!0){return a.fromPrivateKey(P).toRawBytes(I)}function w(P){const I=P instanceof Uint8Array,B=typeof P=="string",C=(I||B)&&P.length;return I?C===s||C===o:B?C===2*s||C===2*o:P instanceof a}function v(P,I,B=!0){if(w(P))throw new Error("first arg must be private key");if(!w(I))throw new Error("second arg must be public key");return a.fromHex(I).multiply(b(P)).toRawBytes(B)}const A=e.bits2int||function(P){const I=He(P),B=P.length*8-e.nBitLength;return B>0?I>>BigInt(B):I},G=e.bits2int_modN||function(P){return l(A(P))},T=tn(e.nBitLength);function H(P){if(typeof P!="bigint")throw new Error("bigint expected");if(!(gt<=P&&P<T))throw new Error(`bigint expected < 2^${e.nBitLength}`);return Pe(P,e.nByteLength)}function D(P,I,B=R){if(["recovered","canonical"].some(be=>be in B))throw new Error("sign() legacy options not supported");const{hash:C,randomBytes:q}=e;let{lowS:U,prehash:z,extraEntropy:X}=B;U==null&&(U=!0),P=Ee("msgHash",P),z&&(P=Ee("prehashed msgHash",C(P)));const W=G(P),L=b(I),Y=[H(L),H(W)];if(X!=null){const be=X===!0?q(r.BYTES):X;Y.push(Ee("extraEntropy",be,r.BYTES))}const $=Ie(...Y),se=W;function ie(be){const de=A(be);if(!h(de))return;const fe=i(de),me=a.BASE.multiply(de).toAffine(),Be=l(me.x);if(Be===gt)return;const Te=l(fe*l(se+Be*L));if(Te===gt)return;let ct=(me.x===Be?0:2)|Number(me.y&nt),$e=Te;return U&&_(Te)&&($e=m(Te),ct^=1),new x(Be,$e,ct)}return{seed:$,k2sig:ie}}const R={lowS:e.lowS,prehash:!1},N={lowS:e.lowS,prehash:!1};function Z(P,I,B=R){const{seed:C,k2sig:q}=D(P,I,B);return ec(e.hash.outputLen,e.nByteLength,e.hmac)(C,q)}a.BASE._setWindowSize(8);function M(P,I,B,C=N){var me;const q=P;if(I=Ee("msgHash",I),B=Ee("publicKey",B),"strict"in C)throw new Error("options.strict was renamed to lowS");const{lowS:U,prehash:z}=C;let X,W;try{if(typeof q=="string"||q instanceof Uint8Array)try{X=x.fromDER(q)}catch(Be){if(!(Be instanceof Zt.Err))throw Be;X=x.fromCompact(q)}else if(typeof q=="object"&&typeof q.r=="bigint"&&typeof q.s=="bigint"){const{r:Be,s:Te}=q;X=new x(Be,Te)}else throw new Error("PARSE");W=a.fromHex(B)}catch(Be){if(Be.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(U&&X.hasHighS())return!1;z&&(I=e.hash(I));const{r:L,s:Y}=X,$=G(I),se=i(Y),ie=l($*se),be=l(L*se),de=(me=a.BASE.multiplyAndAddUnsafe(W,ie,be))==null?void 0:me.toAffine();return de?l(de.x)===L:!1}return{CURVE:e,getPublicKey:k,getSharedSecret:v,sign:Z,verify:M,ProjectivePoint:a,Signature:x,utils:S}}function ko(t,e){const n=t.ORDER;let r=0n;for(let h=n-1n;h%2n===0n;h/=2n)r+=1n;const s=r,o=(n-1n)/2n**s,c=(o-1n)/2n,l=2n**s-1n,i=2n**(s-1n),a=t.pow(e,o),b=t.pow(e,(o+1n)/2n);let p=(h,d)=>{let _=a,m=t.pow(d,l),y=t.sqr(m);y=t.mul(y,d);let x=t.mul(h,y);x=t.pow(x,c),x=t.mul(x,m),m=t.mul(x,d),y=t.mul(x,h);let S=t.mul(y,m);x=t.pow(S,i);let k=t.eql(x,t.ONE);m=t.mul(y,b),x=t.mul(S,_),y=t.cmov(m,y,k),S=t.cmov(x,S,k);for(let w=s;w>1;w--){let v=2n**(w-2n),A=t.pow(S,v);const G=t.eql(A,t.ONE);m=t.mul(y,_),_=t.mul(_,_),A=t.mul(S,_),y=t.cmov(m,y,G),S=t.cmov(A,S,G)}return{isValid:k,value:y}};if(t.ORDER%4n===3n){const h=(t.ORDER-3n)/4n,d=t.sqrt(t.neg(e));p=(_,m)=>{let y=t.sqr(m);const x=t.mul(_,m);y=t.mul(y,x);let S=t.pow(y,h);S=t.mul(S,x);const k=t.mul(S,d),w=t.mul(t.sqr(S),m),v=t.eql(w,_);let A=t.cmov(k,S,v);return{isValid:v,value:A}}}return p}function nn(t,e){if(nc(t),!t.isValid(e.A)||!t.isValid(e.B)||!t.isValid(e.Z))throw new Error("mapToCurveSimpleSWU: invalid opts");const n=ko(t,e.Z);if(!t.isOdd)throw new Error("Fp.isOdd is not implemented!");return r=>{let s,o,c,l,i,a,b,p;s=t.sqr(r),s=t.mul(s,e.Z),o=t.sqr(s),o=t.add(o,s),c=t.add(o,t.ONE),c=t.mul(c,e.B),l=t.cmov(e.Z,t.neg(o),!t.eql(o,t.ZERO)),l=t.mul(l,e.A),o=t.sqr(c),a=t.sqr(l),i=t.mul(a,e.A),o=t.add(o,i),o=t.mul(o,c),a=t.mul(a,l),i=t.mul(a,e.B),o=t.add(o,i),b=t.mul(s,c);const{isValid:h,value:d}=n(o,a);p=t.mul(s,r),p=t.mul(p,d),b=t.cmov(b,c,h),p=t.cmov(p,d,h);const _=t.isOdd(r)===t.isOdd(p);return p=t.cmov(t.neg(p),p,_),b=t.div(b,l),{x:b,y:p}}}function So(t){if(t instanceof Uint8Array)return t;if(typeof t=="string")return Nn(t);throw new Error("DST must be Uint8Array or string")}const Io=He;function Ot(t,e){if(t<0||t>=1<<8*e)throw new Error(`bad I2OSP call: value=${t} length=${e}`);const n=Array.from({length:e}).fill(0);for(let r=e-1;r>=0;r--)n[r]=t&255,t>>>=8;return new Uint8Array(n)}function Co(t,e){const n=new Uint8Array(t.length);for(let r=0;r<t.length;r++)n[r]=t[r]^e[r];return n}function an(t){if(!(t instanceof Uint8Array))throw new Error("Uint8Array expected")}function wr(t){if(!Number.isSafeInteger(t))throw new Error("number expected")}function Ao(t,e,n,r){an(t),an(e),wr(n),e.length>255&&(e=r(Ie(Nn("H2C-OVERSIZE-DST-"),e)));const{outputLen:s,blockLen:o}=r,c=Math.ceil(n/s);if(c>255)throw new Error("Invalid xmd length");const l=Ie(e,Ot(e.length,1)),i=Ot(0,o),a=Ot(n,2),b=new Array(c),p=r(Ie(i,t,a,Ot(0,1),l));b[0]=r(Ie(p,Ot(1,1),l));for(let d=1;d<=c;d++){const _=[Co(p,b[d-1]),Ot(d+1,1),l];b[d]=r(Ie(..._))}return Ie(...b).slice(0,n)}function Oo(t,e,n,r,s){if(an(t),an(e),wr(n),e.length>255){const o=Math.ceil(2*r/8);e=s.create({dkLen:o}).update(Nn("H2C-OVERSIZE-DST-")).update(e).digest()}if(n>65535||e.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return s.create({dkLen:n}).update(t).update(Ot(n,2)).update(e).update(Ot(e.length,1)).digest()}function Zr(t,e,n){qt(n,{DST:"string",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});const{p:r,k:s,m:o,hash:c,expand:l,DST:i}=n;an(t),wr(e);const a=So(i),b=r.toString(2).length,p=Math.ceil((b+s)/8),h=e*o*p;let d;if(l==="xmd")d=Ao(t,a,h,c);else if(l==="xof")d=Oo(t,a,h,s,c);else if(l===void 0)d=t;else throw new Error('expand must be "xmd", "xof" or undefined');const _=new Array(e);for(let m=0;m<e;m++){const y=new Array(o);for(let x=0;x<o;x++){const S=p*(x+m*o),k=d.subarray(S,S+p);y[x]=ye(Io(k),r)}_[m]=y}return _}function Er(t,e){const n=e.map(r=>Array.from(r).reverse());return(r,s)=>{const[o,c,l,i]=n.map(a=>a.reduce((b,p)=>t.add(t.mul(b,r),p)));return r=t.div(o,c),s=t.mul(s,t.div(l,i)),{x:r,y:s}}}function Tt(t,e,n){if(typeof e!="function")throw new Error("mapToCurve() must be defined");return{hashToCurve(r,s){const o=Zr(r,2,{...n,DST:n.DST,...s}),c=t.fromAffine(e(o[0])),l=t.fromAffine(e(o[1])),i=c.add(l).clearCofactor();return i.assertValidity(),i},encodeToCurve(r,s){const o=Zr(r,1,{...n,DST:n.encodeDST,...s}),c=t.fromAffine(e(o[0])).clearCofactor();return c.assertValidity(),c}}}class cc extends mr{constructor(e,n){super(),this.finished=!1,this.destroyed=!1,Fe.hash(e);const r=mn(n);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new TypeError("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,o=new Uint8Array(s);o.set(r.length>s?e.create().update(r).digest():r);for(let c=0;c<o.length;c++)o[c]^=54;this.iHash.update(o),this.oHash=e.create();for(let c=0;c<o.length;c++)o[c]^=106;this.oHash.update(o),o.fill(0)}update(e){return Fe.exists(this),this.iHash.update(e),this}digestInto(e){Fe.exists(this),Fe.bytes(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:r,finished:s,destroyed:o,blockLen:c,outputLen:l}=this;return e=e,e.finished=s,e.destroyed=o,e.blockLen=c,e.outputLen=l,e.oHash=n._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const oc=(t,e,n)=>new cc(t,e).update(n).digest();oc.create=(t,e)=>new cc(t,e);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Po(t){return{hash:t,hmac:(e,...n)=>oc(t,e,_r(...n)),randomBytes:Lt}}function gn(t,e){const n=r=>Bo({...t,...Po(r)});return Object.freeze({...n(e),create:n})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Un=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),On=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),fc=BigInt(1),or=BigInt(2),Kr=(t,e)=>(t+e/or)/e;function lc(t){const e=Un,n=BigInt(3),r=BigInt(6),s=BigInt(11),o=BigInt(22),c=BigInt(23),l=BigInt(44),i=BigInt(88),a=t*t*t%e,b=a*a*t%e,p=we(b,n,e)*b%e,h=we(p,n,e)*b%e,d=we(h,or,e)*a%e,_=we(d,s,e)*d%e,m=we(_,o,e)*_%e,y=we(m,l,e)*m%e,x=we(y,i,e)*y%e,S=we(x,l,e)*m%e,k=we(S,n,e)*b%e,w=we(k,c,e)*_%e,v=we(w,r,e)*a%e,A=we(v,or,e);if(!Nt.eql(Nt.sqr(A),t))throw new Error("Cannot find square root");return A}const Nt=wt(Un,void 0,void 0,{sqrt:lc}),Ve=gn({a:BigInt(0),b:BigInt(7),Fp:Nt,n:On,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{const e=On,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-fc*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),s=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),o=n,c=BigInt("0x100000000000000000000000000000000"),l=Kr(o*t,e),i=Kr(-r*t,e);let a=ye(t-l*n-i*s,e),b=ye(-l*r-i*o,e);const p=a>c,h=b>c;if(p&&(a=e-a),h&&(b=e-b),a>c||b>c)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:p,k1:a,k2neg:h,k2:b}}}},We),Br=BigInt(0),ic=t=>typeof t=="bigint"&&Br<t&&t<Un,Ro=t=>typeof t=="bigint"&&Br<t&&t<On,jr={};function Pn(t,...e){let n=jr[t];if(n===void 0){const r=We(Uint8Array.from(t,s=>s.charCodeAt(0)));n=Ie(r,r),jr[t]=n}return We(Ie(n,...e))}const kr=t=>t.toRawBytes(!0).slice(1),fr=t=>Pe(t,32),zn=t=>ye(t,Un),un=t=>ye(t,On),Sr=Ve.ProjectivePoint,Ho=(t,e,n)=>Sr.BASE.multiplyAndAddUnsafe(t,e,n);function lr(t){let e=Ve.utils.normPrivateKeyToScalar(t),n=Sr.fromPrivateKey(e);return{scalar:n.hasEvenY()?e:un(-e),bytes:kr(n)}}function ac(t){if(!ic(t))throw new Error("bad x: need 0 < x < p");const e=zn(t*t),n=zn(e*t+BigInt(7));let r=lc(n);r%2n!==0n&&(r=zn(-r));const s=new Sr(t,r,fc);return s.assertValidity(),s}function uc(...t){return un(He(Pn("BIP0340/challenge",...t)))}function To(t){return lr(t).bytes}function No(t,e,n=Lt(32)){const r=Ee("message",t),{bytes:s,scalar:o}=lr(e),c=Ee("auxRand",n,32),l=fr(o^He(Pn("BIP0340/aux",c))),i=Pn("BIP0340/nonce",l,s,r),a=un(He(i));if(a===Br)throw new Error("sign failed: k is zero");const{bytes:b,scalar:p}=lr(a),h=uc(b,s,r),d=new Uint8Array(64);if(d.set(b,0),d.set(fr(un(p+h*o)),32),!dc(d,r,s))throw new Error("sign: Invalid signature produced");return d}function dc(t,e,n){const r=Ee("signature",t,64),s=Ee("message",e),o=Ee("publicKey",n,32);try{const c=ac(He(o)),l=He(r.subarray(0,32));if(!ic(l))return!1;const i=He(r.subarray(32,64));if(!Ro(i))return!1;const a=uc(fr(l),kr(c),s),b=Ho(c,i,un(-a));return!(!b||!b.hasEvenY()||b.toAffine().x!==l)}catch{return!1}}const Lo={getPublicKey:To,sign:No,verify:dc,utils:{randomPrivateKey:Ve.utils.randomPrivateKey,lift_x:ac,pointToBytes:kr,numberToBytesBE:Pe,bytesToNumberBE:He,taggedHash:Pn,mod:ye}},qo=Er(Nt,[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map(t=>t.map(e=>BigInt(e)))),Uo=nn(Nt,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:Nt.create(BigInt("-11"))});Tt(Ve.ProjectivePoint,t=>{const{x:e,y:n}=Uo(Nt.create(t[0]));return qo(e,n)},{DST:"secp256k1_XMD:SHA-256_SSWU_RO_",encodeDST:"secp256k1_XMD:SHA-256_SSWU_NU_",p:Nt.ORDER,m:1,k:128,expand:"xmd",hash:We});const wn=BigInt(2**32-1),ir=BigInt(32);function bc(t,e=!1){return e?{h:Number(t&wn),l:Number(t>>ir&wn)}:{h:Number(t>>ir&wn)|0,l:Number(t&wn)|0}}function Mo(t,e=!1){let n=new Uint32Array(t.length),r=new Uint32Array(t.length);for(let s=0;s<t.length;s++){const{h:o,l:c}=bc(t[s],e);[n[s],r[s]]=[o,c]}return[n,r]}const Do=(t,e)=>BigInt(t>>>0)<<ir|BigInt(e>>>0),Go=(t,e,n)=>t>>>n,Zo=(t,e,n)=>t<<32-n|e>>>n,Ko=(t,e,n)=>t>>>n|e<<32-n,jo=(t,e,n)=>t<<32-n|e>>>n,Vo=(t,e,n)=>t<<64-n|e>>>n-32,zo=(t,e,n)=>t>>>n-32|e<<64-n,Yo=(t,e)=>e,Fo=(t,e)=>t,Wo=(t,e,n)=>t<<n|e>>>32-n,Xo=(t,e,n)=>e<<n|t>>>32-n,$o=(t,e,n)=>e<<n-32|t>>>64-n,Qo=(t,e,n)=>t<<n-32|e>>>64-n;function Jo(t,e,n,r){const s=(e>>>0)+(r>>>0);return{h:t+n+(s/2**32|0)|0,l:s|0}}const ef=(t,e,n)=>(t>>>0)+(e>>>0)+(n>>>0),tf=(t,e,n,r)=>e+n+r+(t/2**32|0)|0,nf=(t,e,n,r)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0),rf=(t,e,n,r,s)=>e+n+r+s+(t/2**32|0)|0,sf=(t,e,n,r,s)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0)+(s>>>0),cf=(t,e,n,r,s,o)=>e+n+r+s+o+(t/2**32|0)|0,he={fromBig:bc,split:Mo,toBig:Do,shrSH:Go,shrSL:Zo,rotrSH:Ko,rotrSL:jo,rotrBH:Vo,rotrBL:zo,rotr32H:Yo,rotr32L:Fo,rotlSH:Wo,rotlSL:Xo,rotlBH:$o,rotlBL:Qo,add:Jo,add3L:ef,add3H:tf,add4L:nf,add4H:rf,add5H:cf,add5L:sf},[hc,pc,_c]=[[],[],[]],of=BigInt(0),cn=BigInt(1),ff=BigInt(2),lf=BigInt(7),af=BigInt(256),uf=BigInt(113);for(let t=0,e=cn,n=1,r=0;t<24;t++){[n,r]=[r,(2*n+3*r)%5],hc.push(2*(5*r+n)),pc.push((t+1)*(t+2)/2%64);let s=of;for(let o=0;o<7;o++)e=(e<<cn^(e>>lf)*uf)%af,e&ff&&(s^=cn<<(cn<<BigInt(o))-cn);_c.push(s)}const[df,bf]=he.split(_c,!0),Vr=(t,e,n)=>n>32?he.rotlBH(t,e,n):he.rotlSH(t,e,n),zr=(t,e,n)=>n>32?he.rotlBL(t,e,n):he.rotlSL(t,e,n);function hf(t,e=24){const n=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let c=0;c<10;c++)n[c]=t[c]^t[c+10]^t[c+20]^t[c+30]^t[c+40];for(let c=0;c<10;c+=2){const l=(c+8)%10,i=(c+2)%10,a=n[i],b=n[i+1],p=Vr(a,b,1)^n[l],h=zr(a,b,1)^n[l+1];for(let d=0;d<50;d+=10)t[c+d]^=p,t[c+d+1]^=h}let s=t[2],o=t[3];for(let c=0;c<24;c++){const l=pc[c],i=Vr(s,o,l),a=zr(s,o,l),b=hc[c];s=t[b],o=t[b+1],t[b]=i,t[b+1]=a}for(let c=0;c<50;c+=10){for(let l=0;l<10;l++)n[l]=t[c+l];for(let l=0;l<10;l++)t[c+l]^=~n[(l+2)%10]&n[(l+4)%10]}t[0]^=df[r],t[1]^=bf[r]}n.fill(0)}class Mn extends mr{constructor(e,n,r,s=!1,o=24){if(super(),this.blockLen=e,this.suffix=n,this.outputLen=r,this.enableXOF=s,this.rounds=o,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,Fe.number(r),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=Qc(this.state)}keccak(){hf(this.state32,this.rounds),this.posOut=0,this.pos=0}update(e){Fe.exists(this);const{blockLen:n,state:r}=this;e=mn(e);const s=e.length;for(let o=0;o<s;){const c=Math.min(n-this.pos,s-o);for(let l=0;l<c;l++)r[this.pos++]^=e[o++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:n,pos:r,blockLen:s}=this;e[r]^=n,n&128&&r===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){Fe.exists(this,!1),Fe.bytes(e),this.finish();const n=this.state,{blockLen:r}=this;for(let s=0,o=e.length;s<o;){this.posOut>=r&&this.keccak();const c=Math.min(r-this.posOut,o-s);e.set(n.subarray(this.posOut,this.posOut+c),s),this.posOut+=c,s+=c}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return Fe.number(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(Fe.output(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:n,suffix:r,outputLen:s,rounds:o,enableXOF:c}=this;return e||(e=new Mn(n,r,s,c,o)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=o,e.suffix=r,e.outputLen=s,e.enableXOF=c,e.destroyed=this.destroyed,e}}const Ut=(t,e,n)=>vt(()=>new Mn(e,t,n));Ut(6,144,224/8);const Ir=Ut(6,136,256/8),pf=Ut(6,104,384/8),_f=Ut(6,72,512/8);Ut(1,144,224/8);const Cr=Ut(1,136,256/8),mf=Ut(1,104,384/8),gf=Ut(1,72,512/8),mc=(t,e,n)=>to((r={})=>new Mn(e,t,r.dkLen===void 0?n:r.dkLen,!0));mc(31,168,128/8);const Ar=mc(31,136,256/8),Ue=t=>t.toString(),Cn=t=>!/[^0-9]/.test(t),ar=t=>{try{return typeof BigInt(t)=="bigint"}catch{return!1}},yf=t=>/[^0-9A-F]/gi.test(t),Dt=t=>t.message.split(/\r?\n/),En="0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef",xf="0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef",vf="0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef01",wf="0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef01",Rn=[{type:"ECDSA",list:["secp256k1","P256","P384","P521"]},{type:"Schnorr",list:["secp256k1"]},{type:"EdDSA",list:["ed25519","ed448"]},{type:"BLS",list:["bls12-381"],options:["G1","G2"]}],ze={NO_MESSAGE:"Provide a message to sign to see the results.",POSITIVE_INT:"must be positive and non-floating point integer.",INT:"must be non-floating point integer."},Xt=[];function Dn(t,e=ve){let n;const r=new Set;function s(l){if(Me(t,l)&&(t=l,n)){const i=!Xt.length;for(const a of r)a[1](),Xt.push(a,t);if(i){for(let a=0;a<Xt.length;a+=2)Xt[a][0](Xt[a+1]);Xt.length=0}}}function o(l){s(l(t))}function c(l,i=ve){const a=[l,i];return r.add(a),r.size===1&&(n=e(s)||ve),l(t),()=>{r.delete(a),r.size===0&&(n(),n=null)}}return{set:s,update:o,subscribe:c}}const ft=Dn(""),Xe=Dn(""),De=Dn(0n),ur=Dn("");function Ef(t){let e,n,r,s,o,c;const l=t[1].default,i=qc(l,t,t[0],null);return{c(){e=u("div"),n=u("div"),r=u("div"),r.textContent="Hash function",s=O(),o=u("div"),i&&i.c(),g(r,"class","hashes-list__title"),g(n,"class","hashes-list"),g(e,"class","hashes-list-container svelte-wqqbct")},m(a,b){V(a,e,b),f(e,n),f(n,r),f(n,s),f(n,o),i&&i.m(o,null),c=!0},p(a,[b]){i&&i.p&&(!c||b&1)&&Mc(i,l,a,a[0],c?Uc(l,a[0],b,null):Dc(a[0]),null)},i(a){c||(ne(i,a),c=!0)},o(a){oe(i,a),c=!1},d(a){a&&j(e),i&&i.d(a)}}}function Bf(t,e,n){let{$$slots:r={},$$scope:s}=e;return t.$$set=o=>{"$$scope"in o&&n(0,s=o.$$scope)},[s,r]}class yn extends Ze{constructor(e){super(),Ge(this,e,Bf,Ef,Me,{})}}function kf(t){let e,n,r,s,o,c,l;return{c(){e=u("span"),n=u("input"),r=O(),s=u("label"),o=F(t[0]),g(n,"type","radio"),g(n,"name","hash"),n.value=t[0],g(n,"id",t[0]),n.checked=t[1],g(s,"for",t[0]),g(e,"class","hash-radio svelte-3qb93j")},m(i,a){V(i,e,a),f(e,n),f(e,r),f(e,s),f(s,o),c||(l=ke(n,"change",t[3]),c=!0)},p(i,[a]){a&1&&(n.value=i[0]),a&1&&g(n,"id",i[0]),a&2&&(n.checked=i[1]),a&1&&Q(o,i[0]),a&1&&g(s,"for",i[0])},i:ve,o:ve,d(i){i&&j(e),c=!1,l()}}}function Sf(t,e,n){const r=pr();let{hash:s}=e,{checked:o}=e;const c=()=>{r("change",s)};return t.$$set=l=>{"hash"in l&&n(0,s=l.hash),"checked"in l&&n(1,o=l.checked)},[s,o,r,c]}class xn extends Ze{constructor(e){super(),Ge(this,e,Sf,kf,Me,{hash:0,checked:1})}}function If(t){let e,n,r,s,o,c,l;return{c(){e=u("div"),n=u("label"),n.innerHTML=`<strong>Message to sign</strong> 
    <small>(will be hashed with for ecdsa/bls12)</small>`,r=O(),s=u("div"),o=u("input"),g(n,"for","sign-message-input"),g(o,"class","text-input"),g(o,"id","sign-message-input"),g(o,"type","text"),g(o,"maxlength","512"),g(s,"class","sign-message__input-container svelte-nq1zbe"),g(e,"class","sign-message svelte-nq1zbe")},m(i,a){V(i,e,a),f(e,n),f(e,r),f(e,s),f(s,o),tt(o,t[0]),c||(l=ke(o,"input",t[1]),c=!0)},p(i,[a]){a&1&&o.value!==i[0]&&tt(o,i[0])},i:ve,o:ve,d(i){i&&j(e),c=!1,l()}}}function Cf(t,e,n){let r;Ce(t,Xe,o=>n(0,r=o));function s(){r=this.value,Xe.set(r)}return[r,s]}class Et extends Ze{constructor(e){super(),Ge(this,e,Cf,If,Me,{})}}function Yr(t,e,n){const r=t.slice();return r[17]=e[n],r[19]=n,r}function Fr(t){let e,n;return e=new xn({props:{hash:t[17],checked:t[19]===0}}),e.$on("change",t[11]),{c(){ge(e.$$.fragment)},m(r,s){pe(e,r,s),n=!0},p:ve,i(r){n||(ne(e.$$.fragment,r),n=!0)},o(r){oe(e.$$.fragment,r),n=!1},d(r){_e(e,r)}}}function Af(t){let e,n,r=t[10],s=[];for(let c=0;c<r.length;c+=1)s[c]=Fr(Yr(t,r,c));const o=c=>oe(s[c],1,1,()=>{s[c]=null});return{c(){for(let c=0;c<s.length;c+=1)s[c].c();e=dt()},m(c,l){for(let i=0;i<s.length;i+=1)s[i].m(c,l);V(c,e,l),n=!0},p(c,l){if(l&3072){r=c[10];let i;for(i=0;i<r.length;i+=1){const a=Yr(c,r,i);s[i]?(s[i].p(a,l),ne(s[i],1)):(s[i]=Fr(a),s[i].c(),ne(s[i],1),s[i].m(e.parentNode,e))}for(lt(),i=r.length;i<s.length;i+=1)o(i);it()}},i(c){if(!n){for(let l=0;l<r.length;l+=1)ne(s[l]);n=!0}},o(c){s=s.filter(Boolean);for(let l=0;l<s.length;l+=1)oe(s[l]);n=!1},d(c){ut(s,c),c&&j(e)}}}function Of(t){let e;return{c(){e=u("p"),e.textContent=`${ze.NO_MESSAGE}`},m(n,r){V(n,e,r)},p:ve,d(n){n&&j(e)}}}function Pf(t){let e,n,r,s,o,c,l,i,a,b,p,h,d,_,m,y,x,S,k,w,v,A,G,T,H,D,R,N,Z,M,P;return{c(){e=u("table"),n=u("tbody"),r=u("tr"),s=u("td"),s.textContent="msgHash",o=u("td"),c=u("code"),l=F(t[9]),i=O(),a=u("tr"),b=u("td"),b.textContent="r",p=u("td"),h=u("code"),d=F(t[5]),_=O(),m=u("tr"),y=u("td"),y.textContent="s",x=u("td"),S=u("code"),k=F(t[6]),w=O(),v=u("tr"),A=u("td"),A.textContent="compact",G=u("td"),T=u("code"),H=F(t[7]),D=O(),R=u("tr"),N=u("td"),N.textContent="der",Z=u("td"),M=u("code"),P=F(t[8]),g(s,"class","curve-data__key"),g(b,"class","curve-data__key"),g(y,"class","curve-data__key"),g(A,"class","curve-data__key"),g(N,"class","curve-data__key"),g(e,"class","curve-data__table")},m(I,B){V(I,e,B),f(e,n),f(n,r),f(r,s),f(r,o),f(o,c),f(c,l),f(n,i),f(n,a),f(a,b),f(a,p),f(p,h),f(h,d),f(n,_),f(n,m),f(m,y),f(m,x),f(x,S),f(S,k),f(n,w),f(n,v),f(v,A),f(v,G),f(G,T),f(T,H),f(n,D),f(n,R),f(R,N),f(R,Z),f(Z,M),f(M,P)},p(I,B){B&512&&Q(l,I[9]),B&32&&Q(d,I[5]),B&64&&Q(k,I[6]),B&128&&Q(H,I[7]),B&256&&Q(P,I[8])},d(I){I&&j(e)}}}function Rf(t){let e,n,r,s,o,c,l,i,a,b,p,h,d,_,m,y,x,S,k,w,v,A,G,T,H,D,R,N,Z,M,P,I,B,C,q,U;I=new Et({}),C=new yn({props:{$$slots:{default:[Af]},$$scope:{ctx:t}}});function z(L,Y){return L[0]?Pf:Of}let X=z(t),W=X(t);return{c(){e=u("div"),n=u("h3"),n.textContent="Public key",r=O(),s=u("table"),o=u("tbody"),c=u("tr"),l=u("td"),l.textContent="x",i=u("td"),a=u("code"),b=F(t[1]),p=O(),h=u("tr"),d=u("td"),d.textContent="y",_=u("td"),m=u("code"),y=F(t[2]),x=O(),S=u("tr"),k=u("td"),k.textContent="33b hex",w=u("td"),v=u("code"),A=F(t[3]),G=O(),T=u("tr"),H=u("td"),H.textContent="64b hex",D=u("td"),R=u("code"),N=F(t[4]),Z=O(),M=u("h3"),M.textContent="Signature",P=O(),ge(I.$$.fragment),B=O(),ge(C.$$.fragment),q=O(),W.c(),g(n,"class","curve-data__header"),g(l,"class","curve-data__key"),g(d,"class","curve-data__key"),g(k,"class","curve-data__key"),g(H,"class","curve-data__key"),g(s,"class","curve-data__table"),g(M,"class","curve-data__header"),g(e,"class","curve-data")},m(L,Y){V(L,e,Y),f(e,n),f(e,r),f(e,s),f(s,o),f(o,c),f(c,l),f(c,i),f(i,a),f(a,b),f(o,p),f(o,h),f(h,d),f(h,_),f(_,m),f(m,y),f(o,x),f(o,S),f(S,k),f(S,w),f(w,v),f(v,A),f(o,G),f(o,T),f(T,H),f(T,D),f(D,R),f(R,N),f(e,Z),f(e,M),f(e,P),pe(I,e,null),f(e,B),pe(C,e,null),f(e,q),W.m(e,null),U=!0},p(L,[Y]){(!U||Y&2)&&Q(b,L[1]),(!U||Y&4)&&Q(y,L[2]),(!U||Y&8)&&Q(A,L[3]),(!U||Y&16)&&Q(N,L[4]);const $={};Y&1048576&&($.$$scope={dirty:Y,ctx:L}),C.$set($),X===(X=z(L))&&W?W.p(L,Y):(W.d(1),W=X(L),W&&(W.c(),W.m(e,null)))},i(L){U||(ne(I.$$.fragment,L),ne(C.$$.fragment,L),U=!0)},o(L){oe(I.$$.fragment,L),oe(C.$$.fragment,L),U=!1},d(L){L&&j(e),_e(I),_e(C),W.d()}}}function Hf(t,e,n){let r,s,o;Ce(t,Xe,w=>n(14,s=w)),Ce(t,De,w=>n(15,o=w));let{privKey:c}=e,l,i,a,b,p,h,d,_,m;Le(De,o=Ve.CURVE.n,o);let y="sha256";const x={sha256:We,sha3_256:Ir,keccak_256:Cr},S=Object.keys(x),k=w=>{n(13,y=w.detail)};return t.$$set=w=>{"privKey"in w&&n(12,c=w.privKey)},t.$$.update=()=>{if(t.$$.dirty&16384&&n(0,r=s.length>0),t.$$.dirty&4096){const w=Ve.getPublicKey(c),v=Ve.ProjectivePoint.fromHex(w);n(1,[l,i]=[v.x,v.y].map(A=>Ue(A)),l,(n(2,i),n(12,c))),n(3,a=v.toHex(!0)),n(4,b=v.toHex(!1))}if(t.$$.dirty&28673&&r){const w=x[y],v=w(s),A=Ve.sign(v,c);n(5,[p,h]=[A.r,A.s].map(G=>Ue(G)),p,(n(6,h),n(0,r),n(13,y),n(14,s),n(12,c))),n(7,d=A.toCompactHex()),n(8,_=A.toDERHex()),n(9,m=Ke(v))}},[r,l,i,a,b,p,h,d,_,m,S,k,c,y,s]}class Tf extends Ze{constructor(e){super(),Ge(this,e,Hf,Rf,Me,{privKey:12})}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const dn=wt(BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff")),gc=dn.create(BigInt("-3")),yc=BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Nf=nn(dn,{A:gc,B:yc,Z:dn.create(BigInt("-10"))}),Rt=gn({a:gc,b:yc,Fp:dn,n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),h:BigInt(1),lowS:!1},We),Lf=Rt;Tt(Lf.ProjectivePoint,t=>Nf(t[0]),{DST:"P256_XMD:SHA-256_SSWU_RO_",encodeDST:"P256_XMD:SHA-256_SSWU_NU_",p:dn.ORDER,m:1,k:128,expand:"xmd",hash:We});function Wr(t,e,n){const r=t.slice();return r[17]=e[n],r[19]=n,r}function Xr(t){let e,n;return e=new xn({props:{hash:t[17],checked:t[19]===0}}),e.$on("change",t[11]),{c(){ge(e.$$.fragment)},m(r,s){pe(e,r,s),n=!0},p:ve,i(r){n||(ne(e.$$.fragment,r),n=!0)},o(r){oe(e.$$.fragment,r),n=!1},d(r){_e(e,r)}}}function qf(t){let e,n,r=t[10],s=[];for(let c=0;c<r.length;c+=1)s[c]=Xr(Wr(t,r,c));const o=c=>oe(s[c],1,1,()=>{s[c]=null});return{c(){for(let c=0;c<s.length;c+=1)s[c].c();e=dt()},m(c,l){for(let i=0;i<s.length;i+=1)s[i].m(c,l);V(c,e,l),n=!0},p(c,l){if(l&3072){r=c[10];let i;for(i=0;i<r.length;i+=1){const a=Wr(c,r,i);s[i]?(s[i].p(a,l),ne(s[i],1)):(s[i]=Xr(a),s[i].c(),ne(s[i],1),s[i].m(e.parentNode,e))}for(lt(),i=r.length;i<s.length;i+=1)o(i);it()}},i(c){if(!n){for(let l=0;l<r.length;l+=1)ne(s[l]);n=!0}},o(c){s=s.filter(Boolean);for(let l=0;l<s.length;l+=1)oe(s[l]);n=!1},d(c){ut(s,c),c&&j(e)}}}function Uf(t){let e;return{c(){e=u("p"),e.textContent=`${ze.NO_MESSAGE}`},m(n,r){V(n,e,r)},p:ve,d(n){n&&j(e)}}}function Mf(t){let e,n,r,s,o,c,l,i,a,b,p,h,d,_,m,y,x,S,k,w,v,A,G,T,H,D,R,N,Z,M,P;return{c(){e=u("table"),n=u("tbody"),r=u("tr"),s=u("td"),s.textContent="msgHash",o=u("td"),c=u("code"),l=F(t[9]),i=O(),a=u("tr"),b=u("td"),b.textContent="r",p=u("td"),h=u("code"),d=F(t[5]),_=O(),m=u("tr"),y=u("td"),y.textContent="s",x=u("td"),S=u("code"),k=F(t[6]),w=O(),v=u("tr"),A=u("td"),A.textContent="compact",G=u("td"),T=u("code"),H=F(t[7]),D=O(),R=u("tr"),N=u("td"),N.textContent="der",Z=u("td"),M=u("code"),P=F(t[8]),g(s,"class","curve-data__key"),g(b,"class","curve-data__key"),g(y,"class","curve-data__key"),g(A,"class","curve-data__key"),g(N,"class","curve-data__key"),g(e,"class","curve-data__table")},m(I,B){V(I,e,B),f(e,n),f(n,r),f(r,s),f(r,o),f(o,c),f(c,l),f(n,i),f(n,a),f(a,b),f(a,p),f(p,h),f(h,d),f(n,_),f(n,m),f(m,y),f(m,x),f(x,S),f(S,k),f(n,w),f(n,v),f(v,A),f(v,G),f(G,T),f(T,H),f(n,D),f(n,R),f(R,N),f(R,Z),f(Z,M),f(M,P)},p(I,B){B&512&&Q(l,I[9]),B&32&&Q(d,I[5]),B&64&&Q(k,I[6]),B&128&&Q(H,I[7]),B&256&&Q(P,I[8])},d(I){I&&j(e)}}}function Df(t){let e,n,r,s,o,c,l,i,a,b,p,h,d,_,m,y,x,S,k,w,v,A,G,T,H,D,R,N,Z,M,P,I,B,C,q,U;I=new Et({}),C=new yn({props:{$$slots:{default:[qf]},$$scope:{ctx:t}}});function z(L,Y){return L[0]?Mf:Uf}let X=z(t),W=X(t);return{c(){e=u("div"),n=u("h3"),n.textContent="Public key",r=O(),s=u("table"),o=u("tbody"),c=u("tr"),l=u("td"),l.textContent="x",i=u("td"),a=u("code"),b=F(t[1]),p=O(),h=u("tr"),d=u("td"),d.textContent="y",_=u("td"),m=u("code"),y=F(t[2]),x=O(),S=u("tr"),k=u("td"),k.textContent="33b hex",w=u("td"),v=u("code"),A=F(t[3]),G=O(),T=u("tr"),H=u("td"),H.textContent="64b hex",D=u("td"),R=u("code"),N=F(t[4]),Z=O(),M=u("h3"),M.textContent="Signature",P=O(),ge(I.$$.fragment),B=O(),ge(C.$$.fragment),q=O(),W.c(),g(n,"class","curve-data__header"),g(l,"class","curve-data__key"),g(d,"class","curve-data__key"),g(k,"class","curve-data__key"),g(H,"class","curve-data__key"),g(s,"class","curve-data__table"),g(M,"class","curve-data__header"),g(e,"class","curve-data")},m(L,Y){V(L,e,Y),f(e,n),f(e,r),f(e,s),f(s,o),f(o,c),f(c,l),f(c,i),f(i,a),f(a,b),f(o,p),f(o,h),f(h,d),f(h,_),f(_,m),f(m,y),f(o,x),f(o,S),f(S,k),f(S,w),f(w,v),f(v,A),f(o,G),f(o,T),f(T,H),f(T,D),f(D,R),f(R,N),f(e,Z),f(e,M),f(e,P),pe(I,e,null),f(e,B),pe(C,e,null),f(e,q),W.m(e,null),U=!0},p(L,[Y]){(!U||Y&2)&&Q(b,L[1]),(!U||Y&4)&&Q(y,L[2]),(!U||Y&8)&&Q(A,L[3]),(!U||Y&16)&&Q(N,L[4]);const $={};Y&1048576&&($.$$scope={dirty:Y,ctx:L}),C.$set($),X===(X=z(L))&&W?W.p(L,Y):(W.d(1),W=X(L),W&&(W.c(),W.m(e,null)))},i(L){U||(ne(I.$$.fragment,L),ne(C.$$.fragment,L),U=!0)},o(L){oe(I.$$.fragment,L),oe(C.$$.fragment,L),U=!1},d(L){L&&j(e),_e(I),_e(C),W.d()}}}function Gf(t,e,n){let r,s,o;Ce(t,Xe,w=>n(14,s=w)),Ce(t,De,w=>n(15,o=w));let{privKey:c}=e,l,i,a,b,p,h,d,_,m;Le(De,o=Rt.CURVE.n,o);let y="sha256";const x={sha256:We,sha3_256:Ir,keccak_256:Cr},S=Object.keys(x),k=w=>{n(13,y=w.detail)};return t.$$set=w=>{"privKey"in w&&n(12,c=w.privKey)},t.$$.update=()=>{if(t.$$.dirty&16384&&n(0,r=s.length>0),t.$$.dirty&4096){const w=Rt.getPublicKey(c),v=Rt.ProjectivePoint.fromHex(w);n(1,[l,i]=[v.x,v.y].map(A=>Ue(A)),l,(n(2,i),n(12,c))),n(3,a=v.toHex(!0)),n(4,b=v.toHex(!1))}if(t.$$.dirty&28673&&r){const w=x[y],v=w(s),A=Rt.sign(v,c);n(5,[p,h]=[A.r,A.s].map(G=>Ue(G)),p,(n(6,h),n(0,r),n(13,y),n(14,s),n(12,c))),n(7,d=A.toCompactHex()),n(8,_=A.toDERHex()),n(9,m=Ke(v))}},[r,l,i,a,b,p,h,d,_,m,S,k,c,y,s]}class Zf extends Ze{constructor(e){super(),Ge(this,e,Gf,Df,Me,{privKey:12})}}const[Kf,jf]=he.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),St=new Uint32Array(80),It=new Uint32Array(80);class Gn extends Xs{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:n,Bh:r,Bl:s,Ch:o,Cl:c,Dh:l,Dl:i,Eh:a,El:b,Fh:p,Fl:h,Gh:d,Gl:_,Hh:m,Hl:y}=this;return[e,n,r,s,o,c,l,i,a,b,p,h,d,_,m,y]}set(e,n,r,s,o,c,l,i,a,b,p,h,d,_,m,y){this.Ah=e|0,this.Al=n|0,this.Bh=r|0,this.Bl=s|0,this.Ch=o|0,this.Cl=c|0,this.Dh=l|0,this.Dl=i|0,this.Eh=a|0,this.El=b|0,this.Fh=p|0,this.Fl=h|0,this.Gh=d|0,this.Gl=_|0,this.Hh=m|0,this.Hl=y|0}process(e,n){for(let k=0;k<16;k++,n+=4)St[k]=e.getUint32(n),It[k]=e.getUint32(n+=4);for(let k=16;k<80;k++){const w=St[k-15]|0,v=It[k-15]|0,A=he.rotrSH(w,v,1)^he.rotrSH(w,v,8)^he.shrSH(w,v,7),G=he.rotrSL(w,v,1)^he.rotrSL(w,v,8)^he.shrSL(w,v,7),T=St[k-2]|0,H=It[k-2]|0,D=he.rotrSH(T,H,19)^he.rotrBH(T,H,61)^he.shrSH(T,H,6),R=he.rotrSL(T,H,19)^he.rotrBL(T,H,61)^he.shrSL(T,H,6),N=he.add4L(G,R,It[k-7],It[k-16]),Z=he.add4H(N,A,D,St[k-7],St[k-16]);St[k]=Z|0,It[k]=N|0}let{Ah:r,Al:s,Bh:o,Bl:c,Ch:l,Cl:i,Dh:a,Dl:b,Eh:p,El:h,Fh:d,Fl:_,Gh:m,Gl:y,Hh:x,Hl:S}=this;for(let k=0;k<80;k++){const w=he.rotrSH(p,h,14)^he.rotrSH(p,h,18)^he.rotrBH(p,h,41),v=he.rotrSL(p,h,14)^he.rotrSL(p,h,18)^he.rotrBL(p,h,41),A=p&d^~p&m,G=h&_^~h&y,T=he.add5L(S,v,G,jf[k],It[k]),H=he.add5H(T,x,w,A,Kf[k],St[k]),D=T|0,R=he.rotrSH(r,s,28)^he.rotrBH(r,s,34)^he.rotrBH(r,s,39),N=he.rotrSL(r,s,28)^he.rotrBL(r,s,34)^he.rotrBL(r,s,39),Z=r&o^r&l^o&l,M=s&c^s&i^c&i;x=m|0,S=y|0,m=d|0,y=_|0,d=p|0,_=h|0,{h:p,l:h}=he.add(a|0,b|0,H|0,D|0),a=l|0,b=i|0,l=o|0,i=c|0,o=r|0,c=s|0;const P=he.add3L(D,N,M);r=he.add3H(P,H,R,Z),s=P|0}({h:r,l:s}=he.add(this.Ah|0,this.Al|0,r|0,s|0)),{h:o,l:c}=he.add(this.Bh|0,this.Bl|0,o|0,c|0),{h:l,l:i}=he.add(this.Ch|0,this.Cl|0,l|0,i|0),{h:a,l:b}=he.add(this.Dh|0,this.Dl|0,a|0,b|0),{h:p,l:h}=he.add(this.Eh|0,this.El|0,p|0,h|0),{h:d,l:_}=he.add(this.Fh|0,this.Fl|0,d|0,_|0),{h:m,l:y}=he.add(this.Gh|0,this.Gl|0,m|0,y|0),{h:x,l:S}=he.add(this.Hh|0,this.Hl|0,x|0,S|0),this.set(r,s,o,c,l,i,a,b,p,h,d,_,m,y,x,S)}roundClean(){St.fill(0),It.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class Vf extends Gn{constructor(){super(),this.Ah=-1942145080,this.Al=424955298,this.Bh=1944164710,this.Bl=-1982016298,this.Ch=502970286,this.Cl=855612546,this.Dh=1738396948,this.Dl=1479516111,this.Eh=258812777,this.El=2077511080,this.Fh=2011393907,this.Fl=79989058,this.Gh=1067287976,this.Gl=1780299464,this.Hh=286451373,this.Hl=-1848208735,this.outputLen=28}}class zf extends Gn{constructor(){super(),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414,this.outputLen=32}}class Yf extends Gn{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}}const rn=vt(()=>new Gn);vt(()=>new Vf);vt(()=>new zf);const Or=vt(()=>new Yf);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Ff=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),bn=wt(Ff),xc=bn.create(BigInt("-3")),vc=BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Wf=nn(bn,{A:xc,B:vc,Z:bn.create(BigInt("-12"))}),Kt=gn({a:xc,b:vc,Fp:bn,n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f"),h:BigInt(1),lowS:!1},Or),Xf=Kt;Tt(Xf.ProjectivePoint,t=>Wf(t[0]),{DST:"P384_XMD:SHA-384_SSWU_RO_",encodeDST:"P384_XMD:SHA-384_SSWU_NU_",p:bn.ORDER,m:1,k:192,expand:"xmd",hash:Or});function $r(t,e,n){const r=t.slice();return r[17]=e[n],r[19]=n,r}function Qr(t){let e,n;return e=new xn({props:{hash:t[17],checked:t[19]===0}}),e.$on("change",t[11]),{c(){ge(e.$$.fragment)},m(r,s){pe(e,r,s),n=!0},p:ve,i(r){n||(ne(e.$$.fragment,r),n=!0)},o(r){oe(e.$$.fragment,r),n=!1},d(r){_e(e,r)}}}function $f(t){let e,n,r=t[10],s=[];for(let c=0;c<r.length;c+=1)s[c]=Qr($r(t,r,c));const o=c=>oe(s[c],1,1,()=>{s[c]=null});return{c(){for(let c=0;c<s.length;c+=1)s[c].c();e=dt()},m(c,l){for(let i=0;i<s.length;i+=1)s[i].m(c,l);V(c,e,l),n=!0},p(c,l){if(l&3072){r=c[10];let i;for(i=0;i<r.length;i+=1){const a=$r(c,r,i);s[i]?(s[i].p(a,l),ne(s[i],1)):(s[i]=Qr(a),s[i].c(),ne(s[i],1),s[i].m(e.parentNode,e))}for(lt(),i=r.length;i<s.length;i+=1)o(i);it()}},i(c){if(!n){for(let l=0;l<r.length;l+=1)ne(s[l]);n=!0}},o(c){s=s.filter(Boolean);for(let l=0;l<s.length;l+=1)oe(s[l]);n=!1},d(c){ut(s,c),c&&j(e)}}}function Qf(t){let e;return{c(){e=u("p"),e.textContent=`${ze.NO_MESSAGE}`},m(n,r){V(n,e,r)},p:ve,d(n){n&&j(e)}}}function Jf(t){let e,n,r,s,o,c,l,i,a,b,p,h,d,_,m,y,x,S,k,w,v,A,G,T,H,D,R,N,Z,M,P;return{c(){e=u("table"),n=u("tbody"),r=u("tr"),s=u("td"),s.textContent="msgHash",o=u("td"),c=u("code"),l=F(t[9]),i=O(),a=u("tr"),b=u("td"),b.textContent="r",p=u("td"),h=u("code"),d=F(t[5]),_=O(),m=u("tr"),y=u("td"),y.textContent="s",x=u("td"),S=u("code"),k=F(t[6]),w=O(),v=u("tr"),A=u("td"),A.textContent="compact",G=u("td"),T=u("code"),H=F(t[7]),D=O(),R=u("tr"),N=u("td"),N.textContent="der",Z=u("td"),M=u("code"),P=F(t[8]),g(s,"class","curve-data__key"),g(b,"class","curve-data__key"),g(y,"class","curve-data__key"),g(A,"class","curve-data__key"),g(N,"class","curve-data__key"),g(e,"class","curve-data__table")},m(I,B){V(I,e,B),f(e,n),f(n,r),f(r,s),f(r,o),f(o,c),f(c,l),f(n,i),f(n,a),f(a,b),f(a,p),f(p,h),f(h,d),f(n,_),f(n,m),f(m,y),f(m,x),f(x,S),f(S,k),f(n,w),f(n,v),f(v,A),f(v,G),f(G,T),f(T,H),f(n,D),f(n,R),f(R,N),f(R,Z),f(Z,M),f(M,P)},p(I,B){B&512&&Q(l,I[9]),B&32&&Q(d,I[5]),B&64&&Q(k,I[6]),B&128&&Q(H,I[7]),B&256&&Q(P,I[8])},d(I){I&&j(e)}}}function el(t){let e,n,r,s,o,c,l,i,a,b,p,h,d,_,m,y,x,S,k,w,v,A,G,T,H,D,R,N,Z,M,P,I,B,C,q,U;I=new Et({}),C=new yn({props:{$$slots:{default:[$f]},$$scope:{ctx:t}}});function z(L,Y){return L[0]?Jf:Qf}let X=z(t),W=X(t);return{c(){e=u("div"),n=u("h3"),n.textContent="Public key",r=O(),s=u("table"),o=u("tbody"),c=u("tr"),l=u("td"),l.textContent="x",i=u("td"),a=u("code"),b=F(t[1]),p=O(),h=u("tr"),d=u("td"),d.textContent="y",_=u("td"),m=u("code"),y=F(t[2]),x=O(),S=u("tr"),k=u("td"),k.textContent="33b hex",w=u("td"),v=u("code"),A=F(t[3]),G=O(),T=u("tr"),H=u("td"),H.textContent="64b hex",D=u("td"),R=u("code"),N=F(t[4]),Z=O(),M=u("h3"),M.textContent="Signature",P=O(),ge(I.$$.fragment),B=O(),ge(C.$$.fragment),q=O(),W.c(),g(n,"class","curve-data__header"),g(l,"class","curve-data__key"),g(d,"class","curve-data__key"),g(k,"class","curve-data__key"),g(H,"class","curve-data__key"),g(s,"class","curve-data__table"),g(M,"class","curve-data__header"),g(e,"class","curve-data")},m(L,Y){V(L,e,Y),f(e,n),f(e,r),f(e,s),f(s,o),f(o,c),f(c,l),f(c,i),f(i,a),f(a,b),f(o,p),f(o,h),f(h,d),f(h,_),f(_,m),f(m,y),f(o,x),f(o,S),f(S,k),f(S,w),f(w,v),f(v,A),f(o,G),f(o,T),f(T,H),f(T,D),f(D,R),f(R,N),f(e,Z),f(e,M),f(e,P),pe(I,e,null),f(e,B),pe(C,e,null),f(e,q),W.m(e,null),U=!0},p(L,[Y]){(!U||Y&2)&&Q(b,L[1]),(!U||Y&4)&&Q(y,L[2]),(!U||Y&8)&&Q(A,L[3]),(!U||Y&16)&&Q(N,L[4]);const $={};Y&1048576&&($.$$scope={dirty:Y,ctx:L}),C.$set($),X===(X=z(L))&&W?W.p(L,Y):(W.d(1),W=X(L),W&&(W.c(),W.m(e,null)))},i(L){U||(ne(I.$$.fragment,L),ne(C.$$.fragment,L),U=!0)},o(L){oe(I.$$.fragment,L),oe(C.$$.fragment,L),U=!1},d(L){L&&j(e),_e(I),_e(C),W.d()}}}function tl(t,e,n){let r,s,o;Ce(t,Xe,w=>n(14,s=w)),Ce(t,De,w=>n(15,o=w));let{privKey:c}=e,l,i,a,b,p,h,d,_,m;Le(De,o=Kt.CURVE.n,o);let y="sha384";const x={sha384:Or,sha3_384:pf,keccak_384:mf},S=Object.keys(x),k=w=>{n(13,y=w.detail)};return t.$$set=w=>{"privKey"in w&&n(12,c=w.privKey)},t.$$.update=()=>{if(t.$$.dirty&16384&&n(0,r=s.length>0),t.$$.dirty&4096){const w=Kt.getPublicKey(c),v=Kt.ProjectivePoint.fromHex(w);n(1,[l,i]=[v.x,v.y].map(A=>Ue(A)),l,(n(2,i),n(12,c))),n(3,a=v.toHex(!0)),n(4,b=v.toHex(!1))}if(t.$$.dirty&28673&&r){const w=x[y],v=w(s),A=Kt.sign(v,c);n(5,[p,h]=[A.r,A.s].map(G=>Ue(G)),p,(n(6,h),n(0,r),n(13,y),n(14,s),n(12,c))),n(7,d=A.toCompactHex()),n(8,_=A.toDERHex()),n(9,m=Ke(v))}},[r,l,i,a,b,p,h,d,_,m,S,k,c,y,s]}class nl extends Ze{constructor(e){super(),Ge(this,e,tl,el,Me,{privKey:12})}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const rl=BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),hn=wt(rl),wc=hn.create(BigInt("-3")),Ec=BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),sl=nn(hn,{A:wc,B:Ec,Z:hn.create(BigInt("-4"))}),jt=gn({a:wc,b:Ec,Fp:hn,n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650"),h:BigInt(1),lowS:!1,allowedPrivateKeyLengths:[130,131,132]},rn),cl=jt;Tt(cl.ProjectivePoint,t=>sl(t[0]),{DST:"P521_XMD:SHA-512_SSWU_RO_",encodeDST:"P521_XMD:SHA-512_SSWU_NU_",p:hn.ORDER,m:1,k:256,expand:"xmd",hash:rn});function Jr(t,e,n){const r=t.slice();return r[17]=e[n],r[19]=n,r}function es(t){let e,n;return e=new xn({props:{hash:t[17],checked:t[19]===0}}),e.$on("change",t[11]),{c(){ge(e.$$.fragment)},m(r,s){pe(e,r,s),n=!0},p:ve,i(r){n||(ne(e.$$.fragment,r),n=!0)},o(r){oe(e.$$.fragment,r),n=!1},d(r){_e(e,r)}}}function ol(t){let e,n,r=t[10],s=[];for(let c=0;c<r.length;c+=1)s[c]=es(Jr(t,r,c));const o=c=>oe(s[c],1,1,()=>{s[c]=null});return{c(){for(let c=0;c<s.length;c+=1)s[c].c();e=dt()},m(c,l){for(let i=0;i<s.length;i+=1)s[i].m(c,l);V(c,e,l),n=!0},p(c,l){if(l&3072){r=c[10];let i;for(i=0;i<r.length;i+=1){const a=Jr(c,r,i);s[i]?(s[i].p(a,l),ne(s[i],1)):(s[i]=es(a),s[i].c(),ne(s[i],1),s[i].m(e.parentNode,e))}for(lt(),i=r.length;i<s.length;i+=1)o(i);it()}},i(c){if(!n){for(let l=0;l<r.length;l+=1)ne(s[l]);n=!0}},o(c){s=s.filter(Boolean);for(let l=0;l<s.length;l+=1)oe(s[l]);n=!1},d(c){ut(s,c),c&&j(e)}}}function fl(t){let e;return{c(){e=u("p"),e.textContent=`${ze.NO_MESSAGE}`},m(n,r){V(n,e,r)},p:ve,d(n){n&&j(e)}}}function ll(t){let e,n,r,s,o,c,l,i,a,b,p,h,d,_,m,y,x,S,k,w,v,A,G,T,H,D,R,N,Z,M,P;return{c(){e=u("table"),n=u("tbody"),r=u("tr"),s=u("td"),s.textContent="msgHash",o=u("td"),c=u("code"),l=F(t[9]),i=O(),a=u("tr"),b=u("td"),b.textContent="r",p=u("td"),h=u("code"),d=F(t[5]),_=O(),m=u("tr"),y=u("td"),y.textContent="s",x=u("td"),S=u("code"),k=F(t[6]),w=O(),v=u("tr"),A=u("td"),A.textContent="compact",G=u("td"),T=u("code"),H=F(t[7]),D=O(),R=u("tr"),N=u("td"),N.textContent="der",Z=u("td"),M=u("code"),P=F(t[8]),g(s,"class","curve-data__key"),g(b,"class","curve-data__key"),g(y,"class","curve-data__key"),g(A,"class","curve-data__key"),g(N,"class","curve-data__key"),g(e,"class","curve-data__table")},m(I,B){V(I,e,B),f(e,n),f(n,r),f(r,s),f(r,o),f(o,c),f(c,l),f(n,i),f(n,a),f(a,b),f(a,p),f(p,h),f(h,d),f(n,_),f(n,m),f(m,y),f(m,x),f(x,S),f(S,k),f(n,w),f(n,v),f(v,A),f(v,G),f(G,T),f(T,H),f(n,D),f(n,R),f(R,N),f(R,Z),f(Z,M),f(M,P)},p(I,B){B&512&&Q(l,I[9]),B&32&&Q(d,I[5]),B&64&&Q(k,I[6]),B&128&&Q(H,I[7]),B&256&&Q(P,I[8])},d(I){I&&j(e)}}}function il(t){let e,n,r,s,o,c,l,i,a,b,p,h,d,_,m,y,x,S,k,w,v,A,G,T,H,D,R,N,Z,M,P,I,B,C,q,U;I=new Et({}),C=new yn({props:{$$slots:{default:[ol]},$$scope:{ctx:t}}});function z(L,Y){return L[0]?ll:fl}let X=z(t),W=X(t);return{c(){e=u("div"),n=u("h3"),n.textContent="Public key",r=O(),s=u("table"),o=u("tbody"),c=u("tr"),l=u("td"),l.textContent="x",i=u("td"),a=u("code"),b=F(t[1]),p=O(),h=u("tr"),d=u("td"),d.textContent="y",_=u("td"),m=u("code"),y=F(t[2]),x=O(),S=u("tr"),k=u("td"),k.textContent="33b hex",w=u("td"),v=u("code"),A=F(t[3]),G=O(),T=u("tr"),H=u("td"),H.textContent="64b hex",D=u("td"),R=u("code"),N=F(t[4]),Z=O(),M=u("h3"),M.textContent="Signature",P=O(),ge(I.$$.fragment),B=O(),ge(C.$$.fragment),q=O(),W.c(),g(n,"class","curve-data__header"),g(l,"class","curve-data__key"),g(d,"class","curve-data__key"),g(k,"class","curve-data__key"),g(H,"class","curve-data__key"),g(s,"class","curve-data__table"),g(M,"class","curve-data__header"),g(e,"class","curve-data")},m(L,Y){V(L,e,Y),f(e,n),f(e,r),f(e,s),f(s,o),f(o,c),f(c,l),f(c,i),f(i,a),f(a,b),f(o,p),f(o,h),f(h,d),f(h,_),f(_,m),f(m,y),f(o,x),f(o,S),f(S,k),f(S,w),f(w,v),f(v,A),f(o,G),f(o,T),f(T,H),f(T,D),f(D,R),f(R,N),f(e,Z),f(e,M),f(e,P),pe(I,e,null),f(e,B),pe(C,e,null),f(e,q),W.m(e,null),U=!0},p(L,[Y]){(!U||Y&2)&&Q(b,L[1]),(!U||Y&4)&&Q(y,L[2]),(!U||Y&8)&&Q(A,L[3]),(!U||Y&16)&&Q(N,L[4]);const $={};Y&1048576&&($.$$scope={dirty:Y,ctx:L}),C.$set($),X===(X=z(L))&&W?W.p(L,Y):(W.d(1),W=X(L),W&&(W.c(),W.m(e,null)))},i(L){U||(ne(I.$$.fragment,L),ne(C.$$.fragment,L),U=!0)},o(L){oe(I.$$.fragment,L),oe(C.$$.fragment,L),U=!1},d(L){L&&j(e),_e(I),_e(C),W.d()}}}function al(t,e,n){let r,s,o;Ce(t,Xe,w=>n(14,s=w)),Ce(t,De,w=>n(15,o=w));let{privKey:c}=e,l,i,a,b,p,h,d,_,m;Le(De,o=jt.CURVE.n,o);let y="sha512";const x={sha512:rn,sha3_512:_f,keccak_512:gf},S=Object.keys(x),k=w=>{n(13,y=w.detail)};return t.$$set=w=>{"privKey"in w&&n(12,c=w.privKey)},t.$$.update=()=>{if(t.$$.dirty&16384&&n(0,r=s.length>0),t.$$.dirty&4096){const w=jt.getPublicKey(c),v=jt.ProjectivePoint.fromHex(w);n(1,[l,i]=[v.x,v.y].map(A=>Ue(A)),l,(n(2,i),n(12,c))),n(3,a=v.toHex(!0)),n(4,b=v.toHex(!1))}if(t.$$.dirty&28673&&r){const w=x[y],v=w(s),A=jt.sign(v,c);n(5,[p,h]=[A.r,A.s].map(G=>Ue(G)),p,(n(6,h),n(0,r),n(13,y),n(14,s),n(12,c))),n(7,d=A.toCompactHex()),n(8,_=A.toDERHex()),n(9,m=Ke(v))}},[r,l,i,a,b,p,h,d,_,m,S,k,c,y,s]}class ul extends Ze{constructor(e){super(),Ge(this,e,al,il,Me,{privKey:12})}}function dl(t){let e;return{c(){e=u("p"),e.textContent=`${ze.NO_MESSAGE}`},m(n,r){V(n,e,r)},p:ve,d(n){n&&j(e)}}}function bl(t){let e,n,r,s,o,c,l,i,a,b,p,h,d,_,m,y,x,S,k;return{c(){e=u("table"),n=u("tbody"),r=u("tr"),s=u("td"),s.textContent="msg",o=u("td"),c=u("code"),l=F(t[1]),i=O(),a=u("tr"),b=u("td"),b.textContent="auxRand",p=u("td"),h=u("code"),d=F(t[2]),_=O(),m=u("tr"),y=u("td"),y.textContent="sigHex",x=u("td"),S=u("code"),k=F(t[3]),g(s,"class","curve-data__key"),g(b,"class","curve-data__key"),g(y,"class","curve-data__key"),g(e,"class","curve-data__table")},m(w,v){V(w,e,v),f(e,n),f(n,r),f(r,s),f(r,o),f(o,c),f(c,l),f(n,i),f(n,a),f(a,b),f(a,p),f(p,h),f(h,d),f(n,_),f(n,m),f(m,y),f(m,x),f(x,S),f(S,k)},p(w,v){v&2&&Q(l,w[1]),v&4&&Q(d,w[2]),v&8&&Q(k,w[3])},d(w){w&&j(e)}}}function hl(t){let e,n,r,s,o,c;s=new Et({});function l(b,p){return b[0]?bl:dl}let i=l(t),a=i(t);return{c(){e=u("div"),n=u("h3"),n.textContent="Signature",r=O(),ge(s.$$.fragment),o=O(),a.c(),g(n,"class","curve-data__header"),g(e,"class","curve-data")},m(b,p){V(b,e,p),f(e,n),f(e,r),pe(s,e,null),f(e,o),a.m(e,null),c=!0},p(b,[p]){i===(i=l(b))&&a?a.p(b,p):(a.d(1),a=i(b),a&&(a.c(),a.m(e,null)))},i(b){c||(ne(s.$$.fragment,b),c=!0)},o(b){oe(s.$$.fragment,b),c=!1},d(b){b&&j(e),_e(s),a.d()}}}function pl(t,e,n){let r,s,o;Ce(t,Xe,b=>n(5,s=b)),Ce(t,De,b=>n(6,o=b));let{privKey:c}=e,l,i,a;return Le(De,o=Ve.CURVE.n,o),t.$$set=b=>{"privKey"in b&&n(4,c=b.privKey)},t.$$.update=()=>{if(t.$$.dirty&32&&n(0,r=s.length>0),t.$$.dirty&49&&r){const b=en(s),p=Lt(),h=Lo.sign(b,c,p);n(1,l=Ke(b)),n(2,i=Ke(p)),n(3,a=Ke(h))}},[r,l,i,a,c,s]}class _l extends Ze{constructor(e){super(),Ge(this,e,pl,hl,Me,{privKey:4})}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _t=BigInt(0),et=BigInt(1),Bn=BigInt(2),ml=BigInt(8);function gl(t){const e=vr(t);return qt(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function vn(t){const e=gl(t),{Fp:n,n:r,preHash:s,hash:o,randomBytes:c,nByteLength:l,h:i}=e,a=Bn**BigInt(l*8),b=n.create,p=e.uvRatio||((B,C)=>{try{return{isValid:!0,value:n.sqrt(B*n.inv(C))}}catch{return{isValid:!1,value:_t}}}),h=e.adjustScalarBytes||(B=>B),d=e.domain||((B,C,q)=>{if(C.length||q)throw new Error("Contexts/pre-hash are not supported");return B}),_=B=>typeof B=="bigint"&&0n<B,m=(B,C)=>_(B)&&_(C)&&B<C,y=B=>B===_t||m(B,a);function x(B,C){if(m(B,C))return B;throw new Error(`Expected valid scalar < ${C}, got ${typeof B} ${B}`)}function S(B){return B===_t?B:x(B,r)}const k=new Map;function w(B){if(!(B instanceof v))throw new Error("ExtendedPoint expected")}class v{constructor(C,q,U,z){if(this.ex=C,this.ey=q,this.ez=U,this.et=z,!y(C))throw new Error("x required");if(!y(q))throw new Error("y required");if(!y(U))throw new Error("z required");if(!y(z))throw new Error("t required")}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(C){if(C instanceof v)throw new Error("extended point not allowed");const{x:q,y:U}=C||{};if(!y(q)||!y(U))throw new Error("invalid affine point");return new v(q,U,et,b(q*U))}static normalizeZ(C){const q=n.invertBatch(C.map(U=>U.ez));return C.map((U,z)=>U.toAffine(q[z])).map(v.fromAffine)}_setWindowSize(C){this._WINDOW_SIZE=C,k.delete(this)}assertValidity(){const{a:C,d:q}=e;if(this.is0())throw new Error("bad point: ZERO");const{ex:U,ey:z,ez:X,et:W}=this,L=b(U*U),Y=b(z*z),$=b(X*X),se=b($*$),ie=b(L*C),be=b($*b(ie+Y)),de=b(se+b(q*b(L*Y)));if(be!==de)throw new Error("bad point: equation left != right (1)");const fe=b(U*z),me=b(X*W);if(fe!==me)throw new Error("bad point: equation left != right (2)")}equals(C){w(C);const{ex:q,ey:U,ez:z}=this,{ex:X,ey:W,ez:L}=C,Y=b(q*L),$=b(X*z),se=b(U*L),ie=b(W*z);return Y===$&&se===ie}is0(){return this.equals(v.ZERO)}negate(){return new v(b(-this.ex),this.ey,this.ez,b(-this.et))}double(){const{a:C}=e,{ex:q,ey:U,ez:z}=this,X=b(q*q),W=b(U*U),L=b(Bn*b(z*z)),Y=b(C*X),$=q+U,se=b(b($*$)-X-W),ie=Y+W,be=ie-L,de=Y-W,fe=b(se*be),me=b(ie*de),Be=b(se*de),Te=b(be*ie);return new v(fe,me,Te,Be)}add(C){w(C);const{a:q,d:U}=e,{ex:z,ey:X,ez:W,et:L}=this,{ex:Y,ey:$,ez:se,et:ie}=C;if(q===BigInt(-1)){const Ne=b((X-z)*($+Y)),Ft=b((X+z)*($-Y)),ue=b(Ft-Ne);if(ue===_t)return this.double();const ae=b(W*Bn*ie),ce=b(L*Bn*se),Se=ce+ae,st=Ft+Ne,Qe=ce-ae,je=b(Se*ue),J=b(st*Qe),xe=b(Se*Qe),pt=b(ue*st);return new v(je,J,pt,xe)}const be=b(z*Y),de=b(X*$),fe=b(L*U*ie),me=b(W*se),Be=b((z+X)*(Y+$)-be-de),Te=me-fe,ct=me+fe,$e=b(de-q*be),bt=b(Be*Te),Yt=b(ct*$e),sn=b(Be*$e),ht=b(Te*ct);return new v(bt,Yt,ht,sn)}subtract(C){return this.add(C.negate())}wNAF(C){return T.wNAFCached(this,k,C,v.normalizeZ)}multiply(C){const{p:q,f:U}=this.wNAF(x(C,r));return v.normalizeZ([q,U])[0]}multiplyUnsafe(C){let q=S(C);return q===_t?G:this.equals(G)||q===et?this:this.equals(A)?this.wNAF(q).p:T.unsafeLadder(this,q)}isSmallOrder(){return this.multiplyUnsafe(i).is0()}isTorsionFree(){return T.unsafeLadder(this,r).is0()}toAffine(C){const{ex:q,ey:U,ez:z}=this,X=this.is0();C==null&&(C=X?ml:n.inv(z));const W=b(q*C),L=b(U*C),Y=b(z*C);if(X)return{x:_t,y:et};if(Y!==et)throw new Error("invZ was invalid");return{x:W,y:L}}clearCofactor(){const{h:C}=e;return C===et?this:this.multiplyUnsafe(C)}static fromHex(C,q=!0){const{d:U,a:z}=e,X=n.BYTES;C=Ee("pointHex",C,X);const W=C.slice(),L=C[X-1];W[X-1]=L&-129;const Y=xt(W);Y===_t||(q?x(Y,n.ORDER):x(Y,a));const $=b(Y*Y),se=b($-et),ie=b(U*$-z);let{isValid:be,value:de}=p(se,ie);if(!be)throw new Error("Point.fromHex: invalid y coordinate");const fe=(de&et)===et;return(L&128)!==0!==fe&&(de=b(-de)),v.fromAffine({x:de,y:Y})}static fromPrivateKey(C){return R(C).point}toRawBytes(){const{x:C,y:q}=this.toAffine(),U=zt(q,n.BYTES);return U[U.length-1]|=C&et?128:0,U}toHex(){return Ht(this.toRawBytes())}}v.BASE=new v(e.Gx,e.Gy,et,b(e.Gx*e.Gy)),v.ZERO=new v(_t,et,et,_t);const{BASE:A,ZERO:G}=v,T=sc(v,l*8);function H(B){return ye(B,r)}function D(B){return H(xt(B))}function R(B){const C=l;B=Ee("private key",B,C);const q=Ee("hashed private key",o(B),2*C),U=h(q.slice(0,C)),z=q.slice(C,2*C),X=D(U),W=A.multiply(X),L=W.toRawBytes();return{head:U,prefix:z,scalar:X,point:W,pointBytes:L}}function N(B){return R(B).pointBytes}function Z(B=new Uint8Array,...C){const q=Ie(...C);return D(o(d(q,Ee("context",B),!!s)))}function M(B,C,q){B=Ee("message",B),s&&(B=s(B));const{prefix:U,scalar:z,pointBytes:X}=R(C),W=Z(q,U,B),L=A.multiply(W).toRawBytes(),Y=Z(q,L,X,B),$=H(W+Y*z);S($);const se=Ie(L,zt($,n.BYTES));return Ee("result",se,l*2)}function P(B,C,q,U){const z=n.BYTES;B=Ee("signature",B,2*z),C=Ee("message",C),s&&(C=s(C));const X=v.fromHex(q,!1),W=v.fromHex(B.slice(0,z),!1),L=xt(B.slice(z,2*z)),Y=A.multiplyUnsafe(L),$=Z(U,W.toRawBytes(),X.toRawBytes(),C);return W.add(X.multiplyUnsafe($)).subtract(Y).clearCofactor().equals(v.ZERO)}return A._setWindowSize(8),{CURVE:e,getPublicKey:N,sign:M,verify:P,ExtendedPoint:v,utils:{getExtendedPublicKey:R,randomPrivateKey:()=>c(n.BYTES),precompute(B=8,C=v.BASE){return C._setWindowSize(B),C.multiply(BigInt(3)),C}}}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const on=BigInt(0),Yn=BigInt(1);function yl(t){return qt(t,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...t})}function Bc(t){const e=yl(t),{P:n}=e,r=k=>ye(k,n),s=e.montgomeryBits,o=Math.ceil(s/8),c=e.nByteLength,l=e.adjustScalarBytes||(k=>k),i=e.powPminus2||(k=>tc(k,n-BigInt(2),n));function a(k,w,v){const A=r(k*(w-v));return w=r(w-A),v=r(v+A),[w,v]}function b(k){if(typeof k=="bigint"&&on<=k&&k<n)return k;throw new Error("Expected valid scalar 0 < scalar < CURVE.P")}const p=(e.a-BigInt(2))/BigInt(4);function h(k,w){const v=b(k),A=b(w),G=v;let T=Yn,H=on,D=v,R=Yn,N=on,Z;for(let P=BigInt(s-1);P>=on;P--){const I=A>>P&Yn;N^=I,Z=a(N,T,D),T=Z[0],D=Z[1],Z=a(N,H,R),H=Z[0],R=Z[1],N=I;const B=T+H,C=r(B*B),q=T-H,U=r(q*q),z=C-U,X=D+R,W=D-R,L=r(W*B),Y=r(X*q),$=L+Y,se=L-Y;D=r($*$),R=r(G*r(se*se)),T=r(C*U),H=r(z*(C+r(p*z)))}Z=a(N,T,D),T=Z[0],D=Z[1],Z=a(N,H,R),H=Z[0],R=Z[1];const M=i(H);return r(T*M)}function d(k){return zt(r(k),o)}function _(k){const w=Ee("u coordinate",k,o);return c===o&&(w[c-1]&=127),xt(w)}function m(k){const w=Ee("scalar",k);if(w.length!==o&&w.length!==c)throw new Error(`Expected ${o} or ${c} bytes, got ${w.length}`);return xt(l(w))}function y(k,w){const v=_(w),A=m(k),G=h(v,A);if(G===on)throw new Error("Invalid private or public key received");return d(G)}const x=d(e.Gu);function S(k){return y(k,x)}return{scalarMult:y,scalarMultBase:S,getSharedSecret:(k,w)=>y(k,w),getPublicKey:k=>S(k),utils:{randomPrivateKey:()=>e.randomBytes(e.nByteLength)},GuBytes:x}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const pn=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),ts=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),xl=BigInt(0),yt=BigInt(1),Hn=BigInt(2),vl=BigInt(5),ns=BigInt(10),wl=BigInt(20),El=BigInt(40),rs=BigInt(80);function kc(t){const e=pn,r=t*t%e*t%e,s=we(r,Hn,e)*r%e,o=we(s,yt,e)*t%e,c=we(o,vl,e)*o%e,l=we(c,ns,e)*c%e,i=we(l,wl,e)*l%e,a=we(i,El,e)*i%e,b=we(a,rs,e)*a%e,p=we(b,rs,e)*a%e,h=we(p,ns,e)*c%e;return{pow_p_5_8:we(h,Hn,e)*t%e,b2:r}}function Sc(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function Pr(t,e){const n=pn,r=ye(e*e*e,n),s=ye(r*r*e,n),o=kc(t*s).pow_p_5_8;let c=ye(t*r*o,n);const l=ye(e*c*c,n),i=c,a=ye(c*ts,n),b=l===t,p=l===ye(-t,n),h=l===ye(-t*ts,n);return b&&(c=i),(p||h)&&(c=a),At(c,n)&&(c=ye(-c,n)),{isValid:b||p,value:c}}const re=wt(pn,void 0,!0),Rr={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:re,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:rn,randomBytes:Lt,adjustScalarBytes:Sc,uvRatio:Pr},Ae=vn(Rr);function Ic(t,e,n){if(e.length>255)throw new Error("Context is too big");return _r(en("SigEd25519 no Ed25519 collisions"),new Uint8Array([n?1:0,e.length]),e,t)}vn({...Rr,domain:Ic});vn({...Rr,domain:Ic,preHash:rn});Bc({P:pn,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:t=>{const e=pn,{pow_p_5_8:n,b2:r}=kc(t);return ye(we(n,BigInt(3),e)*r,e)},adjustScalarBytes:Sc,randomBytes:Lt});const Bl=(re.ORDER+BigInt(3))/BigInt(8),kl=re.pow(Hn,Bl),ss=re.sqrt(re.neg(re.ONE)),Sl=(re.ORDER-BigInt(5))/BigInt(8),cs=BigInt(486662);function Il(t){let e=re.sqr(t);e=re.mul(e,Hn);let n=re.add(e,re.ONE),r=re.neg(cs),s=re.sqr(n),o=re.mul(s,n),c=re.mul(e,cs);c=re.mul(c,r),c=re.add(c,s),c=re.mul(c,r);let l=re.sqr(o);s=re.sqr(l),l=re.mul(l,o),l=re.mul(l,c),s=re.mul(s,l);let i=re.pow(s,Sl);i=re.mul(i,l);let a=re.mul(i,ss);s=re.sqr(i),s=re.mul(s,o);let b=re.eql(s,c),p=re.cmov(a,i,b),h=re.mul(r,e),d=re.mul(i,t);d=re.mul(d,kl);let _=re.mul(d,ss),m=re.mul(c,e);s=re.sqr(d),s=re.mul(s,o);let y=re.eql(s,m),x=re.cmov(_,d,y);s=re.sqr(p),s=re.mul(s,o);let S=re.eql(s,c),k=re.cmov(h,r,S),w=re.cmov(x,p,S),v=re.isOdd(w);return w=re.cmov(w,re.neg(w),S!==v),{xMn:k,xMd:n,yMn:w,yMd:1n}}const Cl=go(re,re.neg(BigInt(486664)));function Al(t){const{xMn:e,xMd:n,yMn:r,yMd:s}=Il(t);let o=re.mul(e,s);o=re.mul(o,Cl);let c=re.mul(n,r),l=re.sub(e,n),i=re.add(e,n),a=re.mul(c,i),b=re.eql(a,re.ZERO);o=re.cmov(o,re.ZERO,b),c=re.cmov(c,re.ONE,b),l=re.cmov(l,re.ONE,b),i=re.cmov(i,re.ONE,b);const p=re.invertBatch([c,i]);return{x:re.mul(o,p[0]),y:re.mul(l,p[1])}}Tt(Ae.ExtendedPoint,t=>Al(t[0]),{DST:"edwards25519_XMD:SHA-512_ELL2_RO_",encodeDST:"edwards25519_XMD:SHA-512_ELL2_NU_",p:re.ORDER,m:1,k:128,expand:"xmd",hash:rn});function Fn(t){if(!(t instanceof Ye))throw new Error("RistrettoPoint expected")}const dr=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),Ol=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),Pl=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),Rl=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),Hl=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),os=t=>Pr(yt,t),Tl=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),Wn=t=>Ae.CURVE.Fp.create(xt(t)&Tl);function fs(t){const{d:e}=Ae.CURVE,n=Ae.CURVE.Fp.ORDER,r=Ae.CURVE.Fp.create,s=r(dr*t*t),o=r((s+yt)*Rl);let c=BigInt(-1);const l=r((c-e*s)*r(s+e));let{isValid:i,value:a}=Pr(o,l),b=r(a*t);At(b,n)||(b=r(-b)),i||(a=b),i||(c=s);const p=r(c*(s-yt)*Hl-l),h=a*a,d=r((a+a)*l),_=r(p*Ol),m=r(yt-h),y=r(yt+h);return new Ae.ExtendedPoint(r(d*y),r(m*_),r(_*y),r(d*m))}class Ye{constructor(e){this.ep=e}static fromAffine(e){return new Ye(Ae.ExtendedPoint.fromAffine(e))}static hashToCurve(e){e=Ee("ristrettoHash",e,64);const n=Wn(e.slice(0,32)),r=fs(n),s=Wn(e.slice(32,64)),o=fs(s);return new Ye(r.add(o))}static fromHex(e){e=Ee("ristrettoHex",e,32);const{a:n,d:r}=Ae.CURVE,s=Ae.CURVE.Fp.ORDER,o=Ae.CURVE.Fp.create,c="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",l=Wn(e);if(!Js(zt(l,32),e)||At(l,s))throw new Error(c);const i=o(l*l),a=o(yt+n*i),b=o(yt-n*i),p=o(a*a),h=o(b*b),d=o(n*r*p-h),{isValid:_,value:m}=os(o(d*h)),y=o(m*b),x=o(m*y*d);let S=o((l+l)*y);At(S,s)&&(S=o(-S));const k=o(a*x),w=o(S*k);if(!_||At(w,s)||k===xl)throw new Error(c);return new Ye(new Ae.ExtendedPoint(S,k,yt,w))}toRawBytes(){let{ex:e,ey:n,ez:r,et:s}=this.ep;const o=Ae.CURVE.Fp.ORDER,c=Ae.CURVE.Fp.create,l=c(c(r+n)*c(r-n)),i=c(e*n),a=c(i*i),{value:b}=os(c(l*a)),p=c(b*l),h=c(b*i),d=c(p*h*s);let _;if(At(s*d,o)){let y=c(n*dr),x=c(e*dr);e=y,n=x,_=c(p*Pl)}else _=h;At(e*d,o)&&(n=c(-n));let m=c((r-n)*_);return At(m,o)&&(m=c(-m)),zt(m,32)}toHex(){return Ht(this.toRawBytes())}toString(){return this.toHex()}equals(e){Fn(e);const{ex:n,ey:r}=this.ep,{ex:s,ey:o}=e.ep,c=Ae.CURVE.Fp.create,l=c(n*o)===c(r*s),i=c(r*o)===c(n*s);return l||i}add(e){return Fn(e),new Ye(this.ep.add(e.ep))}subtract(e){return Fn(e),new Ye(this.ep.subtract(e.ep))}multiply(e){return new Ye(this.ep.multiply(e))}multiplyUnsafe(e){return new Ye(this.ep.multiplyUnsafe(e))}}Ye.BASE=new Ye(Ae.ExtendedPoint.BASE);Ye.ZERO=new Ye(Ae.ExtendedPoint.ZERO);function Nl(t){let e;return{c(){e=u("p"),e.textContent=`${ze.NO_MESSAGE}`},m(n,r){V(n,e,r)},p:ve,d(n){n&&j(e)}}}function Ll(t){let e,n,r,s,o,c,l,i,a,b,p,h,d;return{c(){e=u("table"),n=u("tbody"),r=u("tr"),s=u("td"),s.textContent="msg",o=u("td"),c=u("code"),l=F(t[4]),i=O(),a=u("tr"),b=u("td"),b.textContent="sigHex",p=u("td"),h=u("code"),d=F(t[5]),g(s,"class","curve-data__key"),g(b,"class","curve-data__key"),g(e,"class","curve-data__table")},m(_,m){V(_,e,m),f(e,n),f(n,r),f(r,s),f(r,o),f(o,c),f(c,l),f(n,i),f(n,a),f(a,b),f(a,p),f(p,h),f(h,d)},p(_,m){m&16&&Q(l,_[4]),m&32&&Q(d,_[5])},d(_){_&&j(e)}}}function ql(t){let e,n,r,s,o,c,l,i,a,b,p,h,d,_,m,y,x,S,k,w,v,A,G,T,H,D,R,N;D=new Et({});function Z(I,B){return I[0]?Ll:Nl}let M=Z(t),P=M(t);return{c(){e=u("div"),n=u("h3"),n.textContent="Public key",r=O(),s=u("table"),o=u("tbody"),c=u("tr"),l=u("td"),l.textContent="x",i=u("td"),a=u("code"),b=F(t[1]),p=O(),h=u("tr"),d=u("td"),d.textContent="y",_=u("td"),m=u("code"),y=F(t[2]),x=O(),S=u("tr"),k=u("td"),k.textContent="hex",w=u("td"),v=u("code"),A=F(t[3]),G=O(),T=u("h3"),T.textContent="Signature",H=O(),ge(D.$$.fragment),R=O(),P.c(),g(n,"class","curve-data__header"),g(l,"class","curve-data__key"),g(d,"class","curve-data__key"),g(k,"class","curve-data__key"),g(s,"class","curve-data__table"),g(T,"class","curve-data__header"),g(e,"class","curve-data")},m(I,B){V(I,e,B),f(e,n),f(e,r),f(e,s),f(s,o),f(o,c),f(c,l),f(c,i),f(i,a),f(a,b),f(o,p),f(o,h),f(h,d),f(h,_),f(_,m),f(m,y),f(o,x),f(o,S),f(S,k),f(S,w),f(w,v),f(v,A),f(e,G),f(e,T),f(e,H),pe(D,e,null),f(e,R),P.m(e,null),N=!0},p(I,[B]){(!N||B&2)&&Q(b,I[1]),(!N||B&4)&&Q(y,I[2]),(!N||B&8)&&Q(A,I[3]),M===(M=Z(I))&&P?P.p(I,B):(P.d(1),P=M(I),P&&(P.c(),P.m(e,null)))},i(I){N||(ne(D.$$.fragment,I),N=!0)},o(I){oe(D.$$.fragment,I),N=!1},d(I){I&&j(e),_e(D),P.d()}}}function Ul(t,e,n){let r,s,o;Ce(t,Xe,h=>n(7,s=h)),Ce(t,De,h=>n(8,o=h));let{privKey:c}=e,l,i,a,b,p;return Le(De,o=Ae.CURVE.n,o),t.$$set=h=>{"privKey"in h&&n(6,c=h.privKey)},t.$$.update=()=>{if(t.$$.dirty&128&&n(0,r=s.length>0),t.$$.dirty&193){const h=Ae.getPublicKey(c),d=Ae.ExtendedPoint.fromHex(h);if(n(1,[l,i]=[d.x,d.y].map(_=>Ue(_)),l,(n(2,i),n(6,c),n(0,r),n(7,s))),n(3,a=d.toHex()),r){const _=en(s),m=Ae.sign(_,c);n(4,b=Ke(_)),n(5,p=Ke(m))}}},[r,l,i,a,b,p,c,s]}class Ml extends Ze{constructor(e){super(),Ge(this,e,Ul,ql,Me,{privKey:6})}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Dl=vt(()=>Ar.create({dkLen:114})),Gl=vt(()=>Ar.create({dkLen:64})),_n=BigInt("726838724295606890549323807888004534353641360687318060281490199180612328166730772686396383698676545930088884461843637361053498018365439");function Cc(t){const e=_n,n=BigInt(1),r=BigInt(2),s=BigInt(3),o=BigInt(11),c=BigInt(22),l=BigInt(44),i=BigInt(88),a=BigInt(223),b=t*t*t%e,p=b*b*t%e,h=we(p,s,e)*p%e,d=we(h,s,e)*p%e,_=we(d,r,e)*b%e,m=we(_,o,e)*_%e,y=we(m,c,e)*m%e,x=we(y,l,e)*y%e,S=we(x,i,e)*x%e,k=we(S,l,e)*y%e,w=we(k,r,e)*b%e,v=we(w,n,e)*t%e;return we(v,a,e)*w%e}function Ac(t){return t[0]&=252,t[55]|=128,t[56]=0,t}const ee=wt(_n,456,!0),Oc={a:BigInt(1),d:BigInt("726838724295606890549323807888004534353641360687318060281490199180612328166730772686396383698676545930088884461843637361053498018326358"),Fp:ee,n:BigInt("181709681073901722637330951972001133588410340171829515070372549795146003961539585716195755291692375963310293709091662304773755859649779"),nBitLength:456,h:BigInt(4),Gx:BigInt("224580040295924300187604334099896036246789641632564134246125461686950415467406032909029192869357953282578032075146446173674602635247710"),Gy:BigInt("298819210078481492676017930443930673437544040154080242095928241372331506189835876003536878655418784733982303233503462500531545062832660"),hash:Dl,randomBytes:Lt,adjustScalarBytes:Ac,domain:(t,e,n)=>{if(e.length>255)throw new Error(`Context is too big: ${e.length}`);return _r(en("SigEd448"),new Uint8Array([n?1:0,e.length]),e,t)},uvRatio:(t,e)=>{const n=_n,r=ye(t*t*e,n),s=ye(r*t,n),o=ye(s*r*e,n),c=Cc(o),l=ye(s*c,n),i=ye(l*l,n);return{isValid:ye(i*e,n)===t,value:l}}},Vt=vn(Oc);vn({...Oc,preHash:Gl});Bc({a:BigInt(156326),montgomeryBits:448,nByteLength:57,P:_n,Gu:BigInt(5),powPminus2:t=>{const e=_n,n=Cc(t),r=we(n,BigInt(2),e);return ye(r*t,e)},adjustScalarBytes:Ac,randomBytes:Lt});const Zl=(ee.ORDER-BigInt(3))/BigInt(4),ls=BigInt(156326);function Kl(t){let e=ee.sqr(t),n=ee.eql(e,ee.ONE);e=ee.cmov(e,ee.ZERO,n);let r=ee.sub(ee.ONE,e),s=ee.neg(ls),o=ee.sqr(r),c=ee.mul(o,r),l=ee.mul(e,ee.neg(ls));l=ee.mul(l,s),l=ee.add(l,o),l=ee.mul(l,s);let i=ee.sqr(c);o=ee.mul(l,c),i=ee.mul(i,o);let a=ee.pow(i,Zl);a=ee.mul(a,o);let b=ee.mul(s,ee.neg(e)),p=ee.mul(a,t);p=ee.cmov(p,ee.ZERO,n),o=ee.sqr(a),o=ee.mul(o,c);let h=ee.eql(o,l),d=ee.cmov(b,s,h),_=ee.cmov(p,a,h),m=ee.isOdd(_);return _=ee.cmov(_,ee.neg(_),h!==m),{xn:d,xd:r,yn:_,yd:ee.ONE}}function jl(t){let{xn:e,xd:n,yn:r,yd:s}=Kl(t),o=ee.sqr(e),c=ee.sqr(n),l=ee.sqr(c),i=ee.sqr(r),a=ee.sqr(s),b=ee.sub(o,c),p=ee.sub(b,c);b=ee.mul(b,c),b=ee.mul(b,s),b=ee.mul(b,r),b=ee.mul(b,4n),p=ee.mul(p,o),p=ee.mul(p,a);let h=ee.mul(i,4n),d=ee.add(h,a);d=ee.mul(d,l);let _=ee.add(d,p);p=ee.mul(p,e);let m=ee.mul(e,l),y=ee.sub(h,a);y=ee.mul(y,m),y=ee.sub(y,p),d=ee.add(o,c),d=ee.mul(d,c),d=ee.mul(d,n),d=ee.mul(d,i),d=ee.mul(d,BigInt(-2));let x=ee.add(p,d);m=ee.mul(m,a),x=ee.add(x,m),d=ee.mul(_,x);let S=ee.eql(d,ee.ZERO);b=ee.cmov(b,ee.ZERO,S),_=ee.cmov(_,ee.ONE,S),y=ee.cmov(y,ee.ONE,S),x=ee.cmov(x,ee.ONE,S);const k=ee.invertBatch([_,x]);return{x:ee.mul(b,k[0]),y:ee.mul(y,k[1])}}Tt(Vt.ExtendedPoint,t=>jl(t[0]),{DST:"edwards448_XOF:SHAKE256_ELL2_RO_",encodeDST:"edwards448_XOF:SHAKE256_ELL2_NU_",p:ee.ORDER,m:1,k:224,expand:"xof",hash:Ar});function Vl(t){let e;return{c(){e=u("p"),e.textContent=`${ze.NO_MESSAGE}`},m(n,r){V(n,e,r)},p:ve,d(n){n&&j(e)}}}function zl(t){let e,n,r,s,o,c,l,i,a,b,p,h,d;return{c(){e=u("table"),n=u("tbody"),r=u("tr"),s=u("td"),s.textContent="msg",o=u("td"),c=u("code"),l=F(t[4]),i=O(),a=u("tr"),b=u("td"),b.textContent="sigHex",p=u("td"),h=u("code"),d=F(t[5]),g(s,"class","curve-data__key"),g(b,"class","curve-data__key"),g(e,"class","curve-data__table")},m(_,m){V(_,e,m),f(e,n),f(n,r),f(r,s),f(r,o),f(o,c),f(c,l),f(n,i),f(n,a),f(a,b),f(a,p),f(p,h),f(h,d)},p(_,m){m&16&&Q(l,_[4]),m&32&&Q(d,_[5])},d(_){_&&j(e)}}}function Yl(t){let e,n,r,s,o,c,l,i,a,b,p,h,d,_,m,y,x,S,k,w,v,A,G,T,H,D,R,N;D=new Et({});function Z(I,B){return I[0]?zl:Vl}let M=Z(t),P=M(t);return{c(){e=u("div"),n=u("h3"),n.textContent="Public key",r=O(),s=u("table"),o=u("tbody"),c=u("tr"),l=u("td"),l.textContent="x",i=u("td"),a=u("code"),b=F(t[1]),p=O(),h=u("tr"),d=u("td"),d.textContent="y",_=u("td"),m=u("code"),y=F(t[2]),x=O(),S=u("tr"),k=u("td"),k.textContent="hex",w=u("td"),v=u("code"),A=F(t[3]),G=O(),T=u("h3"),T.textContent="Signature",H=O(),ge(D.$$.fragment),R=O(),P.c(),g(n,"class","curve-data__header"),g(l,"class","curve-data__key"),g(d,"class","curve-data__key"),g(k,"class","curve-data__key"),g(s,"class","curve-data__table"),g(T,"class","curve-data__header"),g(e,"class","curve-data")},m(I,B){V(I,e,B),f(e,n),f(e,r),f(e,s),f(s,o),f(o,c),f(c,l),f(c,i),f(i,a),f(a,b),f(o,p),f(o,h),f(h,d),f(h,_),f(_,m),f(m,y),f(o,x),f(o,S),f(S,k),f(S,w),f(w,v),f(v,A),f(e,G),f(e,T),f(e,H),pe(D,e,null),f(e,R),P.m(e,null),N=!0},p(I,[B]){(!N||B&2)&&Q(b,I[1]),(!N||B&4)&&Q(y,I[2]),(!N||B&8)&&Q(A,I[3]),M===(M=Z(I))&&P?P.p(I,B):(P.d(1),P=M(I),P&&(P.c(),P.m(e,null)))},i(I){N||(ne(D.$$.fragment,I),N=!0)},o(I){oe(D.$$.fragment,I),N=!1},d(I){I&&j(e),_e(D),P.d()}}}function Fl(t,e,n){let r,s,o;Ce(t,Xe,h=>n(7,s=h)),Ce(t,De,h=>n(8,o=h));let{privKey:c}=e,l,i,a,b,p;return Le(De,o=Vt.CURVE.n,o),t.$$set=h=>{"privKey"in h&&n(6,c=h.privKey)},t.$$.update=()=>{if(t.$$.dirty&128&&n(0,r=s.length>0),t.$$.dirty&193){const h=Vt.getPublicKey(c),d=Vt.ExtendedPoint.fromHex(h);if(n(1,[l,i]=[d.x,d.y].map(_=>Ue(_)),l,(n(2,i),n(6,c),n(0,r),n(7,s))),n(3,a=d.toHex()),r){const _=en(s),m=Vt.sign(_,c);n(4,b=Ke(_)),n(5,p=Ke(m))}}},[r,l,i,a,b,p,c,s]}class Wl extends Ze{constructor(e){super(),Ge(this,e,Fl,Yl,Me,{privKey:6})}}function Xl(t){const{Fp:e,Fr:n,Fp2:r,Fp6:s,Fp12:o}=t,c=Qt(t.x),l=32;function i(R){const{x:N,y:Z}=R,M=N,P=Z,I=r.ONE;let B=M,C=P,q=I,U=[];for(let z=c-2;z>=0;z--){let X=r.sqr(C),W=r.sqr(q),L=r.multiplyByB(r.mul(W,3n)),Y=r.mul(L,3n),$=r.sub(r.sub(r.sqr(r.add(C,q)),W),X);if(U.push([r.sub(L,X),r.mul(r.sqr(B),3n),r.neg($)]),B=r.div(r.mul(r.mul(r.sub(X,Y),B),C),2n),C=r.sub(r.sqr(r.div(r.add(X,Y),2n)),r.mul(r.sqr(L),3n)),q=r.mul(X,$),Pt(t.x,z)){let se=r.sub(C,r.mul(P,q)),ie=r.sub(B,r.mul(M,q));U.push([r.sub(r.mul(se,M),r.mul(ie,P)),r.neg(se),ie]);let be=r.sqr(ie),de=r.mul(be,ie),fe=r.mul(be,B),me=r.add(r.sub(de,r.mul(fe,2n)),r.mul(r.sqr(se),q));B=r.mul(ie,me),C=r.sub(r.mul(r.sub(fe,me),se),r.mul(de,C)),q=r.mul(q,de)}}return U}function a(R,N){const{x:Z}=t,M=N[0],P=N[1];let I=o.ONE;for(let B=0,C=c-2;C>=0;C--,B++){const q=R[B];if(I=o.multiplyBy014(I,q[0],r.mul(q[1],M),r.mul(q[2],P)),Pt(Z,C)){B+=1;const U=R[B];I=o.multiplyBy014(I,U[0],r.mul(U[1],M),r.mul(U[2],P))}C!==0&&(I=o.sqr(I))}return o.conjugate(I)}const b={randomPrivateKey:()=>n.toBytes(rc(t.randomBytes(l+8),t.r))},p=cr({n:n.ORDER,...t.G1}),h=Object.assign(p,Tt(p.ProjectivePoint,t.G1.mapToCurve,{...t.htfDefaults,...t.G1.htfDefaults}));function d(R){const N=R;return N._PPRECOMPUTES||(N._PPRECOMPUTES=i(R.toAffine())),N._PPRECOMPUTES}const _=cr({n:n.ORDER,...t.G2}),m=Object.assign(_,Tt(_.ProjectivePoint,t.G2.mapToCurve,{...t.htfDefaults,...t.G2.htfDefaults})),{Signature:y}=t.G2;function x(R,N,Z=!0){if(R.equals(h.ProjectivePoint.ZERO)||N.equals(m.ProjectivePoint.ZERO))throw new Error("pairing is not available for ZERO point");R.assertValidity(),N.assertValidity();const M=R.toAffine(),P=a(d(N),[M.x,M.y]);return Z?o.finalExponentiate(P):P}function S(R){return R instanceof h.ProjectivePoint?R:h.ProjectivePoint.fromHex(R)}function k(R){return R instanceof m.ProjectivePoint?R:y.decode(R)}function w(R,N){return R instanceof m.ProjectivePoint?R:m.hashToCurve(Ee("point",R),N)}function v(R){return h.ProjectivePoint.fromPrivateKey(R).toRawBytes(!0)}function A(R,N,Z){const M=w(R,Z);M.assertValidity();const P=M.multiply(h.normPrivateKeyToScalar(N));return R instanceof m.ProjectivePoint?P:y.encode(P)}function G(R,N,Z,M){const P=S(Z),I=w(N,M),B=h.ProjectivePoint.BASE,C=k(R),q=x(P.negate(),I,!1),U=x(B,C,!1),z=o.finalExponentiate(o.mul(U,q));return o.eql(z,o.ONE)}function T(R){if(!R.length)throw new Error("Expected non-empty array");const Z=R.map(S).reduce((M,P)=>M.add(P),h.ProjectivePoint.ZERO);return R[0]instanceof h.ProjectivePoint?(Z.assertValidity(),Z):Z.toRawBytes(!0)}function H(R){if(!R.length)throw new Error("Expected non-empty array");const Z=R.map(k).reduce((M,P)=>M.add(P),m.ProjectivePoint.ZERO);return R[0]instanceof m.ProjectivePoint?(Z.assertValidity(),Z):y.encode(Z)}function D(R,N,Z,M){if(!N.length)throw new Error("Expected non-empty messages array");if(Z.length!==N.length)throw new Error("Pubkey count should equal msg count");const P=k(R),I=N.map(C=>w(C,M)),B=Z.map(S);try{const C=[];for(const z of new Set(I)){const X=I.reduce((W,L,Y)=>L===z?W.add(B[Y]):W,h.ProjectivePoint.ZERO);C.push(x(X,z,!1))}C.push(x(h.ProjectivePoint.BASE.negate(),P,!1));const q=C.reduce((z,X)=>o.mul(z,X),o.ONE),U=o.finalExponentiate(q);return o.eql(U,o.ONE)}catch{return!1}}return h.ProjectivePoint.BASE._setWindowSize(4),{CURVE:t,Fr:n,Fp:e,Fp2:r,Fp6:s,Fp12:o,G1:h,G2:m,Signature:y,millerLoop:a,calcPairingPrecomputes:i,pairing:x,getPublicKey:v,sign:A,verify:G,aggregatePublicKeys:T,aggregateSignatures:H,verifyBatch:D,utils:b}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const K=wt(0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaabn),is=wt(0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001n),as=({c0:t,c1:e},{c0:n,c1:r})=>({c0:K.add(t,n),c1:K.add(e,r)}),us=({c0:t,c1:e},{c0:n,c1:r})=>({c0:K.sub(t,n),c1:K.sub(e,r)}),ds=({c0:t,c1:e},n)=>{if(typeof n=="bigint")return{c0:K.mul(t,n),c1:K.mul(e,n)};const{c0:r,c1:s}=n;let o=K.mul(t,r),c=K.mul(e,s);const l=K.sub(o,c),i=K.sub(K.mul(K.add(t,e),K.add(r,s)),K.add(o,c));return{c0:l,c1:i}},bs=({c0:t,c1:e})=>{const n=K.add(t,e),r=K.sub(t,e),s=K.add(t,t);return{c0:K.mul(n,r),c1:K.mul(s,e)}},kn=0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaabn**2n,E={ORDER:kn,BITS:Qt(kn),BYTES:Math.ceil(Qt(kn)/8),MASK:tn(Qt(kn)),ZERO:{c0:K.ZERO,c1:K.ZERO},ONE:{c0:K.ONE,c1:K.ZERO},create:t=>t,isValid:({c0:t,c1:e})=>typeof t=="bigint"&&typeof e=="bigint",is0:({c0:t,c1:e})=>K.is0(t)&&K.is0(e),eql:({c0:t,c1:e},{c0:n,c1:r})=>K.eql(t,n)&&K.eql(e,r),neg:({c0:t,c1:e})=>({c0:K.neg(t),c1:K.neg(e)}),pow:(t,e)=>Ln(E,t,e),invertBatch:t=>qn(E,t),add:as,sub:us,mul:ds,sqr:bs,addN:as,subN:us,mulN:ds,sqrN:bs,div:(t,e)=>E.mul(t,typeof e=="bigint"?K.inv(K.create(e)):E.inv(e)),inv:({c0:t,c1:e})=>{const n=K.inv(K.create(t*t+e*e));return{c0:K.mul(n,K.create(t)),c1:K.mul(n,K.create(-e))}},sqrt:t=>{if(E.eql(t,E.ZERO))return E.ZERO;const e=E.pow(t,(E.ORDER+8n)/16n),n=E.div(E.sqr(e),t),r=Ql,s=[r[0],r[2],r[4],r[6]].find(d=>E.eql(d,n));if(!s)throw new Error("No root");const o=r.indexOf(s),c=r[o/2];if(!c)throw new Error("Invalid root");const l=E.div(e,c),i=E.neg(l),{re:a,im:b}=E.reim(l),{re:p,im:h}=E.reim(i);return b>h||b===h&&a>p?l:i},isOdd:t=>{const{re:e,im:n}=E.reim(t),r=e%2n,s=e===0n,o=n%2n;return BigInt(r||s&&o)==1n},fromBytes(t){if(t.length!==E.BYTES)throw new Error(`fromBytes wrong length=${t.length}`);return{c0:K.fromBytes(t.subarray(0,K.BYTES)),c1:K.fromBytes(t.subarray(K.BYTES))}},toBytes:({c0:t,c1:e})=>Ie(K.toBytes(t),K.toBytes(e)),cmov:({c0:t,c1:e},{c0:n,c1:r},s)=>({c0:K.cmov(t,n,s),c1:K.cmov(e,r,s)}),reim:({c0:t,c1:e})=>({re:t,im:e}),mulByNonresidue:({c0:t,c1:e})=>({c0:K.sub(t,e),c1:K.add(t,e)}),multiplyByB:({c0:t,c1:e})=>{let n=K.mul(t,4n),r=K.mul(e,4n);return{c0:K.sub(n,r),c1:K.add(n,r)}},fromBigTuple:t=>{if(t.length!==2)throw new Error("Invalid tuple");const e=t.map(n=>K.create(n));return{c0:e[0],c1:e[1]}},frobeniusMap:({c0:t,c1:e},n)=>({c0:t,c1:K.mul(e,$l[n%2])})},$l=[0x1n,0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaaan].map(t=>K.create(t)),Ct=0x6af0e0437ff400b6831e36d6bd17ffe48395dabc2d3435e77f76e17009241c5ee67992f72ec05f4c81084fbede3cc09n,Ql=[[1n,0n],[Ct,-Ct],[0n,1n],[Ct,Ct],[-1n,0n],[-Ct,Ct],[0n,-1n],[-Ct,-Ct]].map(t=>E.fromBigTuple(t)),hs=({c0:t,c1:e,c2:n},{c0:r,c1:s,c2:o})=>({c0:E.add(t,r),c1:E.add(e,s),c2:E.add(n,o)}),ps=({c0:t,c1:e,c2:n},{c0:r,c1:s,c2:o})=>({c0:E.sub(t,r),c1:E.sub(e,s),c2:E.sub(n,o)}),_s=({c0:t,c1:e,c2:n},r)=>{if(typeof r=="bigint")return{c0:E.mul(t,r),c1:E.mul(e,r),c2:E.mul(n,r)};const{c0:s,c1:o,c2:c}=r,l=E.mul(t,s),i=E.mul(e,o),a=E.mul(n,c);return{c0:E.add(l,E.mulByNonresidue(E.sub(E.mul(E.add(e,n),E.add(o,c)),E.add(i,a)))),c1:E.add(E.sub(E.mul(E.add(t,e),E.add(s,o)),E.add(l,i)),E.mulByNonresidue(a)),c2:E.sub(E.add(i,E.mul(E.add(t,n),E.add(s,c))),E.add(l,a))}},ms=({c0:t,c1:e,c2:n})=>{let r=E.sqr(t),s=E.mul(E.mul(t,e),2n),o=E.mul(E.mul(e,n),2n),c=E.sqr(n);return{c0:E.add(E.mulByNonresidue(o),r),c1:E.add(E.mulByNonresidue(c),s),c2:E.sub(E.sub(E.add(E.add(s,E.sqr(E.add(E.sub(t,e),n))),o),r),c)}},te={ORDER:E.ORDER,BITS:3*E.BITS,BYTES:3*E.BYTES,MASK:tn(3*E.BITS),ZERO:{c0:E.ZERO,c1:E.ZERO,c2:E.ZERO},ONE:{c0:E.ONE,c1:E.ZERO,c2:E.ZERO},create:t=>t,isValid:({c0:t,c1:e,c2:n})=>E.isValid(t)&&E.isValid(e)&&E.isValid(n),is0:({c0:t,c1:e,c2:n})=>E.is0(t)&&E.is0(e)&&E.is0(n),neg:({c0:t,c1:e,c2:n})=>({c0:E.neg(t),c1:E.neg(e),c2:E.neg(n)}),eql:({c0:t,c1:e,c2:n},{c0:r,c1:s,c2:o})=>E.eql(t,r)&&E.eql(e,s)&&E.eql(n,o),sqrt:()=>{throw new Error("Not implemented")},div:(t,e)=>te.mul(t,typeof e=="bigint"?K.inv(K.create(e)):te.inv(e)),pow:(t,e)=>Ln(te,t,e),invertBatch:t=>qn(te,t),add:hs,sub:ps,mul:_s,sqr:ms,addN:hs,subN:ps,mulN:_s,sqrN:ms,inv:({c0:t,c1:e,c2:n})=>{let r=E.sub(E.sqr(t),E.mulByNonresidue(E.mul(n,e))),s=E.sub(E.mulByNonresidue(E.sqr(n)),E.mul(t,e)),o=E.sub(E.sqr(e),E.mul(t,n)),c=E.inv(E.add(E.mulByNonresidue(E.add(E.mul(n,s),E.mul(e,o))),E.mul(t,r)));return{c0:E.mul(c,r),c1:E.mul(c,s),c2:E.mul(c,o)}},fromBytes:t=>{if(t.length!==te.BYTES)throw new Error(`fromBytes wrong length=${t.length}`);return{c0:E.fromBytes(t.subarray(0,E.BYTES)),c1:E.fromBytes(t.subarray(E.BYTES,2*E.BYTES)),c2:E.fromBytes(t.subarray(2*E.BYTES))}},toBytes:({c0:t,c1:e,c2:n})=>Ie(E.toBytes(t),E.toBytes(e),E.toBytes(n)),cmov:({c0:t,c1:e,c2:n},{c0:r,c1:s,c2:o},c)=>({c0:E.cmov(t,r,c),c1:E.cmov(e,s,c),c2:E.cmov(n,o,c)}),fromBigSix:t=>{if(!Array.isArray(t)||t.length!==6)throw new Error("Invalid Fp6 usage");return{c0:E.fromBigTuple(t.slice(0,2)),c1:E.fromBigTuple(t.slice(2,4)),c2:E.fromBigTuple(t.slice(4,6))}},frobeniusMap:({c0:t,c1:e,c2:n},r)=>({c0:E.frobeniusMap(t,r),c1:E.mul(E.frobeniusMap(e,r),Jl[r%6]),c2:E.mul(E.frobeniusMap(n,r),ei[r%6])}),mulByNonresidue:({c0:t,c1:e,c2:n})=>({c0:E.mulByNonresidue(n),c1:t,c2:e}),multiplyBy1:({c0:t,c1:e,c2:n},r)=>({c0:E.mulByNonresidue(E.mul(n,r)),c1:E.mul(t,r),c2:E.mul(e,r)}),multiplyBy01({c0:t,c1:e,c2:n},r,s){let o=E.mul(t,r),c=E.mul(e,s);return{c0:E.add(E.mulByNonresidue(E.sub(E.mul(E.add(e,n),s),c)),o),c1:E.sub(E.sub(E.mul(E.add(r,s),E.add(t,e)),o),c),c2:E.add(E.sub(E.mul(E.add(t,n),r),o),c)}},multiplyByFp2:({c0:t,c1:e,c2:n},r)=>({c0:E.mul(t,r),c1:E.mul(e,r),c2:E.mul(n,r)})},Jl=[[0x1n,0x0n],[0x0n,0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaacn],[0x00000000000000005f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffen,0x0n],[0x0n,0x1n],[0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaacn,0x0n],[0x0n,0x00000000000000005f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffen]].map(t=>E.fromBigTuple(t)),ei=[[0x1n,0x0n],[0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaadn,0x0n],[0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaacn,0x0n],[0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaaan,0x0n],[0x00000000000000005f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffen,0x0n],[0x00000000000000005f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffeffffn,0x0n]].map(t=>E.fromBigTuple(t)),Hr=0xd201000000010000n,ti=Qt(Hr),gs=({c0:t,c1:e},{c0:n,c1:r})=>({c0:te.add(t,n),c1:te.add(e,r)}),ys=({c0:t,c1:e},{c0:n,c1:r})=>({c0:te.sub(t,n),c1:te.sub(e,r)}),xs=({c0:t,c1:e},n)=>{if(typeof n=="bigint")return{c0:te.mul(t,n),c1:te.mul(e,n)};let{c0:r,c1:s}=n,o=te.mul(t,r),c=te.mul(e,s);return{c0:te.add(o,te.mulByNonresidue(c)),c1:te.sub(te.mul(te.add(t,e),te.add(r,s)),te.add(o,c))}},vs=({c0:t,c1:e})=>{let n=te.mul(t,e);return{c0:te.sub(te.sub(te.mul(te.add(te.mulByNonresidue(e),t),te.add(t,e)),n),te.mulByNonresidue(n)),c1:te.add(n,n)}};function Xn(t,e){const n=E.sqr(t),r=E.sqr(e);return{first:E.add(E.mulByNonresidue(r),n),second:E.sub(E.sub(E.sqr(E.add(t,e)),n),r)}}const le={ORDER:E.ORDER,BITS:2*E.BITS,BYTES:2*E.BYTES,MASK:tn(2*E.BITS),ZERO:{c0:te.ZERO,c1:te.ZERO},ONE:{c0:te.ONE,c1:te.ZERO},create:t=>t,isValid:({c0:t,c1:e})=>te.isValid(t)&&te.isValid(e),is0:({c0:t,c1:e})=>te.is0(t)&&te.is0(e),neg:({c0:t,c1:e})=>({c0:te.neg(t),c1:te.neg(e)}),eql:({c0:t,c1:e},{c0:n,c1:r})=>te.eql(t,n)&&te.eql(e,r),sqrt:()=>{throw new Error("Not implemented")},inv:({c0:t,c1:e})=>{let n=te.inv(te.sub(te.sqr(t),te.mulByNonresidue(te.sqr(e))));return{c0:te.mul(t,n),c1:te.neg(te.mul(e,n))}},div:(t,e)=>le.mul(t,typeof e=="bigint"?K.inv(K.create(e)):le.inv(e)),pow:(t,e)=>Ln(le,t,e),invertBatch:t=>qn(le,t),add:gs,sub:ys,mul:xs,sqr:vs,addN:gs,subN:ys,mulN:xs,sqrN:vs,fromBytes:t=>{if(t.length!==le.BYTES)throw new Error(`fromBytes wrong length=${t.length}`);return{c0:te.fromBytes(t.subarray(0,te.BYTES)),c1:te.fromBytes(t.subarray(te.BYTES))}},toBytes:({c0:t,c1:e})=>Ie(te.toBytes(t),te.toBytes(e)),cmov:({c0:t,c1:e},{c0:n,c1:r},s)=>({c0:te.cmov(t,n,s),c1:te.cmov(e,r,s)}),fromBigTwelve:t=>({c0:te.fromBigSix(t.slice(0,6)),c1:te.fromBigSix(t.slice(6,12))}),frobeniusMap(t,e){const n=te.frobeniusMap(t.c0,e),{c0:r,c1:s,c2:o}=te.frobeniusMap(t.c1,e),c=ni[e%12];return{c0:n,c1:te.create({c0:E.mul(r,c),c1:E.mul(s,c),c2:E.mul(o,c)})}},multiplyBy014:({c0:t,c1:e},n,r,s)=>{let o=te.multiplyBy01(t,n,r),c=te.multiplyBy1(e,s);return{c0:te.add(te.mulByNonresidue(c),o),c1:te.sub(te.sub(te.multiplyBy01(te.add(e,t),n,E.add(r,s)),o),c)}},multiplyByFp2:({c0:t,c1:e},n)=>({c0:te.multiplyByFp2(t,n),c1:te.multiplyByFp2(e,n)}),conjugate:({c0:t,c1:e})=>({c0:t,c1:te.neg(e)}),_cyclotomicSquare:({c0:t,c1:e})=>{const{c0:n,c1:r,c2:s}=t,{c0:o,c1:c,c2:l}=e,{first:i,second:a}=Xn(n,c),{first:b,second:p}=Xn(o,s),{first:h,second:d}=Xn(r,l);let _=E.mulByNonresidue(d);return{c0:te.create({c0:E.add(E.mul(E.sub(i,n),2n),i),c1:E.add(E.mul(E.sub(b,r),2n),b),c2:E.add(E.mul(E.sub(h,s),2n),h)}),c1:te.create({c0:E.add(E.mul(E.add(_,o),2n),_),c1:E.add(E.mul(E.add(a,c),2n),a),c2:E.add(E.mul(E.add(p,l),2n),p)})}},_cyclotomicExp(t,e){let n=le.ONE;for(let r=ti-1;r>=0;r--)n=le._cyclotomicSquare(n),Pt(e,r)&&(n=le.mul(n,t));return n},finalExponentiate:t=>{const e=Hr,n=le.div(le.frobeniusMap(t,6),t),r=le.mul(le.frobeniusMap(n,2),n),s=le.conjugate(le._cyclotomicExp(r,e)),o=le.mul(le.conjugate(le._cyclotomicSquare(r)),s),c=le.conjugate(le._cyclotomicExp(o,e)),l=le.conjugate(le._cyclotomicExp(c,e)),i=le.mul(le.conjugate(le._cyclotomicExp(l,e)),le._cyclotomicSquare(s)),a=le.conjugate(le._cyclotomicExp(i,e)),b=le.frobeniusMap(le.mul(s,l),2),p=le.frobeniusMap(le.mul(c,r),3),h=le.frobeniusMap(le.mul(i,le.conjugate(r)),1),d=le.mul(le.mul(a,le.conjugate(o)),r);return le.mul(le.mul(le.mul(b,p),h),d)}},ni=[[0x1n,0x0n],[0x1904d3bf02bb0667c231beb4202c0d1f0fd603fd3cbd5f4f7b2443d784bab9c4f67ea53d63e7813d8d0775ed92235fb8n,0x00fc3e2b36c4e03288e9e902231f9fb854a14787b6c7b36fec0c8ec971f63c5f282d5ac14d6c7ec22cf78a126ddc4af3n],[0x00000000000000005f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffeffffn,0x0n],[0x135203e60180a68ee2e9c448d77a2cd91c3dedd930b1cf60ef396489f61eb45e304466cf3e67fa0af1ee7b04121bdea2n,0x06af0e0437ff400b6831e36d6bd17ffe48395dabc2d3435e77f76e17009241c5ee67992f72ec05f4c81084fbede3cc09n],[0x00000000000000005f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffen,0x0n],[0x144e4211384586c16bd3ad4afa99cc9170df3560e77982d0db45f3536814f0bd5871c1908bd478cd1ee605167ff82995n,0x05b2cfd9013a5fd8df47fa6b48b1e045f39816240c0b8fee8beadf4d8e9c0566c63a3e6e257f87329b18fae980078116n],[0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaaan,0x0n],[0x00fc3e2b36c4e03288e9e902231f9fb854a14787b6c7b36fec0c8ec971f63c5f282d5ac14d6c7ec22cf78a126ddc4af3n,0x1904d3bf02bb0667c231beb4202c0d1f0fd603fd3cbd5f4f7b2443d784bab9c4f67ea53d63e7813d8d0775ed92235fb8n],[0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaacn,0x0n],[0x06af0e0437ff400b6831e36d6bd17ffe48395dabc2d3435e77f76e17009241c5ee67992f72ec05f4c81084fbede3cc09n,0x135203e60180a68ee2e9c448d77a2cd91c3dedd930b1cf60ef396489f61eb45e304466cf3e67fa0af1ee7b04121bdea2n],[0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaadn,0x0n],[0x05b2cfd9013a5fd8df47fa6b48b1e045f39816240c0b8fee8beadf4d8e9c0566c63a3e6e257f87329b18fae980078116n,0x144e4211384586c16bd3ad4afa99cc9170df3560e77982d0db45f3536814f0bd5871c1908bd478cd1ee605167ff82995n]].map(t=>E.fromBigTuple(t)),ri=Er(E,[[["0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6","0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6"],["0x0","0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71a"],["0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71e","0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38d"],["0x171d6541fa38ccfaed6dea691f5fb614cb14b4e7f4e810aa22d6108f142b85757098e38d0f671c7188e2aaaaaaaa5ed1","0x0"]],[["0x0","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa63"],["0xc","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa9f"],["0x1","0x0"]],[["0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706","0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706"],["0x0","0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97be"],["0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71c","0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38f"],["0x124c9ad43b6cf79bfbf7043de3811ad0761b0f37a1e26286b0e977c69aa274524e79097a56dc4bd9e1b371c71c718b10","0x0"]],[["0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fb","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fb"],["0x0","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa9d3"],["0x12","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa99"],["0x1","0x0"]]].map(t=>t.map(e=>E.fromBigTuple(e.map(BigInt))))),si=Er(K,[["0x11a05f2b1e833340b809101dd99815856b303e88a2d7005ff2627b56cdb4e2c85610c2d5f2e62d6eaeac1662734649b7","0x17294ed3e943ab2f0588bab22147a81c7c17e75b2f6a8417f565e33c70d1e86b4838f2a6f318c356e834eef1b3cb83bb","0xd54005db97678ec1d1048c5d10a9a1bce032473295983e56878e501ec68e25c958c3e3d2a09729fe0179f9dac9edcb0","0x1778e7166fcc6db74e0609d307e55412d7f5e4656a8dbf25f1b33289f1b330835336e25ce3107193c5b388641d9b6861","0xe99726a3199f4436642b4b3e4118e5499db995a1257fb3f086eeb65982fac18985a286f301e77c451154ce9ac8895d9","0x1630c3250d7313ff01d1201bf7a74ab5db3cb17dd952799b9ed3ab9097e68f90a0870d2dcae73d19cd13c1c66f652983","0xd6ed6553fe44d296a3726c38ae652bfb11586264f0f8ce19008e218f9c86b2a8da25128c1052ecaddd7f225a139ed84","0x17b81e7701abdbe2e8743884d1117e53356de5ab275b4db1a682c62ef0f2753339b7c8f8c8f475af9ccb5618e3f0c88e","0x80d3cf1f9a78fc47b90b33563be990dc43b756ce79f5574a2c596c928c5d1de4fa295f296b74e956d71986a8497e317","0x169b1f8e1bcfa7c42e0c37515d138f22dd2ecb803a0c5c99676314baf4bb1b7fa3190b2edc0327797f241067be390c9e","0x10321da079ce07e272d8ec09d2565b0dfa7dccdde6787f96d50af36003b14866f69b771f8c285decca67df3f1605fb7b","0x6e08c248e260e70bd1e962381edee3d31d79d7e22c837bc23c0bf1bc24c6b68c24b1b80b64d391fa9c8ba2e8ba2d229"],["0x8ca8d548cff19ae18b2e62f4bd3fa6f01d5ef4ba35b48ba9c9588617fc8ac62b558d681be343df8993cf9fa40d21b1c","0x12561a5deb559c4348b4711298e536367041e8ca0cf0800c0126c2588c48bf5713daa8846cb026e9e5c8276ec82b3bff","0xb2962fe57a3225e8137e629bff2991f6f89416f5a718cd1fca64e00b11aceacd6a3d0967c94fedcfcc239ba5cb83e19","0x3425581a58ae2fec83aafef7c40eb545b08243f16b1655154cca8abc28d6fd04976d5243eecf5c4130de8938dc62cd8","0x13a8e162022914a80a6f1d5f43e7a07dffdfc759a12062bb8d6b44e833b306da9bd29ba81f35781d539d395b3532a21e","0xe7355f8e4e667b955390f7f0506c6e9395735e9ce9cad4d0a43bcef24b8982f7400d24bc4228f11c02df9a29f6304a5","0x772caacf16936190f3e0c63e0596721570f5799af53a1894e2e073062aede9cea73b3538f0de06cec2574496ee84a3a","0x14a7ac2a9d64a8b230b3f5b074cf01996e7f63c21bca68a81996e1cdf9822c580fa5b9489d11e2d311f7d99bbdcc5a5e","0xa10ecf6ada54f825e920b3dafc7a3cce07f8d1d7161366b74100da67f39883503826692abba43704776ec3a79a1d641","0x95fc13ab9e92ad4476d6e3eb3a56680f682b4ee96f7d03776df533978f31c1593174e4b4b7865002d6384d168ecdd0a","0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"],["0x90d97c81ba24ee0259d1f094980dcfa11ad138e48a869522b52af6c956543d3cd0c7aee9b3ba3c2be9845719707bb33","0x134996a104ee5811d51036d776fb46831223e96c254f383d0f906343eb67ad34d6c56711962fa8bfe097e75a2e41c696","0xcc786baa966e66f4a384c86a3b49942552e2d658a31ce2c344be4b91400da7d26d521628b00523b8dfe240c72de1f6","0x1f86376e8981c217898751ad8746757d42aa7b90eeb791c09e4a3ec03251cf9de405aba9ec61deca6355c77b0e5f4cb","0x8cc03fdefe0ff135caf4fe2a21529c4195536fbe3ce50b879833fd221351adc2ee7f8dc099040a841b6daecf2e8fedb","0x16603fca40634b6a2211e11db8f0a6a074a7d0d4afadb7bd76505c3d3ad5544e203f6326c95a807299b23ab13633a5f0","0x4ab0b9bcfac1bbcb2c977d027796b3ce75bb8ca2be184cb5231413c4d634f3747a87ac2460f415ec961f8855fe9d6f2","0x987c8d5333ab86fde9926bd2ca6c674170a05bfe3bdd81ffd038da6c26c842642f64550fedfe935a15e4ca31870fb29","0x9fc4018bd96684be88c9e221e4da1bb8f3abd16679dc26c1e8b6e6a1f20cabe69d65201c78607a360370e577bdba587","0xe1bba7a1186bdb5223abde7ada14a23c42a0ca7915af6fe06985e7ed1e4d43b9b3f7055dd4eba6f2bafaaebca731c30","0x19713e47937cd1be0dfd0b8f1d43fb93cd2fcbcb6caf493fd1183e416389e61031bf3a5cce3fbafce813711ad011c132","0x18b46a908f36f6deb918c143fed2edcc523559b8aaf0c2462e6bfe7f911f643249d9cdf41b44d606ce07c8a4d0074d8e","0xb182cac101b9399d155096004f53f447aa7b12a3426b08ec02710e807b4633f06c851c1919211f20d4c04f00b971ef8","0x245a394ad1eca9b72fc00ae7be315dc757b3b080d4c158013e6632d3c40659cc6cf90ad1c232a6442d9d3f5db980133","0x5c129645e44cf1102a159f748c4a3fc5e673d81d7e86568d9ab0f5d396a7ce46ba1049b6579afb7866b1e715475224b","0x15e6be4e990f03ce4ea50b3b42df2eb5cb181d8f84965a3957add4fa95af01b2b665027efec01c7704b456be69c8b604"],["0x16112c4c3a9c98b252181140fad0eae9601a6de578980be6eec3232b5be72e7a07f3688ef60c206d01479253b03663c1","0x1962d75c2381201e1a0cbd6c43c348b885c84ff731c4d59ca4a10356f453e01f78a4260763529e3532f6102c2e49a03d","0x58df3306640da276faaae7d6e8eb15778c4855551ae7f310c35a5dd279cd2eca6757cd636f96f891e2538b53dbf67f2","0x16b7d288798e5395f20d23bf89edb4d1d115c5dbddbcd30e123da489e726af41727364f2c28297ada8d26d98445f5416","0xbe0e079545f43e4b00cc912f8228ddcc6d19c9f0f69bbb0542eda0fc9dec916a20b15dc0fd2ededda39142311a5001d","0x8d9e5297186db2d9fb266eaac783182b70152c65550d881c5ecd87b6f0f5a6449f38db9dfa9cce202c6477faaf9b7ac","0x166007c08a99db2fc3ba8734ace9824b5eecfdfa8d0cf8ef5dd365bc400a0051d5fa9c01a58b1fb93d1a1399126a775c","0x16a3ef08be3ea7ea03bcddfabba6ff6ee5a4375efa1f4fd7feb34fd206357132b920f5b00801dee460ee415a15812ed9","0x1866c8ed336c61231a1be54fd1d74cc4f9fb0ce4c6af5920abc5750c4bf39b4852cfe2f7bb9248836b233d9d55535d4a","0x167a55cda70a6e1cea820597d94a84903216f763e13d87bb5308592e7ea7d4fbc7385ea3d529b35e346ef48bb8913f55","0x4d2f259eea405bd48f010a01ad2911d9c6dd039bb61a6290e591b36e636a5c871a5c29f4f83060400f8b49cba8f6aa8","0xaccbb67481d033ff5852c1e48c50c477f94ff8aefce42d28c0f9a88cea7913516f968986f7ebbea9684b529e2561092","0xad6b9514c767fe3c3613144b45f1496543346d98adf02267d5ceef9a00d9b8693000763e3b90ac11e99b138573345cc","0x2660400eb2e4f3b628bdd0d53cd76f2bf565b94e72927c1cb748df27942480e420517bd8714cc80d1fadc1326ed06f7","0xe0fa1d816ddc03e6b24255e0d7819c171c40f65e273b853324efcd6356caa205ca2f570f13497804415473a1d634b8f","0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"]].map(t=>t.map(e=>BigInt(e)))),ci=nn(E,{A:E.create({c0:K.create(0n),c1:K.create(240n)}),B:E.create({c0:K.create(1012n),c1:K.create(1012n)}),Z:E.create({c0:K.create(-2n),c1:K.create(-1n)})}),oi=nn(K,{A:K.create(0x144698a3b8e9433d693a02c96d4982b0ea985383ee66a8d8e8981aefd881ac98936f8da0e0f97f5cf428082d584c1dn),B:K.create(0x12e2908d11688030018b12e8753eee3b2016c1f0f24f4070a0b9c14fcef35ef55a23215a316ceaa5d1cc48e98e172be0n),Z:K.create(11n)}),Pc=te.create({c0:E.ZERO,c1:E.ONE,c2:E.ZERO}),Rc=le.create({c0:Pc,c1:te.ZERO}),Hc=le.create({c0:te.ZERO,c1:Pc}),[fi,li]=le.invertBatch([Rc,Hc]);function ii(t,e){const n=le.mul(le.frobeniusMap(le.multiplyByFp2(fi,t),1),Rc).c0.c0,r=le.mul(le.frobeniusMap(le.multiplyByFp2(li,e),1),Hc).c0.c0;return[n,r]}function ws(t,e){const n=e.toAffine(),r=ii(n.x,n.y);return new t(r[0],r[1],E.ONE)}const ai=0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaacn;function ui(t,e){return[E.mul(t,ai),E.neg(e)]}function di(t,e){const n=e.toAffine(),r=ui(n.x,n.y);return new t(r[0],r[1],E.ONE)}const $n=Object.freeze({DST:"BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_",encodeDST:"BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_",p:K.ORDER,m:2,k:128,expand:"xmd",hash:We}),Qn=K.BITS,br=K.BITS+1,An=K.BITS+2,Jn=K.toBytes(mt(mt(0n,br,!0),An,!0)),Re=Xl({Fr:is,Fp:K,Fp2:E,Fp6:te,Fp12:le,r:is.ORDER,G1:{Fp:K,h:0x396c8c005555e1568c00aaab0000aaabn,Gx:0x17f1d3a73197d7942695638c4fa9ac0fc3688c4f9774b905a14e3a3f171bac586c55e83ff97a1aeffb3af00adb22c6bbn,Gy:0x08b3f481e3aaa0f1a09e30ed741d8ae4fcf5e095d5d00af600db18cb2c04b3edd03cc744a2888ae40caa232946c5e7e1n,a:K.ZERO,b:4n,htfDefaults:{...$n,m:1},wrapPrivateKey:!0,allowInfinityPoint:!0,isTorsionFree:(t,e)=>{const n=0x5f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffen,r=new t(K.mul(e.px,n),e.py,e.pz);return e.multiplyUnsafe(Re.CURVE.x).negate().multiplyUnsafe(Re.CURVE.x).equals(r)},clearCofactor:(t,e)=>e.multiplyUnsafe(Re.CURVE.x).add(e),mapToCurve:t=>{const{x:e,y:n}=oi(K.create(t[0]));return si(e,n)},fromBytes:t=>{if(t.length===48){const e=K.ORDER,n=He(t);if(Pt(n,br)===1n)return{x:0n,y:0n};const s=K.create(n&K.MASK),o=K.add(K.pow(s,3n),K.create(Re.CURVE.G1.b));let c=K.sqrt(o);if(!c)throw new Error("Invalid compressed G1 point");const l=Pt(n,Qn);return c*2n/e!==l&&(c=K.neg(c)),{x:K.create(s),y:K.create(c)}}else if(t.length===96){if(t[0]&1<<6)return Re.G1.ProjectivePoint.ZERO.toAffine();const e=He(t.slice(0,K.BYTES)),n=He(t.slice(K.BYTES));return{x:K.create(e),y:K.create(n)}}else throw new Error("Invalid point G1, expected 48/96 bytes")},toBytes:(t,e,n)=>{const r=e.equals(t.ZERO),{x:s,y:o}=e.toAffine();if(n){if(r)return Jn.slice();const c=K.ORDER;let l;return l=mt(s,Qn,Boolean(o*2n/c)),l=mt(l,An,!0),Pe(l,K.BYTES)}else return r?Ie(new Uint8Array([64]),new Uint8Array(2*K.BYTES-1)):Ie(Pe(s,K.BYTES),Pe(o,K.BYTES))}},G2:{Fp:E,h:0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5n,Gx:E.fromBigTuple([0x024aa2b2f08f0a91260805272dc51051c6e47ad4fa403b02b4510b647ae3d1770bac0326a805bbefd48056c8c121bdb8n,0x13e02b6052719f607dacd3a088274f65596bd0d09920b61ab5da61bbdc7f5049334cf11213945d57e5ac7d055d042b7en]),Gy:E.fromBigTuple([0x0ce5d527727d6e118cc9cdc6da2e351aadfd9baa8cbdd3a76d429a695160d12c923ac9cc3baca289e193548608b82801n,0x0606c4a02ea734cc32acd2b02bc28b99cb3e287e85a763af267492ab572e99ab3f370d275cec1da1aaa9075ff05f79ben]),a:E.ZERO,b:E.fromBigTuple([4n,4n]),hEff:0xbc69f08f2ee75b3584c6a0ea91b352888e2a8e9145ad7689986ff031508ffe1329c2f178731db956d82bf015d1212b02ec0ec69d7477c1ae954cbc06689f6a359894c0adebbf6b4e8020005aaa95551n,htfDefaults:{...$n},wrapPrivateKey:!0,allowInfinityPoint:!0,mapToCurve:t=>{const{x:e,y:n}=ci(E.fromBigTuple(t));return ri(e,n)},isTorsionFree:(t,e)=>e.multiplyUnsafe(Re.CURVE.x).negate().equals(ws(t,e)),clearCofactor:(t,e)=>{const{x:n}=Re.CURVE;let r=e.multiplyUnsafe(n).negate(),s=ws(t,e),o=e.double();return o=di(t,o),o=o.subtract(s),s=r.add(s),s=s.multiplyUnsafe(n).negate(),o=o.add(s),o=o.subtract(r),o.subtract(e)},fromBytes:t=>{const e=t[0]&224;if(e===32||e===96||e===224)throw new Error("Invalid encoding flag: "+e);const n=e&128,r=e&64,s=e&32,o=K.BYTES,c=(l,i,a)=>He(l.slice(i,a));if(t.length===96&&n){const{b:l}=Re.CURVE.G2,i=K.ORDER;if(t[0]=t[0]&31,r){if(t.reduce((m,y)=>m!==0?y+1:y,0)>0)throw new Error("Invalid compressed G2 point");return{x:E.ZERO,y:E.ZERO}}const a=c(t,0,o),b=c(t,o,2*o),p=E.create({c0:K.create(b),c1:K.create(a)}),h=E.add(E.pow(p,3n),l);let d=E.sqrt(h);const _=d.c1===0n?d.c0*2n/i:d.c1*2n/i?1n:0n;return d=s>0&&_>0?d:E.neg(d),{x:p,y:d}}else if(t.length===192&&!n){if(t[0]&1<<6)return{x:E.ZERO,y:E.ZERO};const l=c(t,0,o),i=c(t,o,2*o),a=c(t,2*o,3*o),b=c(t,3*o,4*o);return{x:E.fromBigTuple([i,l]),y:E.fromBigTuple([b,a])}}else throw new Error("Invalid point G2, expected 96/192 bytes")},toBytes:(t,e,n)=>{const r=e.equals(t.ZERO),{x:s,y:o}=e.toAffine();if(n){const c=K.ORDER;if(r)return Ie(Jn,Pe(0n,K.BYTES));const l=Boolean(o.c1===0n?o.c0*2n/c:o.c1*2n/c);let i=mt(s.c1,Qn,l);return i=mt(i,An,!0),Ie(Pe(i,K.BYTES),Pe(s.c0,K.BYTES))}else{if(r)return Ie(new Uint8Array([64]),new Uint8Array(4*K.BYTES-1));const{re:c,im:l}=E.reim(s),{re:i,im:a}=E.reim(o);return Ie(Pe(l,K.BYTES),Pe(c,K.BYTES),Pe(a,K.BYTES),Pe(i,K.BYTES))}},Signature:{decode(t){t=Ee("signatureHex",t);const e=K.ORDER,n=t.length/2;if(n!==48&&n!==96)throw new Error("Invalid compressed signature length, must be 96 or 192");const r=He(t.slice(0,n)),s=He(t.slice(n));if(Pt(r,br)===1n)return Re.G2.ProjectivePoint.ZERO;const c=K.create(r&K.MASK),l=K.create(s),i=E.create({c0:l,c1:c}),a=E.add(E.pow(i,3n),Re.CURVE.G2.b);let b=E.sqrt(a);if(!b)throw new Error("Failed to find a square root");const{re:p,im:h}=E.reim(b),d=Pt(r,381),_=h>0n&&h*2n/e!==d,m=h===0n&&p*2n/e!==d;(_||m)&&(b=E.neg(b));const y=Re.G2.ProjectivePoint.fromAffine({x:i,y:b});return y.assertValidity(),y},encode(t){if(t.assertValidity(),t.equals(Re.G2.ProjectivePoint.ZERO))return Ie(Jn,Pe(0n,K.BYTES));const e=t.toAffine(),{re:n,im:r}=E.reim(e.x),{re:s,im:o}=E.reim(e.y),c=o>0n?o*2n:s*2n,l=Boolean(c/K.ORDER&1n),i=mt(mt(r,381,l),An,!0),a=n;return Ie(Pe(i,K.BYTES),Pe(a,K.BYTES))}}},x:Hr,htfDefaults:$n,hash:We,randomBytes:Lt});function bi(t){let e;return{c(){e=u("p"),e.textContent=`${ze.NO_MESSAGE}`},m(n,r){V(n,e,r)},p:ve,d(n){n&&j(e)}}}function hi(t){let e,n,r,s,o,c,l,i,a,b,p,h,d,_,m,y,x,S,k,w,v,A,G,T,H,D,R,N,Z,M,P,I,B,C,q;return{c(){e=u("table"),n=u("tbody"),r=u("tr"),s=u("td"),s.textContent="msgHash",o=u("td"),c=u("code"),l=F(t[4]),i=O(),a=u("tr"),b=u("td"),b.textContent="x",p=u("td"),h=u("code"),d=F(t[5]),_=F(" +"),m=u("br"),y=u("code"),x=F(t[6]),S=F("×i"),k=O(),w=u("tr"),v=u("td"),v.textContent="y",A=u("td"),G=u("code"),T=F(t[7]),H=F(" +"),D=u("br"),R=u("code"),N=F(t[8]),Z=F("×i"),M=O(),P=u("tr"),I=u("td"),I.textContent="sigHex",B=u("td"),C=u("code"),q=F(t[9]),g(s,"class","curve-data__key"),g(b,"class","curve-data__key"),g(v,"class","curve-data__key"),g(I,"class","curve-data__key"),g(e,"class","curve-data__table")},m(U,z){V(U,e,z),f(e,n),f(n,r),f(r,s),f(r,o),f(o,c),f(c,l),f(n,i),f(n,a),f(a,b),f(a,p),f(p,h),f(h,d),f(p,_),f(p,m),f(p,y),f(y,x),f(y,S),f(n,k),f(n,w),f(w,v),f(w,A),f(A,G),f(G,T),f(A,H),f(A,D),f(A,R),f(R,N),f(R,Z),f(n,M),f(n,P),f(P,I),f(P,B),f(B,C),f(C,q)},p(U,z){z&16&&Q(l,U[4]),z&32&&Q(d,U[5]),z&64&&Q(x,U[6]),z&128&&Q(T,U[7]),z&256&&Q(N,U[8]),z&512&&Q(q,U[9])},d(U){U&&j(e)}}}function pi(t){let e,n,r,s,o,c,l,i,a,b,p,h,d,_,m,y,x,S,k,w,v,A,G,T,H,D,R,N,Z,M;N=new Et({});function P(C,q){return C[0]?hi:bi}let I=P(t),B=I(t);return{c(){e=u("div"),n=u("h3"),n.textContent="Public key G1",r=O(),s=u("table"),o=u("tbody"),c=u("tr"),l=u("td"),l.textContent="x",i=u("td"),a=u("code"),b=F(t[1]),p=O(),h=u("tr"),d=u("td"),d.textContent="y",_=u("td"),m=u("code"),y=F(t[2]),x=O(),S=u("tr"),k=u("td"),k.textContent="hex",w=u("td"),v=u("code"),A=F(t[3]),G=O(),T=u("h3"),T.textContent="Signature G2",H=O(),D=u("div"),D.innerHTML="<small>bls consists of two curves: G1 (ordinary) and G2 (complex numbers). Most implementations use G1 for pubkeys and G2 for signatures. So, signatures will coordinates in form of <code>(x₀, x₁×i), (y₀, y₁×i)</code></small>",R=O(),ge(N.$$.fragment),Z=O(),B.c(),g(n,"class","curve-data__header"),g(l,"class","curve-data__key"),g(d,"class","curve-data__key"),g(k,"class","curve-data__key"),g(s,"class","curve-data__table"),g(T,"class","curve-data__header"),g(e,"class","curve-data")},m(C,q){V(C,e,q),f(e,n),f(e,r),f(e,s),f(s,o),f(o,c),f(c,l),f(c,i),f(i,a),f(a,b),f(o,p),f(o,h),f(h,d),f(h,_),f(_,m),f(m,y),f(o,x),f(o,S),f(S,k),f(S,w),f(w,v),f(v,A),f(e,G),f(e,T),f(e,H),f(e,D),f(e,R),pe(N,e,null),f(e,Z),B.m(e,null),M=!0},p(C,[q]){(!M||q&2)&&Q(b,C[1]),(!M||q&4)&&Q(y,C[2]),(!M||q&8)&&Q(A,C[3]),I===(I=P(C))&&B?B.p(C,q):(B.d(1),B=I(C),B&&(B.c(),B.m(e,null)))},i(C){M||(ne(N.$$.fragment,C),M=!0)},o(C){oe(N.$$.fragment,C),M=!1},d(C){C&&j(e),_e(N),B.d()}}}function _i(t,e,n){let r,s,o;Ce(t,Xe,y=>n(11,s=y)),Ce(t,De,y=>n(12,o=y));let{privKey:c}=e,l,i,a,b,p,h,d,_,m;return Le(De,o=Re.CURVE.r,o),t.$$set=y=>{"privKey"in y&&n(10,c=y.privKey)},t.$$.update=()=>{if(t.$$.dirty&2048&&n(0,r=s.length>0),t.$$.dirty&3073){const y=Re.getPublicKey(c),x=Re.G1.ProjectivePoint.fromHex(y);if(n(1,[l,i]=[x.x,x.y].map(S=>Ue(S)),l,(n(2,i),n(10,c),n(0,r),n(11,s))),n(3,a=Ke(y)),r){const S=We(s),k=Re.sign(S,c),w=Re.G2.ProjectivePoint.fromHex(k);n(5,[p,h,d,_]=[w.x.c0,w.x.c1,w.y.c0,w.y.c1].map(v=>Ue(v)),p,(n(6,h),n(10,c),n(0,r),n(11,s)),(n(7,d),n(10,c),n(0,r),n(11,s)),(n(8,_),n(10,c),n(0,r),n(11,s))),n(4,b=Ke(S)),n(9,m=Ke(k))}}},[r,l,i,a,b,p,h,d,_,m,c,s]}class mi extends Ze{constructor(e){super(),Ge(this,e,_i,pi,Me,{privKey:10})}}function Es(t,e,n){const r=t.slice();return r[18]=e[n],r[20]=n,r}function gi(t){let e;return{c(){e=u("p"),e.textContent=`${hr}`,g(e,"class","error svelte-150l3yf")},m(n,r){V(n,e,r)},p:ve,d(n){n&&j(e)}}}function Bs(t){let e,n;return e=new xn({props:{hash:t[18],checked:t[20]===0}}),e.$on("change",t[11]),{c(){ge(e.$$.fragment)},m(r,s){pe(e,r,s),n=!0},p:ve,i(r){n||(ne(e.$$.fragment,r),n=!0)},o(r){oe(e.$$.fragment,r),n=!1},d(r){_e(e,r)}}}function yi(t){let e,n,r=t[10],s=[];for(let c=0;c<r.length;c+=1)s[c]=Bs(Es(t,r,c));const o=c=>oe(s[c],1,1,()=>{s[c]=null});return{c(){for(let c=0;c<s.length;c+=1)s[c].c();e=dt()},m(c,l){for(let i=0;i<s.length;i+=1)s[i].m(c,l);V(c,e,l),n=!0},p(c,l){if(l&3072){r=c[10];let i;for(i=0;i<r.length;i+=1){const a=Es(c,r,i);s[i]?(s[i].p(a,l),ne(s[i],1)):(s[i]=Bs(a),s[i].c(),ne(s[i],1),s[i].m(e.parentNode,e))}for(lt(),i=r.length;i<s.length;i+=1)o(i);it()}},i(c){if(!n){for(let l=0;l<r.length;l+=1)ne(s[l]);n=!0}},o(c){s=s.filter(Boolean);for(let l=0;l<s.length;l+=1)oe(s[l]);n=!1},d(c){ut(s,c),c&&j(e)}}}function xi(t){let e;return{c(){e=u("p"),e.textContent=`${ze.NO_MESSAGE}`},m(n,r){V(n,e,r)},p:ve,d(n){n&&j(e)}}}function vi(t){let e,n,r,s,o,c,l,i,a,b,p,h,d,_,m,y,x,S,k,w,v,A,G,T,H,D,R,N,Z,M,P;return{c(){e=u("table"),n=u("tbody"),r=u("tr"),s=u("td"),s.textContent="msgHash",o=u("td"),c=u("code"),l=F(t[9]),i=O(),a=u("tr"),b=u("td"),b.textContent="r",p=u("td"),h=u("code"),d=F(t[5]),_=O(),m=u("tr"),y=u("td"),y.textContent="s",x=u("td"),S=u("code"),k=F(t[6]),w=O(),v=u("tr"),A=u("td"),A.textContent="compact",G=u("td"),T=u("code"),H=F(t[7]),D=O(),R=u("tr"),N=u("td"),N.textContent="der",Z=u("td"),M=u("code"),P=F(t[8]),g(s,"class","curve-data__key"),g(b,"class","curve-data__key"),g(y,"class","curve-data__key"),g(A,"class","curve-data__key"),g(N,"class","curve-data__key"),g(e,"class","curve-data__table")},m(I,B){V(I,e,B),f(e,n),f(n,r),f(r,s),f(r,o),f(o,c),f(c,l),f(n,i),f(n,a),f(a,b),f(a,p),f(p,h),f(h,d),f(n,_),f(n,m),f(m,y),f(m,x),f(x,S),f(S,k),f(n,w),f(n,v),f(v,A),f(v,G),f(G,T),f(T,H),f(n,D),f(n,R),f(R,N),f(R,Z),f(Z,M),f(M,P)},p(I,B){B&512&&Q(l,I[9]),B&32&&Q(d,I[5]),B&64&&Q(k,I[6]),B&128&&Q(H,I[7]),B&256&&Q(P,I[8])},d(I){I&&j(e)}}}function wi(t){let e,n,r,s,o,c,l,i,a,b,p,h,d,_,m,y,x,S,k,w,v,A,G,T,H,D,R,N,Z,M,P,I,B,C,q,U,z,X=hr.length&&gi();B=new Et({}),q=new yn({props:{$$slots:{default:[yi]},$$scope:{ctx:t}}});function W($,se){return $[0]?vi:xi}let L=W(t),Y=L(t);return{c(){X&&X.c(),e=O(),n=u("div"),r=u("h3"),r.textContent="Public key",s=O(),o=u("table"),c=u("tbody"),l=u("tr"),i=u("td"),i.textContent="x",a=u("td"),b=u("code"),p=F(t[1]),h=O(),d=u("tr"),_=u("td"),_.textContent="y",m=u("td"),y=u("code"),x=F(t[2]),S=O(),k=u("tr"),w=u("td"),w.textContent="33b hex",v=u("td"),A=u("code"),G=F(t[3]),T=O(),H=u("tr"),D=u("td"),D.textContent="64b hex",R=u("td"),N=u("code"),Z=F(t[4]),M=O(),P=u("h3"),P.textContent="Signature",I=O(),ge(B.$$.fragment),C=O(),ge(q.$$.fragment),U=O(),Y.c(),g(r,"class","curve-data__header"),g(i,"class","curve-data__key"),g(_,"class","curve-data__key"),g(w,"class","curve-data__key"),g(D,"class","curve-data__key"),g(o,"class","curve-data__table"),g(P,"class","curve-data__header"),g(n,"class","curve-data")},m($,se){X&&X.m($,se),V($,e,se),V($,n,se),f(n,r),f(n,s),f(n,o),f(o,c),f(c,l),f(l,i),f(l,a),f(a,b),f(b,p),f(c,h),f(c,d),f(d,_),f(d,m),f(m,y),f(y,x),f(c,S),f(c,k),f(k,w),f(k,v),f(v,A),f(A,G),f(c,T),f(c,H),f(H,D),f(H,R),f(R,N),f(N,Z),f(n,M),f(n,P),f(n,I),pe(B,n,null),f(n,C),pe(q,n,null),f(n,U),Y.m(n,null),z=!0},p($,[se]){hr.length&&X.p($,se),(!z||se&2)&&Q(p,$[1]),(!z||se&4)&&Q(x,$[2]),(!z||se&8)&&Q(G,$[3]),(!z||se&16)&&Q(Z,$[4]);const ie={};se&2097152&&(ie.$$scope={dirty:se,ctx:$}),q.$set(ie),L===(L=W($))&&Y?Y.p($,se):(Y.d(1),Y=L($),Y&&(Y.c(),Y.m(n,null)))},i($){z||(ne(B.$$.fragment,$),ne(q.$$.fragment,$),z=!0)},o($){oe(B.$$.fragment,$),oe(q.$$.fragment,$),z=!1},d($){X&&X.d($),$&&j(e),$&&j(n),_e(B),_e(q),Y.d()}}}let hr="";function Ei(t,e,n){let r,s,o;Ce(t,ur,v=>n(16,s=v)),Ce(t,Xe,v=>n(15,o=v));let{privKey:c}=e,{CURVE:l}=e,i,a,b,p,h,d,_,m,y,x="sha256";const S={sha256:We,sha3_256:Ir,keccak_256:Cr},k=Object.keys(S),w=v=>{n(14,x=v.detail)};return t.$$set=v=>{"privKey"in v&&n(12,c=v.privKey),"CURVE"in v&&n(13,l=v.CURVE)},t.$$.update=()=>{if(t.$$.dirty&32768&&n(0,r=o.length>0),t.$$.dirty&61441)try{const v=l.getPublicKey(c),A=l.ProjectivePoint.fromHex(v);if(n(1,[i,a]=[A.x,A.y].map(G=>Ue(G)),i,(n(2,a),n(13,l),n(12,c),n(0,r),n(14,x),n(15,o))),n(3,b=A.toHex(!0)),n(4,p=A.toHex(!1)),r){const G=S[x],T=G(o),H=l.sign(T,c);n(5,[h,d]=[H.r,H.s].map(D=>Ue(D)),h,(n(6,d),n(13,l),n(12,c),n(0,r),n(14,x),n(15,o))),n(7,_=H.toCompactHex()),n(8,m=H.toDERHex()),n(9,y=Ke(T))}}catch(v){Le(ur,s=Dt(v),s)}},[r,i,a,b,p,h,d,_,m,y,k,w,c,l,x,o]}class Bi extends Ze{constructor(e){super(),Ge(this,e,Ei,wi,Me,{privKey:12,CURVE:13})}}function ki(t){let e,n,r,s,o,c,l,i,a,b,p,h,d;return{c(){e=u("div"),n=u("div"),r=u("label"),r.innerHTML="<strong>Private key in hex format</strong>",s=O(),o=u("button"),o.textContent="Generate Random",c=O(),l=u("div"),i=u("input"),a=O(),b=u("div"),p=F(t[1]),g(r,"for","priv-key-input"),g(r,"class","priv-key__label svelte-rjm8o7"),g(o,"type","button"),g(o,"class","priv-key__btn button svelte-rjm8o7"),g(n,"class","priv-key__header svelte-rjm8o7"),g(i,"class","text-input"),g(i,"id","priv-key-input"),g(i,"type","text"),g(i,"maxlength",t[0]),i.value=t[2],g(b,"class","error svelte-rjm8o7"),g(e,"class","priv-key svelte-rjm8o7")},m(_,m){V(_,e,m),f(e,n),f(n,r),f(n,s),f(n,o),f(e,c),f(e,l),f(l,i),f(e,a),f(e,b),f(b,p),h||(d=[ke(o,"click",t[3]),ke(i,"input",t[4])],h=!0)},p(_,[m]){m&1&&g(i,"maxlength",_[0]),m&4&&i.value!==_[2]&&(i.value=_[2]),m&2&&Q(p,_[1])},i:ve,o:ve,d(_){_&&j(e),h=!1,at(d)}}}function Si(t){return/[^0-9A-Fa-f]/g.test(t)}function Ii(t,e,n){let r,s;Ce(t,ft,p=>n(2,r=p)),Ce(t,De,p=>n(7,s=p));let{keyLength:o}=e,{curve:c}=e,l=c,i="";function a(){const p=window.crypto.getRandomValues(new Uint8Array(o/2));Le(ft,r=Ke(p),r),n(1,i="")}function b(p){const h=p.target.value,d=c.split("_").join(" ");h.length!==o||Si(h)?n(1,i=`Key must be ${o/2} bytes (${o} hex digits) for ${d}`):BigInt(`0x${h}`)>=s?n(1,i="Key is out of curve's order (n)"):(Le(ft,r=h,r),n(1,i=""))}return t.$$set=p=>{"keyLength"in p&&n(0,o=p.keyLength),"curve"in p&&n(5,c=p.curve)},t.$$.update=()=>{t.$$.dirty&96&&l!==c&&(n(6,l=c),n(1,i=""))},[o,i,r,a,b,c,l]}class Ci extends Ze{constructor(e){super(),Ge(this,e,Ii,ki,Me,{keyLength:0,curve:5})}}function ks(t){let e,n;return{c(){e=u("div"),n=F(t[5]),g(e,"class","error svelte-zr5c9k")},m(r,s){V(r,e,s),f(e,n)},p(r,s){s&32&&Q(n,r[5])},d(r){r&&j(e)}}}function Ss(t){let e,n;return{c(){e=u("div"),n=F(t[6]),g(e,"class","error svelte-zr5c9k")},m(r,s){V(r,e,s),f(e,n)},p(r,s){s&64&&Q(n,r[6])},d(r){r&&j(e)}}}function Is(t){let e,n;return{c(){e=u("div"),n=F(t[7]),g(e,"class","error svelte-zr5c9k")},m(r,s){V(r,e,s),f(e,n)},p(r,s){s&128&&Q(n,r[7])},d(r){r&&j(e)}}}function Cs(t){let e,n;return{c(){e=u("div"),n=F(t[8]),g(e,"class","error svelte-zr5c9k")},m(r,s){V(r,e,s),f(e,n)},p(r,s){s&256&&Q(n,r[8])},d(r){r&&j(e)}}}function As(t){let e,n;return{c(){e=u("div"),n=F(t[9]),g(e,"class","error svelte-zr5c9k")},m(r,s){V(r,e,s),f(e,n)},p(r,s){s&512&&Q(n,r[9])},d(r){r&&j(e)}}}function Ai(t){let e,n,r,s,o,c,l,i,a,b,p,h,d,_,m,y,x,S,k,w,v,A,G,T,H,D,R,N,Z,M,P,I,B,C,q,U,z,X,W,L,Y,$=t[5]&&ks(t),se=t[6]&&Ss(t),ie=t[7]&&Is(t),be=t[8]&&Cs(t),de=t[9]&&As(t);return{c(){e=u("h3"),e.textContent="Define custom weierstrass curve",n=O(),r=u("div"),r.innerHTML=`<div class="subheader svelte-zr5c9k">Curve&#39;s formula is <b>y² = x³ + ax + b</b></div> 
  <div>Generator point (<b>G</b>) used for curve calculator:
    <ul class="curve-desc__coords svelte-zr5c9k"><li class="svelte-zr5c9k"><b class="svelte-zr5c9k">Gx</b>: <code class="svelte-zr5c9k">0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296</code></li> 
      <li class="svelte-zr5c9k"><b class="svelte-zr5c9k">Gy</b>: <code class="svelte-zr5c9k">0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5</code></li></ul> 
    <b>a</b> and <b>b</b> params must be non-floating point integers. <b>P</b>, <b>n</b> and <b>h</b> must be positive and non-floating point integers.</div>`,s=O(),o=u("div"),c=u("div"),l=u("label"),l.innerHTML="<strong>a</strong> - constant &quot;a&quot;",i=O(),a=u("input"),b=O(),$&&$.c(),p=O(),h=u("div"),d=u("label"),d.innerHTML="<strong>b</strong> - constant &quot;b&quot;",_=O(),m=u("input"),y=O(),se&&se.c(),x=O(),S=u("div"),k=u("label"),k.innerHTML="<strong>P</strong> - modulus at <b>y² ≡ x³ + ax + b (mod p)</b>",w=O(),v=u("input"),A=O(),ie&&ie.c(),G=O(),T=u("div"),H=u("label"),H.innerHTML="<strong>n</strong> - curve order, the count of all possible EC points",D=O(),R=u("input"),N=O(),be&&be.c(),Z=O(),M=u("div"),P=u("label"),P.innerHTML="<strong>h</strong> - cofactor, the number of subgroups",I=O(),B=u("input"),C=O(),de&&de.c(),q=O(),U=u("div"),z=F(t[10]),X=O(),W=u("button"),W.textContent="Create curve",g(e,"class","header svelte-zr5c9k"),g(r,"class","curve-desc svelte-zr5c9k"),g(l,"for","a"),g(l,"class","priv-key__label"),g(a,"class","text-input svelte-zr5c9k"),g(a,"id","a"),g(a,"type","text"),g(a,"name","a"),g(a,"placeholder","a"),g(c,"class","curve__field svelte-zr5c9k"),g(d,"for","b"),g(d,"class","priv-key__label"),g(m,"class","text-input svelte-zr5c9k"),g(m,"id","b"),g(m,"type","text"),g(m,"name","b"),g(m,"placeholder","b"),g(h,"class","curve__field svelte-zr5c9k"),g(k,"for","P"),g(k,"class","priv-key__label"),g(v,"class","text-input svelte-zr5c9k"),g(v,"id","P"),g(v,"type","text"),g(v,"name","P"),g(v,"placeholder","P"),g(S,"class","curve__field svelte-zr5c9k"),g(H,"for","n"),g(H,"class","priv-key__label"),g(R,"class","text-input svelte-zr5c9k"),g(R,"id","n"),g(R,"type","text"),g(R,"name","n"),g(R,"placeholder","n"),g(T,"class","curve__field svelte-zr5c9k"),g(P,"for","h"),g(P,"class","priv-key__label"),g(B,"class","text-input svelte-zr5c9k"),g(B,"id","h"),g(B,"type","text"),g(B,"name","h"),g(B,"placeholder","h"),g(M,"class","curve__field svelte-zr5c9k"),g(U,"class","error svelte-zr5c9k"),g(W,"class","button svelte-zr5c9k"),g(o,"class","curve svelte-zr5c9k")},m(fe,me){V(fe,e,me),V(fe,n,me),V(fe,r,me),V(fe,s,me),V(fe,o,me),f(o,c),f(c,l),f(c,i),f(c,a),tt(a,t[0]),f(c,b),$&&$.m(c,null),f(o,p),f(o,h),f(h,d),f(h,_),f(h,m),tt(m,t[1]),f(h,y),se&&se.m(h,null),f(o,x),f(o,S),f(S,k),f(S,w),f(S,v),tt(v,t[2]),f(S,A),ie&&ie.m(S,null),f(o,G),f(o,T),f(T,H),f(T,D),f(T,R),tt(R,t[3]),f(T,N),be&&be.m(T,null),f(o,Z),f(o,M),f(M,P),f(M,I),f(M,B),tt(B,t[4]),f(M,C),de&&de.m(M,null),f(o,q),f(o,U),f(U,z),f(o,X),f(o,W),L||(Y=[ke(a,"input",t[13]),ke(m,"input",t[14]),ke(v,"input",t[15]),ke(R,"input",t[16]),ke(B,"input",t[17]),ke(W,"click",t[11])],L=!0)},p(fe,[me]){me&1&&a.value!==fe[0]&&tt(a,fe[0]),fe[5]?$?$.p(fe,me):($=ks(fe),$.c(),$.m(c,null)):$&&($.d(1),$=null),me&2&&m.value!==fe[1]&&tt(m,fe[1]),fe[6]?se?se.p(fe,me):(se=Ss(fe),se.c(),se.m(h,null)):se&&(se.d(1),se=null),me&4&&v.value!==fe[2]&&tt(v,fe[2]),fe[7]?ie?ie.p(fe,me):(ie=Is(fe),ie.c(),ie.m(S,null)):ie&&(ie.d(1),ie=null),me&8&&R.value!==fe[3]&&tt(R,fe[3]),fe[8]?be?be.p(fe,me):(be=Cs(fe),be.c(),be.m(T,null)):be&&(be.d(1),be=null),me&16&&B.value!==fe[4]&&tt(B,fe[4]),fe[9]?de?de.p(fe,me):(de=As(fe),de.c(),de.m(M,null)):de&&(de.d(1),de=null),me&1024&&Q(z,fe[10])},i:ve,o:ve,d(fe){fe&&j(e),fe&&j(n),fe&&j(r),fe&&j(s),fe&&j(o),$&&$.d(),se&&se.d(),ie&&ie.d(),be&&be.d(),de&&de.d(),L=!1,at(Y)}}}function Oi(t,e,n){let r,s;Ce(t,ur,H=>n(12,s=H));const o=pr();let c="",l=-3n,i=41058363725152142129326129780047268409114441015993725554835256314039467401291n,a=115792089210356248762697446949407573530086143415290314195533631308867097853951n,b=115792089210356248762697446949407573529996955224135760342422259061068512044369n,p=1n;const h=BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),d=BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5");let _="",m="",y="",x="",S="";const k=()=>{if(r)return;if(n(0,l=BigInt(l)),n(1,i=BigInt(i)),n(2,a=BigInt(a)),n(3,b=BigInt(b)),n(4,p=BigInt(p)),ye(d**2n,a)!==ye(h**3n+l*h+i,a)){n(10,c="Values of a, b, p, Gx, and Gy do not match the equation y² ≡ x³ + ax + b (mod p)");return}let H;try{const D=wt(a),R=D.create(l);H=gn({a:R,b:i,Fp:D,n:b,Gx:h,Gy:d,h:p,lowS:!1},We)}catch(D){n(10,c=Dt(D));return}n(10,c=""),o("showData",H)};function w(){l=this.value,n(0,l)}function v(){i=this.value,n(1,i)}function A(){a=this.value,n(2,a)}function G(){b=this.value,n(3,b)}function T(){p=this.value,n(4,p)}return t.$$.update=()=>{t.$$.dirty&4096&&n(10,c=s),t.$$.dirty&31&&(n(5,_=n(6,m=n(7,y=n(8,x=n(9,S=""))))),ar(l)||n(5,_=`a ${ze.INT}`),ar(i)||n(6,m=`b ${ze.INT}`),Cn(a)||n(7,y=`P ${ze.POSITIVE_INT}`),Cn(b)||n(8,x=`n ${ze.POSITIVE_INT}`),Cn(p)||n(9,S=`h ${ze.POSITIVE_INT}`)),t.$$.dirty&992&&(r=_.length||m.length||y.length||x.length||S.length)},[l,i,a,b,p,_,m,y,x,S,c,k,s,w,v,A,G,T]}class Pi extends Ze{constructor(e){super(),Ge(this,e,Oi,Ai,Me,{})}}function Os(t){let e,n;return{c(){e=u("div"),n=F(t[3]),g(e,"class","error svelte-oqfmga")},m(r,s){V(r,e,s),f(e,n)},p(r,s){s&8&&Q(n,r[3])},d(r){r&&j(e)}}}function Ri(t){let e,n,r,s,o,c,l,i,a,b,p=t[3].length&&Os(t);return{c(){e=u("div"),n=u("label"),r=u("strong"),s=F(t[2]),o=O(),c=u("input"),l=O(),p&&p.c(),i=dt(),g(n,"class","point-input__label svelte-oqfmga"),g(n,"for",t[0]),g(c,"class","text-input"),g(c,"id",t[0]),g(c,"type","text"),c.value=t[1],g(e,"class","point-input svelte-oqfmga")},m(h,d){V(h,e,d),f(e,n),f(n,r),f(r,s),f(e,o),f(e,c),V(h,l,d),p&&p.m(h,d),V(h,i,d),a||(b=ke(c,"input",t[4]),a=!0)},p(h,[d]){d&4&&Q(s,h[2]),d&1&&g(n,"for",h[0]),d&1&&g(c,"id",h[0]),d&2&&c.value!==h[1]&&(c.value=h[1]),h[3].length?p?p.p(h,d):(p=Os(h),p.c(),p.m(i.parentNode,i)):p&&(p.d(1),p=null)},i:ve,o:ve,d(h){h&&j(e),h&&j(l),p&&p.d(h),h&&j(i),a=!1,b()}}}function Hi(t,e,n){const r=pr();let{field:s}=e,{value:o}=e,{label:c}=e,l="";const i=a=>{const{value:b}=a.target;if(b!=="-"){if(!ar(b)){n(3,l=`${c} should be non floating point integer`);return}n(3,l=""),r("input",{value:b,field:s})}};return t.$$set=a=>{"field"in a&&n(0,s=a.field),"value"in a&&n(1,o=a.value),"label"in a&&n(2,c=a.label)},[s,o,c,l,i]}class rt extends Ze{constructor(e){super(),Ge(this,e,Hi,Ri,Me,{field:0,value:1,label:2})}}function Ps(t,e,n){const r=t.slice();return r[56]=e[n],r}function Rs(t,e,n){const r=t.slice();return r[59]=e[n],r[61]=n,r}function Hs(t,e,n){const r=t.slice();return r[62]=e[n],r}function Ti(t){let e,n,r=t[56].type+"",s,o,c,l,i=t[56].list,a=[];for(let b=0;b<i.length;b+=1)a[b]=Ns(Rs(t,i,b));return{c(){e=u("div"),n=u("div"),s=F(r),o=O(),c=u("div");for(let b=0;b<a.length;b+=1)a[b].c();l=O(),g(n,"class","curves-list__title"),g(e,"class","curves-list")},m(b,p){V(b,e,p),f(e,n),f(n,s),f(e,o),f(e,c);for(let h=0;h<a.length;h+=1)a[h].m(c,null);f(e,l)},p(b,p){if(p[0]&67108864){i=b[56].list;let h;for(h=0;h<i.length;h+=1){const d=Rs(b,i,h);a[h]?a[h].p(d,p):(a[h]=Ns(d),a[h].c(),a[h].m(c,null))}for(;h<a.length;h+=1)a[h].d(1);a.length=i.length}},d(b){b&&j(e),ut(a,b)}}}function Ni(t){let e,n,r,s,o=t[59]+"",c,l,i,a;return{c(){e=u("div"),n=u("input"),r=O(),s=u("label"),c=F(o),l=O(),g(n,"type","radio"),g(n,"name","points_curve"),n.value="points_"+t[59],g(n,"id",`points_${t[56].type}_${t[59]}`),n.checked=t[56].type=="ECDSA"&&t[61]==0,g(s,"for",`points_${t[56].type}_${t[59]}`),g(e,"class","ecc-radio")},m(b,p){V(b,e,p),f(e,n),f(e,r),f(e,s),f(s,c),f(e,l),i||(a=ke(n,"change",t[26]),i=!0)},p:ve,d(b){b&&j(e),i=!1,a()}}}function Li(t){let e,n=t[56].options,r=[];for(let s=0;s<n.length;s+=1)r[s]=Ts(Hs(t,n,s));return{c(){for(let s=0;s<r.length;s+=1)r[s].c();e=dt()},m(s,o){for(let c=0;c<r.length;c+=1)r[c].m(s,o);V(s,e,o)},p(s,o){if(o[0]&67108864){n=s[56].options;let c;for(c=0;c<n.length;c+=1){const l=Hs(s,n,c);r[c]?r[c].p(l,o):(r[c]=Ts(l),r[c].c(),r[c].m(e.parentNode,e))}for(;c<r.length;c+=1)r[c].d(1);r.length=n.length}},d(s){ut(r,s),s&&j(e)}}}function Ts(t){let e,n,r,s,o=t[59]+"",c,l,i=t[62]+"",a,b,p,h;return{c(){e=u("div"),n=u("input"),r=O(),s=u("label"),c=F(o),l=F(" - "),a=F(i),b=O(),g(n,"type","radio"),g(n,"name","points_curve"),n.value="points_"+t[59]+"_"+t[62],g(n,"id",`points_${t[56].type}_${t[59]}_${t[62]}`),g(s,"for",`points_${t[56].type}_${t[59]}_${t[62]}`),g(e,"class","ecc-radio")},m(d,_){V(d,e,_),f(e,n),f(e,r),f(e,s),f(s,c),f(s,l),f(s,a),f(e,b),p||(h=ke(n,"change",t[26]),p=!0)},p:ve,d(d){d&&j(e),p=!1,h()}}}function Ns(t){let e;function n(o,c){return o[59]=="bls12-381"?Li:Ni}let s=n(t)(t);return{c(){s.c(),e=dt()},m(o,c){s.m(o,c),V(o,e,c)},p(o,c){s.p(o,c)},d(o){s.d(o),o&&j(e)}}}function Ls(t){let e,n=t[56].type!=="Schnorr"&&Ti(t);return{c(){n&&n.c(),e=dt()},m(r,s){n&&n.m(r,s),V(r,e,s)},p(r,s){r[56].type!=="Schnorr"&&n.p(r,s)},d(r){n&&n.d(r),r&&j(e)}}}function qi(t){let e,n,r,s;return e=new rt({props:{label:"x",field:"a_x",value:t[0]}}),e.$on("input",t[27]),r=new rt({props:{label:"y",field:"a_y",value:t[1]}}),r.$on("input",t[27]),{c(){ge(e.$$.fragment),n=O(),ge(r.$$.fragment)},m(o,c){pe(e,o,c),V(o,n,c),pe(r,o,c),s=!0},p(o,c){const l={};c[0]&1&&(l.value=o[0]),e.$set(l);const i={};c[0]&2&&(i.value=o[1]),r.$set(i)},i(o){s||(ne(e.$$.fragment,o),ne(r.$$.fragment,o),s=!0)},o(o){oe(e.$$.fragment,o),oe(r.$$.fragment,o),s=!1},d(o){_e(e,o),o&&j(n),_e(r,o)}}}function Ui(t){let e,n,r,s,o,c,l,i,a,b,p,h;return r=new rt({props:{label:"c0",field:"a_x_c0",value:t[6]}}),r.$on("input",t[27]),o=new rt({props:{label:"c1",field:"a_x_c1",value:t[7]}}),o.$on("input",t[27]),a=new rt({props:{label:"c0",field:"a_y_c0",value:t[8]}}),a.$on("input",t[27]),p=new rt({props:{label:"c1",field:"a_y_c1",value:t[9]}}),p.$on("input",t[27]),{c(){e=u("div"),e.innerHTML="<strong>x</strong>",n=O(),ge(r.$$.fragment),s=O(),ge(o.$$.fragment),c=O(),l=u("div"),l.innerHTML="<strong>y</strong>",i=O(),ge(a.$$.fragment),b=O(),ge(p.$$.fragment)},m(d,_){V(d,e,_),V(d,n,_),pe(r,d,_),V(d,s,_),pe(o,d,_),V(d,c,_),V(d,l,_),V(d,i,_),pe(a,d,_),V(d,b,_),pe(p,d,_),h=!0},p(d,_){const m={};_[0]&64&&(m.value=d[6]),r.$set(m);const y={};_[0]&128&&(y.value=d[7]),o.$set(y);const x={};_[0]&256&&(x.value=d[8]),a.$set(x);const S={};_[0]&512&&(S.value=d[9]),p.$set(S)},i(d){h||(ne(r.$$.fragment,d),ne(o.$$.fragment,d),ne(a.$$.fragment,d),ne(p.$$.fragment,d),h=!0)},o(d){oe(r.$$.fragment,d),oe(o.$$.fragment,d),oe(a.$$.fragment,d),oe(p.$$.fragment,d),h=!1},d(d){d&&j(e),d&&j(n),_e(r,d),d&&j(s),_e(o,d),d&&j(c),d&&j(l),d&&j(i),_e(a,d),d&&j(b),_e(p,d)}}}function qs(t){let e,n,r,s,o,c,l,i,a,b,p,h,d,_,m,y,x,S,k,w,v;const A=[Di,Mi],G=[];function T(H,D){return H[23]?0:1}return _=T(t),m=G[_]=A[_](t),{c(){e=u("div"),n=u("div"),r=u("strong"),r.textContent="Point B",s=O(),o=u("small"),o.textContent="(x, y)",c=O(),l=u("span"),i=u("button"),i.textContent="Base",a=O(),b=u("button"),b.textContent="Zero",p=O(),h=u("button"),h.textContent="Random",d=O(),m.c(),y=O(),x=u("div"),S=F(t[21]),g(i,"class","point-header__btn button svelte-1csuk34"),g(b,"class","point-header__btn button svelte-1csuk34"),g(h,"class","point-header__btn button svelte-1csuk34"),g(l,"class","point-header__btns svelte-1csuk34"),g(n,"class","point-header svelte-1csuk34"),g(x,"class","error svelte-1csuk34"),g(e,"class","fields-block svelte-1csuk34")},m(H,D){V(H,e,D),f(e,n),f(n,r),f(n,s),f(n,o),f(n,c),f(n,l),f(l,i),f(l,a),f(l,b),f(l,p),f(l,h),f(e,d),G[_].m(e,null),f(e,y),f(e,x),f(x,S),k=!0,w||(v=[ke(i,"click",t[38]),ke(b,"click",t[39]),ke(h,"click",t[40])],w=!0)},p(H,D){let R=_;_=T(H),_===R?G[_].p(H,D):(lt(),oe(G[R],1,1,()=>{G[R]=null}),it(),m=G[_],m?m.p(H,D):(m=G[_]=A[_](H),m.c()),ne(m,1),m.m(e,y)),(!k||D[0]&2097152)&&Q(S,H[21])},i(H){k||(ne(m),k=!0)},o(H){oe(m),k=!1},d(H){H&&j(e),G[_].d(),w=!1,at(v)}}}function Mi(t){let e,n,r,s;return e=new rt({props:{label:"x",field:"b_x",value:t[2]}}),e.$on("input",t[27]),r=new rt({props:{label:"y",field:"b_y",value:t[3]}}),r.$on("input",t[27]),{c(){ge(e.$$.fragment),n=O(),ge(r.$$.fragment)},m(o,c){pe(e,o,c),V(o,n,c),pe(r,o,c),s=!0},p(o,c){const l={};c[0]&4&&(l.value=o[2]),e.$set(l);const i={};c[0]&8&&(i.value=o[3]),r.$set(i)},i(o){s||(ne(e.$$.fragment,o),ne(r.$$.fragment,o),s=!0)},o(o){oe(e.$$.fragment,o),oe(r.$$.fragment,o),s=!1},d(o){_e(e,o),o&&j(n),_e(r,o)}}}function Di(t){let e,n,r,s,o,c,l,i,a,b,p,h;return r=new rt({props:{label:"c0",field:"b_x_c0",value:t[10]}}),r.$on("input",t[27]),o=new rt({props:{label:"c1",field:"b_x_c1",value:t[11]}}),o.$on("input",t[27]),a=new rt({props:{label:"c0",field:"b_y_c0",value:t[12]}}),a.$on("input",t[27]),p=new rt({props:{label:"c1",field:"b_y_c1",value:t[13]}}),p.$on("input",t[27]),{c(){e=u("div"),e.innerHTML="<strong>x</strong>",n=O(),ge(r.$$.fragment),s=O(),ge(o.$$.fragment),c=O(),l=u("div"),l.innerHTML="<strong>y</strong>",i=O(),ge(a.$$.fragment),b=O(),ge(p.$$.fragment)},m(d,_){V(d,e,_),V(d,n,_),pe(r,d,_),V(d,s,_),pe(o,d,_),V(d,c,_),V(d,l,_),V(d,i,_),pe(a,d,_),V(d,b,_),pe(p,d,_),h=!0},p(d,_){const m={};_[0]&1024&&(m.value=d[10]),r.$set(m);const y={};_[0]&2048&&(y.value=d[11]),o.$set(y);const x={};_[0]&4096&&(x.value=d[12]),a.$set(x);const S={};_[0]&8192&&(S.value=d[13]),p.$set(S)},i(d){h||(ne(r.$$.fragment,d),ne(o.$$.fragment,d),ne(a.$$.fragment,d),ne(p.$$.fragment,d),h=!0)},o(d){oe(r.$$.fragment,d),oe(o.$$.fragment,d),oe(a.$$.fragment,d),oe(p.$$.fragment,d),h=!1},d(d){d&&j(e),d&&j(n),_e(r,d),d&&j(s),_e(o,d),d&&j(c),d&&j(l),d&&j(i),_e(a,d),d&&j(b),_e(p,d)}}}function Us(t){let e,n,r,s,o,c,l,i,a,b,p,h,d,_,m;return{c(){e=u("div"),n=u("div"),n.innerHTML=`<strong>Scalar</strong> 
      <small>(number used for multiply operation)</small>`,r=O(),s=u("div"),o=u("input"),c=O(),l=u("div"),i=u("input"),a=O(),b=u("label"),b.textContent="Is hex",p=O(),h=u("div"),d=F(t[22]),g(n,"class","point-header svelte-1csuk34"),g(o,"class","text-input"),g(o,"id","scalar"),g(o,"type","text"),o.value=t[18],g(s,"class","point-input svelte-1csuk34"),g(i,"id","scalar-hex"),g(i,"class","scalar-checkbox svelte-1csuk34"),g(i,"type","checkbox"),g(b,"for","scalar-hex"),g(h,"class","error svelte-1csuk34"),g(e,"class","fields-block svelte-1csuk34")},m(y,x){V(y,e,x),f(e,n),f(e,r),f(e,s),f(s,o),f(e,c),f(e,l),f(l,i),f(l,a),f(l,b),f(e,p),f(e,h),f(h,d),_||(m=[ke(o,"input",t[28]),ke(i,"click",t[29])],_=!0)},p(y,x){x[0]&262144&&o.value!==y[18]&&(o.value=y[18]),x[0]&4194304&&Q(d,y[22])},d(y){y&&j(e),_=!1,at(m)}}}function Gi(t){let e,n,r,s,o,c,l,i,a,b,p,h,d,_;return{c(){e=u("table"),n=u("tr"),r=u("td"),r.innerHTML="<strong>x:</strong>",s=O(),o=u("td"),c=u("code"),l=F(t[4]),i=O(),a=u("tr"),b=u("td"),b.innerHTML="<strong>y:</strong>",p=O(),h=u("td"),d=u("code"),_=F(t[5]),g(r,"class","result__col result__col_title svelte-1csuk34"),g(c,"class","svelte-1csuk34"),g(o,"class","result__col svelte-1csuk34"),g(n,"class","result__row"),g(b,"class","result__col result__col_title svelte-1csuk34"),g(d,"class","svelte-1csuk34"),g(h,"class","result__col svelte-1csuk34"),g(a,"class","result__row"),g(e,"class","result")},m(m,y){V(m,e,y),f(e,n),f(n,r),f(n,s),f(n,o),f(o,c),f(c,l),f(e,i),f(e,a),f(a,b),f(a,p),f(a,h),f(h,d),f(d,_)},p(m,y){y[0]&16&&Q(l,m[4]),y[0]&32&&Q(_,m[5])},d(m){m&&j(e)}}}function Zi(t){let e,n,r,s,o,c,l,i,a,b,p,h,d,_,m,y,x,S,k,w,v,A,G,T,H,D,R,N,Z,M,P,I;return{c(){e=u("table"),n=u("tr"),n.innerHTML='<td colspan="2"><strong>x</strong></td>',r=O(),s=u("tr"),o=u("td"),o.innerHTML="<strong>c0:</strong>",c=O(),l=u("td"),i=u("code"),a=F(t[14]),b=O(),p=u("tr"),h=u("td"),h.innerHTML="<strong>c1:</strong>",d=O(),_=u("td"),m=u("code"),y=F(t[15]),x=O(),S=u("tr"),S.innerHTML='<td colspan="2"><strong>y</strong></td>',k=O(),w=u("tr"),v=u("td"),v.innerHTML="<strong>c0:</strong>",A=O(),G=u("td"),T=u("code"),H=F(t[16]),D=O(),R=u("tr"),N=u("td"),N.innerHTML="<strong>c1:</strong>",Z=O(),M=u("td"),P=u("code"),I=F(t[17]),g(o,"class","result__col result__col_title svelte-1csuk34"),g(i,"class","svelte-1csuk34"),g(l,"class","result__col svelte-1csuk34"),g(s,"class","result__row"),g(h,"class","result__col result__col_title svelte-1csuk34"),g(m,"class","svelte-1csuk34"),g(_,"class","result__col svelte-1csuk34"),g(p,"class","result__row"),g(v,"class","result__col result__col_title svelte-1csuk34"),g(T,"class","svelte-1csuk34"),g(G,"class","result__col svelte-1csuk34"),g(w,"class","result__row"),g(N,"class","result__col result__col_title svelte-1csuk34"),g(P,"class","svelte-1csuk34"),g(M,"class","result__col svelte-1csuk34"),g(R,"class","result__row"),g(e,"class","result")},m(B,C){V(B,e,C),f(e,n),f(e,r),f(e,s),f(s,o),f(s,c),f(s,l),f(l,i),f(i,a),f(e,b),f(e,p),f(p,h),f(p,d),f(p,_),f(_,m),f(m,y),f(e,x),f(e,S),f(e,k),f(e,w),f(w,v),f(w,A),f(w,G),f(G,T),f(T,H),f(e,D),f(e,R),f(R,N),f(R,Z),f(R,M),f(M,P),f(P,I)},p(B,C){C[0]&16384&&Q(a,B[14]),C[0]&32768&&Q(y,B[15]),C[0]&65536&&Q(H,B[16]),C[0]&131072&&Q(I,B[17])},d(B){B&&j(e)}}}function Ki(t){let e,n,r,s,o,c,l,i,a,b,p,h,d,_,m,y,x,S,k,w,v,A,G,T,H,D,R,N,Z,M,P,I,B,C,q,U,z,X,W,L,Y,$,se,ie,be,de,fe,me,Be,Te,ct,$e,bt,Yt,sn,ht=Rn,Ne=[];for(let J=0;J<ht.length;J+=1)Ne[J]=Ls(Ps(t,ht,J));const Ft=[Ui,qi],ue=[];function ae(J,xe){return J[23]?0:1}w=ae(t),v=ue[w]=Ft[w](t);let ce=t[25]&&qs(t),Se=t[24]&&Us(t);function st(J,xe){return J[23]?Zi:Gi}let Qe=st(t),je=Qe(t);return{c(){e=u("h3"),e.textContent="Demo 2: Elliptic curve point operations (add, subtract, multiply)",n=O(),r=u("p"),r.textContent=`This form allows adding, subtracting, and multiplying points on the chosen elliptic curve.
  By default, random coordinates are generated for A and B points.`,s=O(),o=u("div");for(let J=0;J<Ne.length;J+=1)Ne[J].c();c=O(),l=u("div"),i=u("div"),a=u("strong"),a.textContent="Point A",b=O(),p=u("small"),p.textContent="(x, y)",h=O(),d=u("span"),_=u("button"),_.textContent="Base",m=O(),y=u("button"),y.textContent="Zero",x=O(),S=u("button"),S.textContent="Random",k=O(),v.c(),A=O(),G=u("div"),T=F(t[20]),H=O(),D=u("div"),R=u("span"),N=u("input"),Z=O(),M=u("label"),M.textContent="Add",P=O(),I=u("span"),B=u("input"),C=O(),q=u("label"),q.textContent="Subtract",U=O(),z=u("span"),X=u("input"),W=O(),L=u("label"),L.textContent="Multiply",Y=O(),ce&&ce.c(),$=O(),Se&&Se.c(),se=O(),ie=u("div"),be=u("button"),be.textContent="Calculate",de=O(),fe=u("div"),me=F(t[19]),Be=O(),Te=u("div"),Te.innerHTML=`<strong>Result C</strong> 
  <small>(x, y)</small>`,ct=O(),je.c(),$e=dt(),g(e,"class","header svelte-1csuk34"),g(r,"class","subheader svelte-1csuk34"),g(o,"class","curves-list-container svelte-1csuk34"),g(_,"class","point-header__btn button svelte-1csuk34"),g(y,"class","point-header__btn button svelte-1csuk34"),g(S,"class","point-header__btn button svelte-1csuk34"),g(d,"class","point-header__btns svelte-1csuk34"),g(i,"class","point-header svelte-1csuk34"),g(G,"class","error svelte-1csuk34"),g(l,"class","fields-block svelte-1csuk34"),g(N,"type","radio"),g(N,"name","operation"),N.value="add",g(N,"id","add"),N.checked=!0,g(M,"for","add"),g(R,"class","operation svelte-1csuk34"),g(B,"type","radio"),g(B,"name","operation"),B.value="subtract",g(B,"id","subtract"),g(q,"for","subtract"),g(I,"class","operation svelte-1csuk34"),g(X,"type","radio"),g(X,"name","operation"),X.value="multiply",g(X,"id","multiply"),g(L,"for","multiply"),g(z,"class","operation svelte-1csuk34"),g(D,"class","operations svelte-1csuk34"),g(be,"class","button"),g(ie,"class","operations svelte-1csuk34"),g(fe,"class","error svelte-1csuk34"),g(Te,"class","point-header svelte-1csuk34")},m(J,xe){V(J,e,xe),V(J,n,xe),V(J,r,xe),V(J,s,xe),V(J,o,xe);for(let pt=0;pt<Ne.length;pt+=1)Ne[pt].m(o,null);V(J,c,xe),V(J,l,xe),f(l,i),f(i,a),f(i,b),f(i,p),f(i,h),f(i,d),f(d,_),f(d,m),f(d,y),f(d,x),f(d,S),f(l,k),ue[w].m(l,null),f(l,A),f(l,G),f(G,T),V(J,H,xe),V(J,D,xe),f(D,R),f(R,N),f(R,Z),f(R,M),f(D,P),f(D,I),f(I,B),f(I,C),f(I,q),f(D,U),f(D,z),f(z,X),f(z,W),f(z,L),V(J,Y,xe),ce&&ce.m(J,xe),V(J,$,xe),Se&&Se.m(J,xe),V(J,se,xe),V(J,ie,xe),f(ie,be),V(J,de,xe),V(J,fe,xe),f(fe,me),V(J,Be,xe),V(J,Te,xe),V(J,ct,xe),je.m(J,xe),V(J,$e,xe),bt=!0,Yt||(sn=[ke(_,"click",t[35]),ke(y,"click",t[36]),ke(S,"click",t[37]),ke(N,"change",t[33]),ke(B,"change",t[33]),ke(X,"change",t[33]),ke(be,"click",t[34])],Yt=!0)},p(J,xe){if(xe[0]&67108864){ht=Rn;let Je;for(Je=0;Je<ht.length;Je+=1){const Tr=Ps(J,ht,Je);Ne[Je]?Ne[Je].p(Tr,xe):(Ne[Je]=Ls(Tr),Ne[Je].c(),Ne[Je].m(o,null))}for(;Je<Ne.length;Je+=1)Ne[Je].d(1);Ne.length=ht.length}let pt=w;w=ae(J),w===pt?ue[w].p(J,xe):(lt(),oe(ue[pt],1,1,()=>{ue[pt]=null}),it(),v=ue[w],v?v.p(J,xe):(v=ue[w]=Ft[w](J),v.c()),ne(v,1),v.m(l,A)),(!bt||xe[0]&1048576)&&Q(T,J[20]),J[25]?ce?(ce.p(J,xe),xe[0]&33554432&&ne(ce,1)):(ce=qs(J),ce.c(),ne(ce,1),ce.m($.parentNode,$)):ce&&(lt(),oe(ce,1,1,()=>{ce=null}),it()),J[24]?Se?Se.p(J,xe):(Se=Us(J),Se.c(),Se.m(se.parentNode,se)):Se&&(Se.d(1),Se=null),(!bt||xe[0]&524288)&&Q(me,J[19]),Qe===(Qe=st(J))&&je?je.p(J,xe):(je.d(1),je=Qe(J),je&&(je.c(),je.m($e.parentNode,$e)))},i(J){bt||(ne(v),ne(ce),bt=!0)},o(J){oe(v),oe(ce),bt=!1},d(J){J&&j(e),J&&j(n),J&&j(r),J&&j(s),J&&j(o),ut(Ne,J),J&&j(c),J&&j(l),ue[w].d(),J&&j(H),J&&j(D),J&&j(Y),ce&&ce.d(J),J&&j($),Se&&Se.d(J),J&&j(se),J&&j(ie),J&&j(de),J&&j(fe),J&&j(Be),J&&j(Te),J&&j(ct),je.d(J),J&&j($e),Yt=!1,at(sn)}}}const ji="number must be positive and non-floating point integer, for hex click checkbox above",Vi="number must be a hex number, for decimals uncheck checkbox above";function zi(t,e,n){let r=Ve.ProjectivePoint,s=Ve,o="",c="",l="",i="",a="",b="",p="",h="",d="",_="",m="",y="",x="",S="",k="",w="",v="",A="",G="31415",T="",H="",D="",R="",N=!1,Z=!1,M=!0,P="add",I=!1;Kc(()=>{Be("A"),Be("B")});const B=ue=>{const ae=ue.target.id.toLowerCase().split("points_")[1];switch(ae){case"ecdsa_secp256k1":s=Ve,r=Ve.ProjectivePoint;break;case"ecdsa_p256":s=Rt,r=Rt.ProjectivePoint;break;case"ecdsa_p384":s=Kt,r=Kt.ProjectivePoint;break;case"ecdsa_p521":s=jt,r=jt.ProjectivePoint;break;case"eddsa_ed25519":s=Ae,r=Ae.ExtendedPoint;break;case"eddsa_ed448":s=Vt,r=Vt.ExtendedPoint;break;case"bls_bls12-381_g1":s=Re,r=Re.G1.ProjectivePoint;break;case"bls_bls12-381_g2":s=Re,r=Re.G2.ProjectivePoint;break;default:r=Ve.ProjectivePoint;break}n(23,N=ae==="bls_bls12-381_g2"),Be("A"),Be("B"),Te()},C=ue=>{const ae=r.fromAffine(ue);try{ae.assertValidity()}catch(ce){if(ce.message!=="bad point: ZERO")throw ce}return ae},q=()=>N?{x:{c0:BigInt(p),c1:BigInt(h)},y:{c0:BigInt(d),c1:BigInt(_)}}:{x:BigInt(o),y:BigInt(c)},U=()=>N?{x:{c0:BigInt(m),c1:BigInt(y)},y:{c0:BigInt(x),c1:BigInt(S)}}:{x:BigInt(l),y:BigInt(i)},z=()=>{let ue,ae;n(20,H=n(21,D=""));try{const ce=q();ue=C(ce)}catch(ce){n(20,H=Dt(ce))}try{const ce=U();ae=C(ce)}catch(ce){n(21,D=Dt(ce))}return[ue,ae]},X=()=>{const[ue,ae]=z();if(!(!ue||!ae)){n(19,T="");try{const ce=ue.add(ae);de(ce)}catch(ce){n(19,T=Dt(ce))}}},W=()=>{const[ue,ae]=z();if(!(!ue||!ae)){n(19,T="");try{const ce=ue.subtract(ae);de(ce)}catch(ce){n(19,T=Dt(ce))}}},L=()=>{if(!R){n(19,T="");try{const ue=q(),ae=C(ue),ce=BigInt(I?`0x${G}`:G),Se=ae.multiply(ce);de(Se)}catch(ue){n(19,T=Dt(ue))}}},Y=ue=>{const{field:ae,value:ce}=ue.detail;ae==="a_x"&&n(0,o=ce),ae==="a_y"&&n(1,c=ce),ae==="b_x"&&n(2,l=ce),ae==="b_y"&&n(3,i=ce),ae==="a_x_c0"&&n(6,p=ce),ae==="a_x_c1"&&n(7,h=ce),ae==="a_y_c0"&&n(8,d=ce),ae==="a_y_c1"&&n(9,_=ce),ae==="b_x_c0"&&n(10,m=ce),ae==="b_x_c1"&&n(11,y=ce),ae==="b_y_c0"&&n(12,x=ce),ae==="b_y_c1"&&n(13,S=ce)},$=ue=>{n(18,G=ue.target.value),ie()},se=ue=>{I=ue.target.checked,ie()},ie=()=>{if(I){if(yf(G)){n(22,R=Vi);return}}else if(!Cn(G)){n(22,R=ji);return}n(22,R="")},be=(ue,ae)=>{const ce=ue.toAffine();if(N){const[Se,st,Qe,je]=[ce.x.c0,ce.x.c1,ce.y.c0,ce.y.c1].map(J=>Ue(J));ae==="A"?n(6,[p,h,d,_]=[Se,st,Qe,je],p,n(7,h),n(8,d),n(9,_)):n(10,[m,y,x,S]=[Se,st,Qe,je],m,n(11,y),n(12,x),n(13,S))}else{const[Se,st]=[ce.x,ce.y].map(Qe=>Ue(Qe));ae==="A"?n(0,[o,c]=[Se,st],o,n(1,c)):ae==="B"&&n(2,[l,i]=[Se,st],l,n(3,i))}},de=ue=>{const ae=ue.toAffine();N?n(14,[k,w,v,A]=[ae.x.c0,ae.x.c1,ae.y.c0,ae.y.c1].map(ce=>Ue(ce)),k,n(15,w),n(16,v),n(17,A)):n(4,[a,b]=[ae.x,ae.y].map(ce=>Ue(ce)),a,n(5,b))},fe=ue=>{be(r.BASE,ue)},me=ue=>{be(r.ZERO,ue)},Be=ue=>{const ae=s.utils.randomPrivateKey(),ce=r.fromPrivateKey(ae);be(ce,ue)},Te=()=>{n(4,a=n(5,b=n(14,k=n(15,w=n(16,v=n(17,A=""))))))};return[o,c,l,i,a,b,p,h,d,_,m,y,x,S,k,w,v,A,G,T,H,D,R,N,Z,M,B,Y,$,se,fe,me,Be,ue=>{P=ue.target.value,n(24,Z=P==="multiply"),n(25,M=!Z),n(20,H=n(21,D=n(22,R="")))},()=>{P==="add"?X():P==="subtract"?W():P==="multiply"&&L()},()=>fe("A"),()=>me("A"),()=>Be("A"),()=>fe("B"),()=>me("B"),()=>Be("B")]}class Yi extends Ze{constructor(e){super(),Ge(this,e,zi,Ki,Me,{},null,[-1,-1,-1])}}function Ms(t,e,n){const r=t.slice();return r[8]=e[n],r}function Ds(t,e,n){const r=t.slice();return r[11]=e[n],r[13]=n,r}function Gs(t){let e,n,r,s,o=t[11]+"",c,l,i;return{c(){e=u("div"),n=u("input"),r=O(),s=u("label"),c=F(o),g(n,"type","radio"),g(n,"name","curve"),n.value=t[11],g(n,"id",`${t[8].type}_${t[11]}`),n.checked=t[8].type=="ECDSA"&&t[13]==0,g(s,"for",`${t[8].type}_${t[11]}`),g(e,"class","ecc-radio")},m(a,b){V(a,e,b),f(e,n),f(e,r),f(e,s),f(s,c),l||(i=ke(n,"change",t[5]),l=!0)},p:ve,d(a){a&&j(e),l=!1,i()}}}function Fi(t){let e,n,r,s,o,c;return{c(){e=u("div"),n=u("input"),r=O(),s=u("label"),s.textContent="create curve",g(n,"type","radio"),g(n,"name","curve"),n.value="custom",g(n,"id","custom"),g(s,"for","custom"),g(e,"class","ecc-radio")},m(l,i){V(l,e,i),f(e,n),f(e,r),f(e,s),o||(c=ke(n,"change",t[5]),o=!0)},p:ve,d(l){l&&j(e),o=!1,c()}}}function Zs(t){let e,n,r=t[8].type+"",s,o,c,l,i,a=t[8].list,b=[];for(let h=0;h<a.length;h+=1)b[h]=Gs(Ds(t,a,h));let p=t[8].type=="ECDSA"&&Fi(t);return{c(){e=u("div"),n=u("div"),s=F(r),o=O(),c=u("div");for(let h=0;h<b.length;h+=1)b[h].c();l=O(),p&&p.c(),i=O(),g(n,"class","curves-list__title"),g(e,"class","curves-list")},m(h,d){V(h,e,d),f(e,n),f(n,s),f(e,o),f(e,c);for(let _=0;_<b.length;_+=1)b[_].m(c,null);f(c,l),p&&p.m(c,null),f(e,i)},p(h,d){if(d&32){a=h[8].list;let _;for(_=0;_<a.length;_+=1){const m=Ds(h,a,_);b[_]?b[_].p(m,d):(b[_]=Gs(m),b[_].c(),b[_].m(c,l))}for(;_<b.length;_+=1)b[_].d(1);b.length=a.length}h[8].type=="ECDSA"&&p.p(h,d)},d(h){h&&j(e),ut(b,h),p&&p.d()}}}function Ks(t){let e,n;return e=new Pi({}),e.$on("showData",t[6]),{c(){ge(e.$$.fragment)},m(r,s){pe(e,r,s),n=!0},p:ve,i(r){n||(ne(e.$$.fragment,r),n=!0)},o(r){oe(e.$$.fragment,r),n=!1},d(r){_e(e,r)}}}function Wi(t){let e,n;return e=new Bi({props:{CURVE:t[1],privKey:t[4]}}),{c(){ge(e.$$.fragment)},m(r,s){pe(e,r,s),n=!0},p(r,s){const o={};s&2&&(o.CURVE=r[1]),s&16&&(o.privKey=r[4]),e.$set(o)},i(r){n||(ne(e.$$.fragment,r),n=!0)},o(r){oe(e.$$.fragment,r),n=!1},d(r){_e(e,r)}}}function Xi(t){let e,n;return e=new mi({props:{privKey:t[4]}}),{c(){ge(e.$$.fragment)},m(r,s){pe(e,r,s),n=!0},p(r,s){const o={};s&16&&(o.privKey=r[4]),e.$set(o)},i(r){n||(ne(e.$$.fragment,r),n=!0)},o(r){oe(e.$$.fragment,r),n=!1},d(r){_e(e,r)}}}function $i(t){let e,n;return e=new Wl({props:{privKey:t[4]}}),{c(){ge(e.$$.fragment)},m(r,s){pe(e,r,s),n=!0},p(r,s){const o={};s&16&&(o.privKey=r[4]),e.$set(o)},i(r){n||(ne(e.$$.fragment,r),n=!0)},o(r){oe(e.$$.fragment,r),n=!1},d(r){_e(e,r)}}}function Qi(t){let e,n;return e=new Ml({props:{privKey:t[4]}}),{c(){ge(e.$$.fragment)},m(r,s){pe(e,r,s),n=!0},p(r,s){const o={};s&16&&(o.privKey=r[4]),e.$set(o)},i(r){n||(ne(e.$$.fragment,r),n=!0)},o(r){oe(e.$$.fragment,r),n=!1},d(r){_e(e,r)}}}function Ji(t){let e,n;return e=new _l({props:{privKey:t[4]}}),{c(){ge(e.$$.fragment)},m(r,s){pe(e,r,s),n=!0},p(r,s){const o={};s&16&&(o.privKey=r[4]),e.$set(o)},i(r){n||(ne(e.$$.fragment,r),n=!0)},o(r){oe(e.$$.fragment,r),n=!1},d(r){_e(e,r)}}}function ea(t){let e,n;return e=new ul({props:{privKey:t[4]}}),{c(){ge(e.$$.fragment)},m(r,s){pe(e,r,s),n=!0},p(r,s){const o={};s&16&&(o.privKey=r[4]),e.$set(o)},i(r){n||(ne(e.$$.fragment,r),n=!0)},o(r){oe(e.$$.fragment,r),n=!1},d(r){_e(e,r)}}}function ta(t){let e,n;return e=new nl({props:{privKey:t[4]}}),{c(){ge(e.$$.fragment)},m(r,s){pe(e,r,s),n=!0},p(r,s){const o={};s&16&&(o.privKey=r[4]),e.$set(o)},i(r){n||(ne(e.$$.fragment,r),n=!0)},o(r){oe(e.$$.fragment,r),n=!1},d(r){_e(e,r)}}}function na(t){let e,n;return e=new Zf({props:{privKey:t[4]}}),{c(){ge(e.$$.fragment)},m(r,s){pe(e,r,s),n=!0},p(r,s){const o={};s&16&&(o.privKey=r[4]),e.$set(o)},i(r){n||(ne(e.$$.fragment,r),n=!0)},o(r){oe(e.$$.fragment,r),n=!1},d(r){_e(e,r)}}}function ra(t){let e,n;return e=new Tf({props:{privKey:t[4]}}),{c(){ge(e.$$.fragment)},m(r,s){pe(e,r,s),n=!0},p(r,s){const o={};s&16&&(o.privKey=r[4]),e.$set(o)},i(r){n||(ne(e.$$.fragment,r),n=!0)},o(r){oe(e.$$.fragment,r),n=!1},d(r){_e(e,r)}}}function sa(t){let e,n,r,s,o,c,l,i,a,b;e=new Ci({props:{curve:t[3],keyLength:t[2]}});let p=Rn,h=[];for(let x=0;x<p.length;x+=1)h[x]=Zs(Ms(t,p,x));let d=t[0]&&Ks(t);const _=[ra,na,ta,ea,Ji,Qi,$i,Xi,Wi],m=[];function y(x,S){return x[3]=="ecdsa_secp256k1"?0:x[3]=="ecdsa_p256"?1:x[3]=="ecdsa_p384"?2:x[3]=="ecdsa_p521"?3:x[3]=="schnorr_secp256k1"?4:x[3]=="eddsa_ed25519"?5:x[3]=="eddsa_ed448"?6:x[3]=="bls_bls12-381"?7:x[3]=="custom"?8:-1}return~(c=y(t))&&(l=m[c]=_[c](t)),a=new Yi({}),{c(){ge(e.$$.fragment),n=O(),r=u("div");for(let x=0;x<h.length;x+=1)h[x].c();s=O(),d&&d.c(),o=O(),l&&l.c(),i=O(),ge(a.$$.fragment),g(r,"class","curves-list-container")},m(x,S){pe(e,x,S),V(x,n,S),V(x,r,S);for(let k=0;k<h.length;k+=1)h[k].m(r,null);V(x,s,S),d&&d.m(x,S),V(x,o,S),~c&&m[c].m(x,S),V(x,i,S),pe(a,x,S),b=!0},p(x,[S]){const k={};if(S&8&&(k.curve=x[3]),S&4&&(k.keyLength=x[2]),e.$set(k),S&32){p=Rn;let v;for(v=0;v<p.length;v+=1){const A=Ms(x,p,v);h[v]?h[v].p(A,S):(h[v]=Zs(A),h[v].c(),h[v].m(r,null))}for(;v<h.length;v+=1)h[v].d(1);h.length=p.length}x[0]?d?(d.p(x,S),S&1&&ne(d,1)):(d=Ks(x),d.c(),ne(d,1),d.m(o.parentNode,o)):d&&(lt(),oe(d,1,1,()=>{d=null}),it());let w=c;c=y(x),c===w?~c&&m[c].p(x,S):(l&&(lt(),oe(m[w],1,1,()=>{m[w]=null}),it()),~c?(l=m[c],l?l.p(x,S):(l=m[c]=_[c](x),l.c()),ne(l,1),l.m(i.parentNode,i)):l=null)},i(x){b||(ne(e.$$.fragment,x),ne(d),ne(l),ne(a.$$.fragment,x),b=!0)},o(x){oe(e.$$.fragment,x),oe(d),oe(l),oe(a.$$.fragment,x),b=!1},d(x){_e(e,x),x&&j(n),x&&j(r),ut(h,x),x&&j(s),d&&d.d(x),x&&j(o),~c&&m[c].d(x),x&&j(i),_e(a,x)}}}function ca(t,e,n){let r,s;Ce(t,ft,p=>n(4,r=p)),Ce(t,Xe,p=>n(7,s=p)),Le(ft,r=En,r),Le(Xe,s="greetings from noble",s);let o=!1,c=Rt,l=En.length,i="ecdsa_secp256k1";return[o,c,l,i,r,p=>{n(3,i=p.target.id.toLowerCase()),i==="ecdsa_p384"?Le(ft,r=xf,r):i==="ecdsa_p521"?Le(ft,r=wf,r):i==="eddsa_ed448"?Le(ft,r=vf,r):Le(ft,r=En,r),n(2,l=r.length),n(0,o=i==="custom")},p=>{n(1,c=p.detail),n(3,i="custom"),Le(ft,r=En,r),n(2,l=r.length)}]}class oa extends Ze{constructor(e){super(),Ge(this,e,ca,sa,Me,{})}}new oa({target:document.getElementById("app-ecc-calculator")});
